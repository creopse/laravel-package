import{P as m,C as E}from"./ckeditor_ckeditor5-core-Cqajz_gD.js";import{O as b,B as v,g as S}from"./ckeditor_ckeditor5-engine-CS7i4Bo_.js";import{e as k}from"./ckeditor_ckeditor5-utils-Bp8opE8z.js";/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 *//**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function*p(s,e){for(const t of e)t&&s.getAttributeProperties(t[0]).copyOnEnter&&(yield t)}class y extends E{execute(){this.editor.model.change(e=>{this.enterBlock(e),this.fire("afterExecute",{writer:e})})}enterBlock(e){const t=this.editor.model,n=t.document.selection,i=t.schema,o=n.isCollapsed,r=n.getFirstRange(),c=r.start.parent,a=r.end.parent;if(i.isLimit(c)||i.isLimit(a))return!o&&c==a&&t.deleteContent(n),!1;if(o){const l=p(e.model.schema,n.getAttributes());return f(e,r.start),e.setSelectionAttribute(l),!0}else{const l=!(r.start.isAtStart&&r.end.isAtEnd),g=c==a;if(t.deleteContent(n,{leaveUnmerged:l}),l){if(g)return f(e,n.focus),!0;e.setSelection(a,0)}}return!1}}function f(s,e){s.split(e),s.setSelection(e.parent.nextSibling,0)}const C={insertParagraph:{isSoft:!1},insertLineBreak:{isSoft:!0}};class h extends b{constructor(e){super(e);const t=this.document;let n=!1;t.on("keydown",(i,o)=>{n=o.shiftKey}),t.on("beforeinput",(i,o)=>{if(!this.isEnabled)return;let r=o.inputType;k.isSafari&&n&&r=="insertParagraph"&&(r="insertLineBreak");const c=o.domEvent,a=C[r];if(!a)return;const l=new v(t,"enter",o.targetRanges[0]);t.fire(l,new S(e,c,{isSoft:a.isSoft})),l.stop.called&&i.stop()})}observe(){}stopObserving(){}}class D extends m{static get pluginName(){return"Enter"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.editing.view,n=t.document,i=this.editor.t;t.addObserver(h),e.commands.add("enter",new y(e)),this.listenTo(n,"enter",(o,r)=>{n.isComposing||r.preventDefault(),!r.isSoft&&(e.execute("enter"),t.scrollToTheSelection())},{priority:"low"}),e.accessibility.addKeystrokeInfos({keystrokes:[{label:i("Insert a hard break (a new paragraph)"),keystroke:"Enter"}]})}}class T extends E{execute(){const e=this.editor.model,t=e.document;e.change(n=>{B(e,n,t.selection),this.fire("afterExecute",{writer:n})})}refresh(){const e=this.editor.model,t=e.document;this.isEnabled=x(e.schema,t.selection)}}function x(s,e){if(e.rangeCount>1)return!1;const t=e.anchor;if(!t||!s.checkChild(t,"softBreak"))return!1;const n=e.getFirstRange(),i=n.start.parent,o=n.end.parent;return!((d(i,s)||d(o,s))&&i!==o)}function B(s,e,t){const n=t.isCollapsed,i=t.getFirstRange(),o=i.start.parent,r=i.end.parent,c=o==r;if(n){const a=p(s.schema,t.getAttributes());u(s,e,i.end),e.removeSelectionAttribute(t.getAttributeKeys()),e.setSelectionAttribute(a)}else{const a=!(i.start.isAtStart&&i.end.isAtEnd);s.deleteContent(t,{leaveUnmerged:a}),c?u(s,e,t.focus):a&&e.setSelection(r,0)}}function u(s,e,t){const n=e.createElement("softBreak");s.insertContent(n,t),e.setSelection(n,"after")}function d(s,e){return s.is("rootElement")?!1:e.isLimit(s)||d(s.parent,e)}class I extends m{static get pluginName(){return"ShiftEnter"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.model.schema,n=e.conversion,i=e.editing.view,o=i.document,r=this.editor.t;t.register("softBreak",{allowWhere:"$text",isInline:!0}),n.for("upcast").elementToElement({model:"softBreak",view:"br"}),n.for("downcast").elementToElement({model:"softBreak",view:(c,{writer:a})=>a.createEmptyElement("br")}),i.addObserver(h),e.commands.add("shiftEnter",new T(e)),this.listenTo(o,"enter",(c,a)=>{o.isComposing||a.preventDefault(),a.isSoft&&(e.execute("shiftEnter"),i.scrollToTheSelection())},{priority:"low"}),e.accessibility.addKeystrokeInfos({keystrokes:[{label:r("Insert a soft break (a <code>&lt;br&gt;</code> element)"),keystroke:"Shift+Enter"}]})}}export{D as E,I as S};
