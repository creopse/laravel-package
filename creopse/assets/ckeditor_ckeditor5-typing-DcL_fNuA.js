import{P as k,C as z}from"./ckeditor_ckeditor5-core-Cqajz_gD.js";import{U as y,O as V,e as E,A as Y,E as X,F as J,G as Z,X as ee}from"./ckeditor_ckeditor5-utils-Bp8opE8z.js";import{t as $,B as D,g as S,O as W,r as te,T as ne,M as ie,F as se}from"./ckeditor_ckeditor5-engine-CS7i4Bo_.js";import{n as oe,l as re}from"./es-toolkit-RjqxEpf9.js";/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 *//**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */class U{model;limit;_isLocked;_size;_batch=null;_changeCallback;_selectionChangeCallback;constructor(e,t=20){this.model=e,this._size=0,this.limit=t,this._isLocked=!1,this._changeCallback=(n,s)=>{s.isLocal&&s.isUndoable&&s!==this._batch&&this._reset(!0)},this._selectionChangeCallback=()=>{this._reset()},this.model.document.on("change",this._changeCallback),this.model.document.selection.on("change:range",this._selectionChangeCallback),this.model.document.selection.on("change:attribute",this._selectionChangeCallback)}get batch(){return this._batch||(this._batch=this.model.createBatch({isTyping:!0})),this._batch}get size(){return this._size}input(e){this._size+=e,this._size>=this.limit&&this._reset(!0)}get isLocked(){return this._isLocked}lock(){this._isLocked=!0}unlock(){this._isLocked=!1}destroy(){this.model.document.off("change",this._changeCallback),this.model.document.selection.off("change:range",this._selectionChangeCallback),this.model.document.selection.off("change:attribute",this._selectionChangeCallback)}_reset(e=!1){(!this.isLocked||e)&&(this._batch=null,this._size=0)}}class ce extends z{_buffer;constructor(e,t){super(e),this._buffer=new U(e.model,t),this._isEnabledBasedOnSelection=!1}get buffer(){return this._buffer}destroy(){super.destroy(),this._buffer.destroy()}execute(e={}){const t=this.editor.model,n=t.document,s=e.text||"",i=s.length;let c=n.selection;if(e.selection?c=e.selection:e.range&&(c=t.createSelection(e.range)),!t.canEditAt(c))return;const r=e.resultRange;t.enqueueChange(this._buffer.batch,a=>{this._buffer.lock();const l=Array.from(n.selection.getAttributes());t.deleteContent(c),s&&t.insertContent(a.createText(s,l),c),r?a.setSelection(r):c.is("documentSelection")||a.setSelection(c),this._buffer.unlock(),this._buffer.input(i)})}}const Q=["insertText","insertReplacementText"],ae=[...Q,"insertCompositionText"];class le extends W{focusObserver;constructor(e){super(e),this.focusObserver=e.getObserver(se);const t=E.isAndroid?ae:Q,n=e.document;n.on("beforeinput",(s,i)=>{if(!this.isEnabled)return;const{data:c,targetRanges:r,inputType:a,domEvent:l,isComposing:u}=i;if(!t.includes(a))return;this.focusObserver.flush();const d=new X(n,"insertText");n.fire(d,new S(e,l,{text:c,selection:e.createSelection(r),isComposing:u})),d.stop.called&&s.stop()}),E.isAndroid||n.on("compositionend",(s,{data:i,domEvent:c})=>{this.isEnabled&&i&&n.fire("insertText",new S(e,c,{text:i,isComposing:!0}))},{priority:"low"})}observe(){}stopObserving(){}}class ue extends k{_typingQueue;static get pluginName(){return"Input"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.model,n=e.editing.view,s=e.editing.mapper,i=t.document.selection;this._typingQueue=new de(e),n.addObserver(le);const c=new ce(e,e.config.get("typing.undoStep")||20);e.commands.add("insertText",c),e.commands.add("input",c),this.listenTo(n.document,"beforeinput",()=>{this._typingQueue.flush("next beforeinput")},{priority:"high"}),this.listenTo(n.document,"insertText",(r,a)=>{const{text:l,selection:u}=a;if(n.document.selection.isFake&&u&&n.document.selection.isSimilar(u)&&a.preventDefault(),u&&Array.from(u.getRanges()).some(f=>!f.isCollapsed)&&a.preventDefault(),!c.isEnabled){a.preventDefault();return}let d;u?d=Array.from(u.getRanges()).map(f=>s.toModelRange(f)).map(f=>$(f,t.schema)||f):d=Array.from(i.getRanges());let h=l;if(E.isAndroid){const f=Array.from(d[0].getItems()).reduce((b,v)=>b+(v.is("$textProxy")?v.data:""),"");if(f&&(f.length<=h.length?h.startsWith(f)&&(h=h.substring(f.length),d[0].start=d[0].start.getShiftedBy(f.length)):f.startsWith(h)&&(d[0].start=d[0].start.getShiftedBy(h.length),h="")),h.length==0&&d[0].isCollapsed)return}const g={text:h,selection:t.createSelection(d)};this._typingQueue.push(g,!!a.isComposing),a.domEvent.defaultPrevented&&this._typingQueue.flush("beforeinput default prevented")}),E.isAndroid?this.listenTo(n.document,"keydown",(r,a)=>{i.isCollapsed||a.keyCode!=229||!n.document.isComposing||F(t,c)}):this.listenTo(n.document,"compositionstart",()=>{i.isCollapsed||F(t,c)},{priority:"high"}),this.listenTo(n.document,"mutations",(r,{mutations:a})=>{if(this._typingQueue.hasAffectedElements())for(const{node:l}of a){const u=he(l,s),d=s.toModelElement(u);if(this._typingQueue.isElementAffected(d)){this._typingQueue.flush("mutations");return}}}),this.listenTo(n.document,"compositionend",()=>{this._typingQueue.flush("before composition end")},{priority:"high"}),this.listenTo(n.document,"compositionend",()=>{this._typingQueue.flush("after composition end");const r=[];if(this._typingQueue.hasAffectedElements())for(const a of this._typingQueue.flushAffectedElements()){const l=s.toViewElement(a);l&&r.push({type:"children",node:l})}(r.length||!E.isAndroid)&&n.document.fire("mutations",{mutations:r})},{priority:"lowest"})}destroy(){super.destroy(),this._typingQueue.destroy()}}class de{editor;flushDebounced=re(()=>this.flush("timeout"),50);_queue=[];_isComposing=!1;_affectedElements=new Set;constructor(e){this.editor=e}destroy(){for(this.flushDebounced.cancel(),this._affectedElements.clear();this._queue.length;)this.shift()}get length(){return this._queue.length}push(e,t){const n={text:e.text};if(e.selection){n.selectionRanges=[];for(const s of e.selection.getRanges())n.selectionRanges.push(ie.fromRange(s)),this._affectedElements.add(s.start.parent)}this._queue.push(n),this._isComposing||=t,this.flushDebounced()}shift(){const e=this._queue.shift(),t={text:e.text};if(e.selectionRanges){const n=e.selectionRanges.map(s=>fe(s)).filter(s=>!!s);n.length&&(t.selection=this.editor.model.createSelection(n))}return t}flush(e){const t=this.editor,n=t.model,s=t.editing.view;if(this.flushDebounced.cancel(),!this._queue.length)return;const c=t.commands.get("insertText").buffer;n.enqueueChange(c.batch,()=>{for(c.lock();this._queue.length;){const r=this.shift();t.execute("insertText",r)}c.unlock(),this._isComposing||this._affectedElements.clear(),this._isComposing=!1}),s.scrollToTheSelection()}isElementAffected(e){return this._affectedElements.has(e)}hasAffectedElements(){return this._affectedElements.size>0}flushAffectedElements(){const e=Array.from(this._affectedElements);return this._affectedElements.clear(),e}}function F(o,e){if(!e.isEnabled)return;const t=e.buffer;t.lock(),o.enqueueChange(t.batch,()=>{o.deleteContent(o.document.selection)}),t.unlock()}function fe(o){const e=o.toRange();return o.detach(),e.root.rootName=="$graveyard"?null:e}function he(o,e){let t=o.is("$text")?o.parent:o;for(;!e.toModelElement(t);)t=t.parent;return t}class I extends z{direction;_buffer;constructor(e,t){super(e),this.direction=t,this._buffer=new U(e.model,e.config.get("typing.undoStep")),this._isEnabledBasedOnSelection=!1}get buffer(){return this._buffer}execute(e={}){const t=this.editor.model,n=t.document;t.enqueueChange(this._buffer.batch,s=>{this._buffer.lock();const i=s.createSelection(e.selection||n.selection);if(!t.canEditAt(i))return;const c=e.sequence||1,r=i.isCollapsed;if(i.isCollapsed&&t.modifySelection(i,{direction:this.direction,unit:e.unit,treatEmojiAsSingleUnit:!0}),this._shouldEntireContentBeReplacedWithParagraph(c)){this._replaceEntireContentWithParagraph(s);return}if(this._shouldReplaceFirstBlockWithParagraph(i,c)){this.editor.execute("paragraph",{selection:i});return}if(i.isCollapsed)return;let a=0;i.getFirstRange().getMinimalFlatRanges().forEach(l=>{a+=Y(l.getWalker({singleCharacters:!0,ignoreElementEnd:!0,shallow:!0}))}),t.deleteContent(i,{doNotResetEntireContent:r,direction:this.direction}),this._buffer.input(a),s.setSelection(i),this._buffer.unlock()})}_shouldEntireContentBeReplacedWithParagraph(e){if(e>1)return!1;const t=this.editor.model,s=t.document.selection,i=t.schema.getLimitElement(s);if(!(s.isCollapsed&&s.containsEntireContent(i))||!t.schema.checkChild(i,"paragraph"))return!1;const r=i.getChild(0);return!(r&&r.is("element","paragraph"))}_replaceEntireContentWithParagraph(e){const t=this.editor.model,s=t.document.selection,i=t.schema.getLimitElement(s),c=e.createElement("paragraph");e.remove(e.createRangeIn(i)),e.insert(c,i),e.setSelection(c,0)}_shouldReplaceFirstBlockWithParagraph(e,t){const n=this.editor.model;if(t>1||this.direction!="backward"||!e.isCollapsed)return!1;const s=e.getFirstPosition(),i=n.schema.getLimitElement(s),c=i.getChild(0);return!(s.parent!=c||!e.containsEntireContent(c)||!n.schema.checkChild(i,"paragraph")||c.name=="paragraph")}}const me="character",L="word",ge="codePoint",_="selection",C="backward",A="forward",j={deleteContent:{unit:_,direction:C},deleteContentBackward:{unit:ge,direction:C},deleteWordBackward:{unit:L,direction:C},deleteHardLineBackward:{unit:_,direction:C},deleteSoftLineBackward:{unit:_,direction:C},deleteContentForward:{unit:me,direction:A},deleteWordForward:{unit:L,direction:A},deleteHardLineForward:{unit:_,direction:A},deleteSoftLineForward:{unit:_,direction:A}};class pe extends W{constructor(e){super(e);const t=e.document;let n=0;t.on("keydown",()=>{n++}),t.on("keyup",()=>{n=0}),t.on("beforeinput",(s,i)=>{if(!this.isEnabled)return;const{targetRanges:c,domEvent:r,inputType:a}=i,l=j[a];if(!l)return;const u={direction:l.direction,unit:l.unit,sequence:n};u.unit==_&&(u.selectionToRemove=e.createSelection(c[0])),a==="deleteContentBackward"&&(E.isAndroid&&(u.sequence=1),_e(c)&&(u.unit=_,u.selectionToRemove=e.createSelection(c)));const d=new D(t,"delete",c[0]);t.fire(d,new S(e,r,u)),d.stop.called&&s.stop()}),E.isBlink&&be(this)}observe(){}stopObserving(){}}function be(o){const e=o.view,t=e.document;let n=null,s=!1;t.on("keydown",(r,{keyCode:a})=>{n=a,s=!1}),t.on("keyup",(r,{keyCode:a,domEvent:l})=>{const u=t.selection,d=o.isEnabled&&a==n&&i(a)&&!u.isCollapsed&&!s;if(n=null,d){const h=u.getFirstRange(),g=new D(t,"delete",h),f={unit:_,direction:c(a),selectionToRemove:u};t.fire(g,new S(e,l,f))}}),t.on("beforeinput",(r,{inputType:a})=>{const l=j[a];i(n)&&l&&l.direction==c(n)&&(s=!0)},{priority:"high"}),t.on("beforeinput",(r,{inputType:a,data:l})=>{n==y.delete&&a=="insertText"&&l==""&&r.stop()},{priority:"high"});function i(r){return r==y.backspace||r==y.delete}function c(r){return r==y.backspace?C:A}}function _e(o){if(o.length!=1||o[0].isCollapsed)return!1;const e=o[0].getWalker({direction:"backward",singleCharacters:!0,ignoreElementEnd:!0});let t=0;for(const{nextPosition:n,item:s}of e){if(n.parent.is("$text")){const i=n.parent.data,c=n.offset;if(J(i,c)||Z(i,c)||ee(i,c))continue;t++}else(s.is("containerElement")||s.is("emptyElement"))&&t++;if(t>1)return!0}return!1}class ve extends k{_undoOnBackspace;static get pluginName(){return"Delete"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.editing.view,n=t.document,s=e.model.document;t.addObserver(pe),this._undoOnBackspace=!1;const i=new I(e,"forward");e.commands.add("deleteForward",i),e.commands.add("forwardDelete",i),e.commands.add("delete",new I(e,"backward")),this.listenTo(n,"delete",(c,r)=>{n.isComposing||r.preventDefault();const{direction:a,sequence:l,selectionToRemove:u,unit:d}=r,h=a==="forward"?"deleteForward":"delete",g={sequence:l};if(d=="selection"){const f=Array.from(u.getRanges()).map(b=>e.editing.mapper.toModelRange(b)).map(b=>$(b,e.model.schema)||b);g.selection=e.model.createSelection(f)}else g.unit=d;e.execute(h,g),t.scrollToTheSelection()},{priority:"low"}),this.listenTo(n,"keydown",(c,r)=>{if(n.isComposing||r.keyCode!=y.backspace||!s.selection.isCollapsed)return;const a=e.model.schema.getLimitElement(s.selection),l=e.model.createPositionAt(a,0);if(l.isTouching(s.selection.getFirstPosition())){r.preventDefault();const u=e.model.schema.getNearestSelectionRange(l,"forward");if(!u)return;const d=t.createSelection(e.editing.mapper.toViewRange(u)),h=d.getFirstRange(),g=new D(document,"delete",h),f={unit:"selection",direction:"backward",selectionToRemove:d};n.fire(g,new S(t,r.domEvent,f))}}),this.editor.plugins.has("UndoEditing")&&(this.listenTo(n,"delete",(c,r)=>{this._undoOnBackspace&&r.direction=="backward"&&r.sequence==1&&r.unit=="codePoint"&&(this._undoOnBackspace=!1,e.execute("undo"),r.preventDefault(),c.stop())},{context:"$capture"}),this.listenTo(s,"change",()=>{this._undoOnBackspace=!1}))}requestUndoOnBackspace(){this.editor.plugins.has("UndoEditing")&&(this._undoOnBackspace=!0)}}class Be extends k{static get requires(){return[ue,ve]}static get pluginName(){return"Typing"}static get isOfficialPlugin(){return!0}}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function ye(o,e){let t=o.start;return{text:Array.from(o.getWalker({ignoreElementEnd:!1})).reduce((s,{item:i})=>i.is("$text")||i.is("$textProxy")?s+i.data:(t=e.createPositionAfter(i),""),""),range:e.createRange(t,o.end)}}class Ee extends V(){model;testCallback;_hasMatch;constructor(e,t){super(),this.model=e,this.testCallback=t,this._hasMatch=!1,this.set("isEnabled",!0),this.on("change:isEnabled",()=>{this.isEnabled?this._startListening():(this.stopListening(e.document.selection),this.stopListening(e.document))}),this._startListening()}get hasMatch(){return this._hasMatch}_startListening(){const t=this.model.document;this.listenTo(t.selection,"change:range",(n,{directChange:s})=>{if(s){if(!t.selection.isCollapsed){this.hasMatch&&(this.fire("unmatched"),this._hasMatch=!1);return}this._evaluateTextBeforeSelection("selection")}}),this.listenTo(t,"change:data",(n,s)=>{s.isUndo||!s.isLocal||this._evaluateTextBeforeSelection("data",{batch:s})})}_evaluateTextBeforeSelection(e,t={}){const n=this.model,i=n.document.selection,c=n.createRange(n.createPositionAt(i.focus.parent,0),i.focus),{text:r,range:a}=ye(c,n),l=this.testCallback(r);if(!l&&this.hasMatch&&this.fire("unmatched"),this._hasMatch=!!l,l){const u=Object.assign(t,{text:r,range:a});typeof l=="object"&&Object.assign(u,l),this.fire(`matched:${e}`,u)}}}class Fe extends k{attributes;_overrideUid;_isNextGravityRestorationSkipped=!1;static get pluginName(){return"TwoStepCaretMovement"}static get isOfficialPlugin(){return!0}constructor(e){super(e),this.attributes=new Set,this._overrideUid=null}init(){const e=this.editor,t=e.model,n=e.editing.view,s=e.locale,i=t.document.selection;this.listenTo(n.document,"arrowKey",(c,r)=>{if(!i.isCollapsed||r.shiftKey||r.altKey||r.ctrlKey)return;const a=r.keyCode==y.arrowright,l=r.keyCode==y.arrowleft;if(!a&&!l)return;const u=s.contentLanguageDirection;let d=!1;u==="ltr"&&a||u==="rtl"&&l?d=this._handleForwardMovement(r):d=this._handleBackwardMovement(r),d===!0&&c.stop()},{context:"$text",priority:"highest"}),this.listenTo(i,"change:range",(c,r)=>{if(this._isNextGravityRestorationSkipped){this._isNextGravityRestorationSkipped=!1;return}this._isGravityOverridden&&(!r.directChange&&m(i.getFirstPosition(),this.attributes)||this._restoreGravity())}),this._enableClickingAfterNode(),this._enableInsertContentSelectionAttributesFixer(),this._handleDeleteContentAfterNode()}registerAttribute(e){this.attributes.add(e)}_handleForwardMovement(e){const t=this.attributes,n=this.editor.model,s=n.document.selection,i=s.getFirstPosition();return this._isGravityOverridden||i.isAtStart&&p(s,t)?!1:m(i,t)?(e&&w(e),p(s,t)&&m(i,t,!0)?x(n,t):this._overrideGravity(),!0):!1}_handleBackwardMovement(e){const t=this.attributes,n=this.editor.model,s=n.document.selection,i=s.getFirstPosition();return this._isGravityOverridden?(e&&w(e),this._restoreGravity(),m(i,t,!0)?x(n,t):R(n,t,i),!0):i.isAtStart?p(s,t)?(e&&w(e),R(n,t,i),!0):!1:!p(s,t)&&m(i,t,!0)?(e&&w(e),R(n,t,i),!0):q(i,t)?i.isAtEnd&&!p(s,t)&&m(i,t)?(e&&w(e),R(n,t,i),!0):(this._isNextGravityRestorationSkipped=!0,this._overrideGravity(),!1):!1}_enableClickingAfterNode(){const e=this.editor,t=e.model,n=t.document.selection,s=e.editing.view.document;e.editing.view.addObserver(te),e.editing.view.addObserver(ne);let i=!1,c=!1;this.listenTo(s,"touchstart",()=>{c=!1,i=!0}),this.listenTo(s,"mousedown",()=>{c=!0}),this.listenTo(s,"selectionChange",()=>{const r=this.attributes;if(!c&&!i||(c=!1,i=!1,!n.isCollapsed)||!p(n,r))return;const a=n.getFirstPosition();m(a,r)&&(a.isAtStart||m(a,r,!0)?x(t,r):this._isGravityOverridden||this._overrideGravity())})}_enableInsertContentSelectionAttributesFixer(){const t=this.editor.model,n=t.document.selection,s=this.attributes;this.listenTo(t,"insertContent",()=>{const i=n.getFirstPosition();p(n,s)&&m(i,s)&&x(t,s)},{priority:"low"})}_handleDeleteContentAfterNode(){const e=this.editor,t=e.model,n=t.document.selection,s=e.editing.view;let i=!1,c=!1;this.listenTo(s.document,"delete",(r,a)=>{i=a.direction==="backward"},{priority:"high"}),this.listenTo(t,"deleteContent",()=>{if(!i)return;const r=n.getFirstPosition();c=p(n,this.attributes)&&!q(r,this.attributes)},{priority:"high"}),this.listenTo(t,"deleteContent",()=>{i&&(i=!1,!c&&e.model.enqueueChange(()=>{const r=n.getFirstPosition();p(n,this.attributes)&&m(r,this.attributes)&&(r.isAtStart||m(r,this.attributes,!0)?x(t,this.attributes):this._isGravityOverridden||this._overrideGravity())}))},{priority:"low"})}get _isGravityOverridden(){return!!this._overrideUid}_overrideGravity(){this._overrideUid=this.editor.model.change(e=>e.overrideSelectionGravity())}_restoreGravity(){this.editor.model.change(e=>{e.restoreSelectionGravity(this._overrideUid),this._overrideUid=null})}}function p(o,e){for(const t of e)if(o.hasAttribute(t))return!0;return!1}function R(o,e,t){const n=t.nodeBefore;o.change(s=>{if(n){const i=[],c=o.schema.isObject(n)&&o.schema.isInline(n);for(const[r,a]of n.getAttributes())o.schema.checkAttribute("$text",r)&&(!c||o.schema.getAttributeProperties(r).copyFromObject!==!1)&&i.push([r,a]);s.setSelectionAttribute(i)}else s.removeSelectionAttribute(e)})}function x(o,e){o.change(t=>{t.removeSelectionAttribute(e)})}function w(o){o.preventDefault()}function q(o,e){const t=o.getShiftedBy(-1);return m(t,e)}function m(o,e,t=!1){const{nodeBefore:n,nodeAfter:s}=o;for(const i of e){const c=n?n.getAttribute(i):void 0,r=s?s.getAttribute(i):void 0;if(!(t&&(c===void 0||r===void 0))&&r!==c)return!0}return!1}const N={copyright:{from:"(c)",to:"©"},registeredTrademark:{from:"(r)",to:"®"},trademark:{from:"(tm)",to:"™"},oneHalf:{from:/(^|[^/a-z0-9])(1\/2)([^/a-z0-9])$/i,to:[null,"½",null]},oneThird:{from:/(^|[^/a-z0-9])(1\/3)([^/a-z0-9])$/i,to:[null,"⅓",null]},twoThirds:{from:/(^|[^/a-z0-9])(2\/3)([^/a-z0-9])$/i,to:[null,"⅔",null]},oneForth:{from:/(^|[^/a-z0-9])(1\/4)([^/a-z0-9])$/i,to:[null,"¼",null]},threeQuarters:{from:/(^|[^/a-z0-9])(3\/4)([^/a-z0-9])$/i,to:[null,"¾",null]},lessThanOrEqual:{from:"<=",to:"≤"},greaterThanOrEqual:{from:">=",to:"≥"},notEqual:{from:"!=",to:"≠"},arrowLeft:{from:"<-",to:"←"},arrowRight:{from:"->",to:"→"},horizontalEllipsis:{from:"...",to:"…"},enDash:{from:/(^| )(--)( )$/,to:[null,"–",null]},emDash:{from:/(^| )(---)( )$/,to:[null,"—",null]},quotesPrimary:{from:T('"'),to:[null,"“",null,"”"]},quotesSecondary:{from:T("'"),to:[null,"‘",null,"’"]},quotesPrimaryEnGb:{from:T("'"),to:[null,"‘",null,"’"]},quotesSecondaryEnGb:{from:T('"'),to:[null,"“",null,"”"]},quotesPrimaryPl:{from:T('"'),to:[null,"„",null,"”"]},quotesSecondaryPl:{from:T("'"),to:[null,"‚",null,"’"]}},M={symbols:["copyright","registeredTrademark","trademark"],mathematical:["oneHalf","oneThird","twoThirds","oneForth","threeQuarters","lessThanOrEqual","greaterThanOrEqual","notEqual","arrowLeft","arrowRight"],typography:["horizontalEllipsis","enDash","emDash"],quotes:["quotesPrimary","quotesSecondary"]},Te=["symbols","mathematical","typography","quotes"];class Ie extends k{static get requires(){return["Delete","Input"]}static get pluginName(){return"TextTransformation"}static get isOfficialPlugin(){return!0}constructor(e){super(e),e.config.define("typing",{transformations:{include:Te}})}init(){const t=this.editor.model.document.selection;t.on("change:range",()=>{this.isEnabled=!t.anchor.parent.is("element","codeBlock")}),this._enableTransformationWatchers()}_enableTransformationWatchers(){const e=this.editor,t=e.model,n=e.plugins.get("Delete"),s=Ae(e.config.get("typing.transformations")),i=r=>{for(const a of s)if(a.from.test(r))return{normalizedTransformation:a}},c=new Ee(e.model,i);c.on("matched:data",(r,a)=>{if(!a.batch.isTyping)return;const{from:l,to:u}=a.normalizedTransformation,d=l.exec(a.text),h=u(d.slice(1)),g=a.range;let f=d.index;t.enqueueChange(b=>{for(let v=1;v<d.length;v++){const B=d[v],O=h[v-1];if(O==null){f+=B.length;continue}const P=g.start.getShiftedBy(f),H=t.createRange(P,P.getShiftedBy(B.length)),K=we(P);t.insertContent(b.createText(O,K),H),f+=O.length}t.enqueueChange(()=>{n.requestUndoOnBackspace()})})}),c.bind("isEnabled").to(this)}}function Ce(o){return typeof o=="string"?new RegExp(`(${oe(o)})$`):o}function xe(o){return typeof o=="string"?()=>[o]:o instanceof Array?()=>o:o}function we(o){return(o.textNode?o.textNode:o.nodeAfter).getAttributes()}function T(o){return new RegExp(`(^|\\s)(${o})([^${o}]*)(${o})$`)}function Ae(o){const e=o.extra||[],t=o.remove||[],n=i=>!t.includes(i),s=o.include.concat(e).filter(n);return Se(s).filter(n).map(i=>typeof i=="string"&&N[i]?N[i]:i).filter(i=>typeof i=="object").map(i=>({from:Ce(i.from),to:xe(i.to)}))}function Se(o){const e=new Set;for(const t of o)if(typeof t=="string"&&M[t])for(const n of M[t])e.add(n);else e.add(t);return Array.from(e)}/**
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
 */function ke(o,e,t,n){return n.createRange(G(o,e,t,!0,n),G(o,e,t,!1,n))}function G(o,e,t,n,s){let i=o.textNode||(n?o.nodeBefore:o.nodeAfter),c=null;for(;i&&i.getAttribute(e)==t;)c=i,i=n?i.previousSibling:i.nextSibling;return c?s.createPositionAt(c,n?"before":"after"):o}function Le(o,e,t,n){const s=o.editing.view,i=new Set;s.document.registerPostFixer(c=>{const r=o.model.document.selection;let a=!1;if(r.hasAttribute(e)){const l=ke(r.getFirstPosition(),e,r.getAttribute(e),o.model),u=o.editing.mapper.toViewRange(l);for(const d of u.getItems())d.is("element",t)&&!d.hasClass(n)&&(c.addClass(n,d),i.add(d),a=!0)}return a}),o.conversion.for("editingDowncast").add(c=>{c.on("insert",r,{priority:"highest"}),c.on("remove",r,{priority:"highest"}),c.on("attribute",r,{priority:"highest"}),c.on("selection",r,{priority:"highest"});function r(){s.change(a=>{for(const l of i.values())a.removeClass(n,l),i.delete(l)})}})}export{ve as D,ue as I,Fe as T,Be as a,Ee as b,Ie as c,ke as f,ye as g,Le as i};
