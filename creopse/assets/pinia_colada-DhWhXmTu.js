import{i as r}from"./css-render_vue3-ssr-Vbotx5Ir.js";import{d as F,s as j,g as y}from"./pinia-DbZVydD4.js";const{customRef:se,getCurrentScope:oe,shallowRef:ie}=await r("vue");var H=class I{value;children;constructor(...o){o.length&&this.set(...o)}set(o,u){if(o.length===0)this.value=u;else{const[c,...l]=o,p=this.children?.get(c);p?p.set(l,u):(this.children??=new Map,this.children.set(c,new I(l,u)))}}find(o){if(o.length===0)return this;{const[u,...c]=o;return this.children?.get(u)?.find(c)}}get(o){return this.find(o)?.value}delete(o){if(o.length===1)this.children?.delete(o[0]);else{const[u,...c]=o;this.children?.get(u)?.delete(c)}}*[Symbol.iterator](){if(this.value!=null&&(yield this.value),this.children)for(const o of this.children.values())yield*o}};const{computed:ue,getCurrentScope:ce,onScopeDispose:re}=await r("vue");function E(n,...o){return typeof n=="function"?n(...o):n}function J(n){return n&&typeof n=="object"?JSON.stringify(n,Object.keys(n).sort()):String(n)}var g=n=>n.map(J),L=()=>{};const{computed:le,shallowRef:pe}=await r("vue"),{getCurrentInstance:de,getCurrentScope:he,onScopeDispose:ge}=await r("vue"),{customRef:X,getCurrentInstance:fe,getCurrentScope:$,hasInjectionContext:ve,markRaw:D,shallowRef:M,toValue:f}=await r("vue"),{inject:B}=await r("vue");var P={staleTime:1e3*5,gcTime:1e3*60*5,refetchOnWindowFocus:!0,refetchOnReconnect:!0,refetchOnMount:!0,enabled:!0},U=Symbol(),G=()=>B(U,P);function Z(n){return n?.placeholderData!=null&&n.state.value.status==="pending"}var x={},ee="_pc_query",te=F(ee,({action:n})=>{const o=new H;let u;const c=j(X((e,t)=>(u=t)&&{get:()=>(e(),o),set:L})),l=$(),p=y()._a,v=G(),w=n((e,t=null,s,a=null,i=0)=>l.run(()=>{const q=M({data:s,error:a,status:a?"error":s!==void 0?"success":"pending"}),z=M("idle");return D({key:e,state:q,placeholderData:null,when:i,asyncStatus:z,pending:null,deps:D(new Set),gcTimeout:void 0,ext:x,options:t,get stale(){return!this.when||Date.now()>=this.when+this.options.staleTime},get active(){return this.deps.size>0}})}));let m;const T=new WeakMap,k=n(e=>{let t=T.get(e);return t?t[0]=t[0].map(s=>{const a=s.options?R(s.options,s):s;return a.options?.refetchOnMount&&f(a.options.enabled)&&(f(a.options.refetchOnMount)==="always"?d(a):b(a)),a}):(m=t=[[],null],t[1]=p.runWithContext(()=>l.run(e)),m=null,T.set(e,t)),t});function A(e,t){t&&(e.deps.add(t),clearTimeout(e.gcTimeout),e.gcTimeout=void 0,u())}function K(e,t){!t||!e.deps.has(t)||(e.deps.delete(t),u(),!(e.deps.size>0||!e.options)&&(clearTimeout(e.gcTimeout),Number.isFinite(e.options.gcTime)&&(e.gcTimeout=setTimeout(()=>{O(e)},e.options.gcTime))))}const V=n(e=>Promise.all(S(e).map(t=>(_(t),t.active&&f(t.options?.enabled)&&d(t))))),S=n((e={})=>{const t=e.key?c.value.find(g(e.key)):c.value;return t?(e.exact?t.value?[t.value]:[]:[...t]).filter(s=>{let a=!0;return e.stale!=null&&(a=s.stale===e.stale),e.active!=null&&(a&&=s.active===e.active),e.status&&(a&&=s.state.value.status===e.status),e.predicate&&(a&&=e.predicate(s)),a}):[]}),R=n((e,t)=>{const s={...v,...e},a=g(f(s.key));let i=o.get(a);return i||(o.set(a,i=w(a,s,s.initialData?.())),s.placeholderData&&i.state.value.status==="pending"&&(i.placeholderData=E(s.placeholderData,Z(t)?t.placeholderData:t?.state.value.data)),u()),i.options=s,i.ext===x&&(i.ext={},Q(i)),m?.[0].push(i),i}),Q=n(e=>{}),_=n(e=>{e.when=0,C(e)}),b=n(async e=>e.state.value.error||e.stale?e.pending?.refreshCall??d(e):e.state.value),d=n(async e=>{e.asyncStatus.value="loading";const t=new AbortController,{signal:s}=t;e.pending?.abortController.abort();const a=e.pending={abortController:t,refreshCall:(async()=>e.options.query({signal:s}))().then(i=>(a===e.pending&&h(e,{data:i,error:null,status:"success"}),e.state.value)).catch(i=>{throw a===e.pending&&i&&(i.name!=="AbortError"||i===s.reason)&&h(e,{status:"error",data:e.state.value.data,error:i}),i}).finally(()=>{e.asyncStatus.value="idle",a===e.pending&&(e.pending=null,e.placeholderData=null,e.when=Date.now())}),when:Date.now()};return a.refreshCall}),C=n((e,t)=>{e.pending?.abortController.abort(t),e.asyncStatus.value="idle",e.pending=null}),N=n((e,t)=>{S(e).forEach(s=>C(s,t))}),h=n((e,t)=>{e.state.value=t,e.when=Date.now()}),W=n((e,t)=>{const s=g(e);let a=o.get(s);a||o.set(s,a=w(s)),h(a,{...a.state.value,data:E(t,a.state.value.data)}),u()});function Y(e){return c.value.get(g(e))?.state.value.data}const O=n(e=>{o.delete(e.key),u()});return{caches:c,ensureDefinedQuery:k,_s:D(l),setQueryData:W,getQueryData:Y,invalidateQueries:V,cancelQueries:N,invalidate:_,fetch:d,refresh:b,ensure:R,extend:Q,track:A,untrack:K,cancel:C,create:w,remove:O,setEntryState:h,getEntries:S}});const{computed:we,getCurrentInstance:me,getCurrentScope:Se,isRef:Ce,onMounted:De,onScopeDispose:Te,onServerPrefetch:Re,onUnmounted:Qe,toValue:_e,watch:be}=await r("vue"),{watch:Oe}=await r("vue");function Ee(n,o={}){const{pinia:u=n.config.globalProperties.$pinia,plugins:c,...l}=o;n.provide(U,{...P,...l});const p=te(u);c?.forEach(v=>v({scope:p._s,queryCache:p,pinia:u}))}const{toValue:Me}=await r("vue");export{Ee as P};
