import{i as N}from"./css-render_vue3-ssr-Vbotx5Ir.js";import{r as I,u}from"./xlsx-BynBL3lx.js";import{_ as P}from"./fawmi_vue-google-maps-DHKJ2mA8.js";import{B as T}from"./naive-ui-CrTIpLJ9.js";import{u as O}from"./vue-i18n-CWrb4u3f.js";const{createElementVNode:h,unref:f,toDisplayString:y,createTextVNode:D,resolveComponent:J,withCtx:R,createVNode:j,openBlock:A,createElementBlock:H}=await N("vue"),{ref:d}=await N("vue"),z={__name:"UploadExcel",props:{beforeUpload:{type:Function,default:null},onSuccess:{type:Function,default:null}},setup(k){const l=k,{t:s}=O(),c=d(!1),i=d(null),_=d({header:null,results:null});function S({header:e,results:t}){_.value={header:e,results:t},l.onSuccess&&l.onSuccess(_.value)}function w(e){if(e.stopPropagation(),e.preventDefault(),c.value)return;const t=e.dataTransfer.files;if(t.length!==1){console.log(s("supportUploadingOneFile"));return}const o=t[0];if(!E(o))return console.log(s("formatNotSupported")),!1;g(o),e.stopPropagation(),e.preventDefault()}function m(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"}function U(){i.value.click()}function b(e){const o=e.target.files[0];o&&g(o)}function g(e){if(i.value=null,!l.beforeUpload){x(e);return}l.beforeUpload(e)&&x(e)}function x(e){return c.value=!0,new Promise((t,o)=>{const n=new FileReader;n.onload=p=>{const r=p.target.result,a=I(r,{type:"array"}),B=a.SheetNames[0],v=a.Sheets[B],V=C(v),F=u.sheet_to_json(v);S({header:V,results:F}),c.value=!1,t()},n.readAsArrayBuffer(e)})}function C(e){const t=[],o=u.decode_range(e["!ref"]);let n;const p=o.s.r;for(n=o.s.c;n<=o.e.c;++n){const r=e[u.encode_cell({c:n,r:p})];let a="UNKNOWN "+n;r&&r.t&&(a=u.format_cell(r)),t.push(a)}return t}function E(e){return/\.(xlsx|xls|csv)$/.test(e.name)}return(e,t)=>{const o=T;return A(),H("div",null,[h("input",{ref_key:"excelUploadInput",ref:i,class:"excel-upload-input",type:"file",accept:".xlsx, .xls",onChange:b},null,544),h("div",{class:"drop",onDrop:w,onDragover:m,onDragenter:m},[D(y(f(s)("dropExcelFileHereOr"))+" ",1),j(o,{loading:f(c),style:{"margin-left":"16px"},size:"small",type:"primary",onClick:U},{default:R(()=>[D(y(f(s)("browse")),1)]),_:1},8,["loading"])],32)])}}},L=P(z,[["__scopeId","data-v-c15025e0"]]);export{L as _};
