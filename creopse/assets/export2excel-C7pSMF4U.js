import{w as m,u as b,S as A}from"./xlsx-DHIYx6t8.js";import{F as y}from"./file-saver-BpnyUUf6.js";function l(a){for(var o=[],e=a.querySelectorAll("tr"),t=[],n=0;n<e.length;++n){for(var r=[],h=e[n],g=h.querySelectorAll("td"),u=0;u<g.length;++u){var c=g[u],S=c.getAttribute("colspan"),f=c.getAttribute("rowspan"),i=c.innerText;if(i!==""&&i==+i&&(i=+i),t.forEach(function(s){if(n>=s.s.r&&n<=s.e.r&&r.length>=s.s.c&&r.length<=s.e.c)for(var w=0;w<=s.e.c-s.s.c;++w)r.push(null)}),(f||S)&&(f=f||1,S=S||1,t.push({s:{r:n,c:r.length},e:{r:n+f-1,c:r.length+S-1}})),r.push(i!==""?i:null),S)for(var v=0;v<S-1;++v)r.push(null)}o.push(r)}return[o,t]}function d(a,o){var e=Date.parse(a);return(e-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3)}function _(a){for(var o={},e={s:{c:1e7,r:1e7},e:{c:0,r:0}},t=0;t!=a.length;++t)for(var n=0;n!=a[t].length;++n){e.s.r>t&&(e.s.r=t),e.s.c>n&&(e.s.c=n),e.e.r<t&&(e.e.r=t),e.e.c<n&&(e.e.c=n);var r={v:a[t][n]};if(r.v!=null){var h=b.encode_cell({c:n,r:t});typeof r.v=="number"?r.t="n":typeof r.v=="boolean"?r.t="b":r.v instanceof Date?(r.t="n",r.z=A._table[14],r.v=d(r.v)):r.t="s",o[h]=r}}return e.s.c<1e7&&(o["!ref"]=b.encode_range(e)),o}function p(){if(!(this instanceof p))return new p;this.SheetNames=[],this.Sheets={}}function x(a){for(var o=new ArrayBuffer(a.length),e=new Uint8Array(o),t=0;t!=a.length;++t)e[t]=a.charCodeAt(t)&255;return o}function D(a){var o=document.getElementById(a),e=l(o),t=e[1],n=e[0],r="SheetJS",h=new p,g=_(n);g["!merges"]=t,h.SheetNames.push(r),h.Sheets[r]=g;var u=m(h,{bookType:"xlsx",bookSST:!1,type:"binary"});y.saveAs(new Blob([x(u)],{type:"application/octet-stream"}),"test.xlsx")}function E({multiHeader:a=[],header:o,data:e,filename:t,merges:n=[],autoWidth:r=!0,bookType:h="xlsx"}={}){t=t||"excel-list",e=[...e],e.unshift(o);for(let f=a.length-1;f>-1;f--)e.unshift(a[f]);var g="SheetJS",u=new p,c=_(e);if(n.length>0&&(c["!merges"]||(c["!merges"]=[]),n.forEach(f=>{c["!merges"].push(b.decode_range(f))})),r){const f=e.map(v=>v.map(s=>s==null?{wch:10}:s.toString().charCodeAt(0)>255?{wch:s.toString().length*2}:{wch:s.toString().length})),i=f[0];for(let v=1;v<f.length;v++)for(let s=0;s<f[v].length;s++)i[s].wch<f[v][s].wch&&(i[s].wch=f[v][s].wch);c["!cols"]=i}u.SheetNames.push(g),u.Sheets[g]=c;var S=m(u,{bookType:h,bookSST:!1,type:"binary"});y.saveAs(new Blob([x(S)],{type:"application/octet-stream"}),`${t}.${h}`)}export{E as export_json_to_excel,D as export_table_to_excel};
