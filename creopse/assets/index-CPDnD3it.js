import{i as ee}from"./ckeditor_ckeditor5-vue-CmLqe3wy.js";import{_ as Ga}from"./PageLayout.vue_vue_type_script_setup_true_lang-B0jZ4xJb.js";import{t as Ye,u as Te,f as pt,v as Wa,e as qe,w as ft,x as Ja,p as ha,_ as Xa,y as it,z as Za,A as el,c as tl,B as al,C as ll,E as nl,F as sl,G as Mt,H as ol,I as ra,J as rl,R as il}from"./main-D6UvRL7q.js";import{_ as Wt}from"./I18nInput-US_Qa5oh.js";import{_ as Pt,a as wa,b as ul}from"./index.vue_vue_type_script_setup_true_lang-CBF6U1jf.js";import{I as P}from"./iconify_vue-DXPEksg3.js";import{u as ie}from"./vue-i18n-B92nPylK.js";import{u as Ae,p as Me,F as Rt,q as Jt,c as Ze,h as x,B as T,l as ya,_ as ba,D as cl,E as dl,C as ml,H as Ke,I as Xt,J as pl,K as qt,a as Bt,b as Ft,d as ka,e as Ca,L as fl,y as _l,s as Zt,w as xa,M as vl,O as $a,P as ea,r as Aa,k as gl,Q as hl,R as wl,o as yl,S as bl,m as kl,T as Cl,U as xl,V as $l}from"./naive-ui-BrWbllCz.js";import{_ as pe}from"./lodash-C_MgVQnG.js";import{_ as ta}from"./NaiveMobileTableAdapter.vue_vue_type_script_setup_true_lang-BsktLLcM.js";import{_ as Al}from"./validator-DC79P2ge.js";import{u as Nl,a as Il,N as J,b as Sl,c as zl,d as Dl,e as Ul,f as Tl}from"./article-D2mVx1i7.js";import{r as Na}from"./vueuse_shared-CcT-C3Xm.js";import{s as Ml}from"./slugify-BFyLO-pG.js";import{v as ia}from"./uuid-8I8R7izr.js";import{_ as Ia}from"./fawmi_vue-google-maps-yyESU4s0.js";import{a as El}from"./vue-router-DjpI5axN.js";const Vl=N=>{const{displayFormErrors:k}=Te(),{request:C}=qe(),{t:_}=ie(),a=Ae(),h=Me();return Ye({queryKey:["news-categories"],operation:"insert",getItemId:o=>o.id??`temp-${crypto.randomUUID()}`,mutationFn:async o=>{h.start();const r=await C({method:"post",url:"/news-categories",data:ft(o,["id"])});if(h.finish(),r.failure&&r.error)throw new Error(r.error);return r.result.data},mutationOptions:{onSuccess:()=>{a.success(_("success"))},onError:o=>{o?.response?.data?.errorCode===pt.FORM_INVALID_DATA?k(o?.response?.data?.data):a.error(_("anErrorOccurred"))},...N}})},Pl=N=>{const{displayFormErrors:k}=Te(),{request:C}=qe(),{t:_}=ie(),a=Ae(),h=Me();return Ye({queryKey:["news-categories"],operation:"update",getItemId:o=>o.id??`temp-${crypto.randomUUID()}`,mutationFn:async o=>{h.start();const r=await C({method:"put",url:`/news-categories/${o.id}`,data:ft(o,["id"])});if(h.finish(),r.failure&&r.error)throw new Error(r.error);return r.result.data},mutationOptions:{onSuccess:()=>{a.success(_("success"))},onError:o=>{o?.response?.data?.errorCode===pt.FORM_INVALID_DATA?k(o?.response?.data?.data):a.error(_("anErrorOccurred"))},...N}})},Rl=N=>{const{request:k}=qe(),{t:C}=ie(),_=Ae(),a=Me();return Ye({queryKey:["news-categories"],operation:"remove",getItemId:h=>h.id??`temp-${crypto.randomUUID()}`,mutationFn:async({id:h})=>{a.start();const o=await k({method:"delete",url:`/news-categories/${h}`});if(a.finish(),!o.success)throw new Error(o.error);return o.result.data},mutationOptions:{onSuccess:()=>{_.success(C("success"))},onError:h=>{_.error(C("anErrorOccurred"))},...N}})},ql=()=>{const{request:N}=qe(),k=Me();return Wa(async C=>{const _=await N({method:"put",url:"/news-categories/position",data:C});if(_.failure&&_.error)throw new Error(_.error);return _.result.data},{onMutate:()=>k.start(),onSettled:()=>k.finish()})},{defineComponent:Bl}=await ee("vue"),{unref:t,resolveComponent:ua,createVNode:i,withCtx:c,isRef:Et,toDisplayString:O,createTextVNode:xe,openBlock:G,createBlock:Pe,createCommentVNode:nt,renderList:ca,Fragment:st,createElementBlock:Ge,normalizeClass:ot,withModifiers:Ct,createElementVNode:ye,normalizeStyle:Fl}=await ee("vue"),Ll={class:"flex items-center"},Ol={class:"flex flex-col"},Hl={class:"text-sm font-bold"},Kl={class:"text-xs font-normal"},Yl={class:"text-xs my-1"},jl={class:"flex items-center"},Ql={class:"flex flex-col"},Gl={class:"text-sm font-bold"},Wl={class:"text-xs font-normal"},Jl={key:0,class:"mt-4"},Xl={class:"flex items-center"},{storeToRefs:Zl}=await ee("pinia"),{inject:en,ref:Re,computed:da,watch:tn}=await ee("vue"),an="categories",ln=Bl({__name:"index",setup(N){const k=Me(),C=Ae(),_=Rt(),{tr:a,fileUrl:h,pickByTheme:o}=Te(),{t:r,locale:fe}=ie(),{data:n,isPending:te,refetch:V}=Ja(),{mutate:ae,isPending:_e}=Rl(),{mutate:ve,isPending:ue}=Pl(),{mutate:Ne,isPending:F}=Vl(),{mutate:Y}=ql(),{isLightTheme:R}=Zl(ha()),le=en("appConfig"),L=Re(""),D=Re(),j=da(()=>{if(!L.value)return E.value;const z=E.value.filter(l=>l.name.toLowerCase().includes(L.value.toLowerCase())||l.description?.toLowerCase().includes(L.value.toLowerCase())||l.children?.some(f=>f.name.toLowerCase().includes(L.value.toLowerCase())||f.description?.toLowerCase().includes(L.value.toLowerCase())));return D.value&&D.value.focus(),z}),E=da(()=>{const z=n.value?.filter(l=>!l.parentId)||[];for(let l=0;l<z.length;l++)z[l].children=n.value?.filter(f=>f.parentId===z[l].id);return z});tn(()=>te.value||F.value||ue.value||_e.value,z=>{z?k.start():k.finish()});const X=Re(24),v=Re(1),A=z=>{X.value=z},ne=Re(null),I=Re(!1),be=Re(null),se=Re(null),b=Re({name:"",description:"",isActive:!0,position:0,image:"",color:""}),oe={name:[{required:!0,message:r("fillRequired")}]},ge=(z,l=null)=>{be.value=pe.cloneDeep(z),z?b.value=pe.cloneDeep(z):b.value={name:"",description:"",isActive:!0,position:0,image:"",color:""},ne.value=l,I.value=!0},Be=async z=>{_.warning({title:r("confirm"),content:z.parentId?r("confirmDeleteSubCategory"):r("confirmDeleteCategory"),positiveText:r("yes"),negativeText:r("no"),onPositiveClick:async()=>{z.id&&ae({id:z.id})}})},Q=async()=>(se.value?.validate(async z=>{if(!z){const l={name:b.value.name,description:b.value.description,isActive:b.value.isActive,position:b.value.position,image:b.value.image,color:b.value.color,parentId:ne.value};be.value?be.value.name!==b.value.name&&(n.value||[]).findIndex(f=>f.name==b.value.name)>-1?C.error(r("sameCategoryNameMessage")):ve({id:be.value.id,...l}):(n.value||[]).findIndex(f=>f.name==b.value.name)>-1?C.error(r("sameCategoryNameMessage")):Ne(l),I.value=!1}}),!1),Ie=async(z,l)=>{Y({items:l},{onSuccess(){V()}})},Fe=Re(!1),_t=async z=>{b.value.image=z,Fe.value=!1},vt=()=>{b.value.image=""};return(z,l)=>{const f=P,je=Jt,gt=Pt,he=ml,et=ba,Ee=ua("Draggable"),ht=dl,wt=cl,ut=Xt,Qe=pl,q=ya,tt=Xa,Se=wa,yt=Wt,ke=Ft,Nt=fl,Ve=Ca,It=ua("color-picker"),g=ka,St=_l,Lt=Zt,Ot=Bt,zt=qt;return G(),Ge(st,null,[i(gt,{to:"#add-category-action"},{default:c(()=>[i(je,{align:"center"},{default:c(()=>[i(t(Ze),{ref_key:"searchInputRef",ref:D,value:t(L),"onUpdate:value":l[0]||(l[0]=y=>Et(L)?L.value=y:null),clearable:!0,placeholder:t(r)("search")},{suffix:c(()=>[i(t(x),null,{default:c(()=>[i(f,{icon:"carbon:search"})]),_:1})]),_:1},8,["value","placeholder"]),t(j).length?(G(),Pe(t(T),{key:0,type:"primary",secondary:"",onClick:l[1]||(l[1]=y=>ge(null))},{icon:c(()=>[i(t(x),{size:"18"},{default:c(()=>[i(f,{icon:"carbon:add-alt"})]),_:1})]),default:c(()=>[xe(" "+O(t(r)("addCategory")),1)]),_:1})):nt("",!0)]),_:1})]),_:1}),i(tt,{appear:"",name:"slide-fade"},{default:c(()=>[ye("section",null,[i(q,{show:t(te)},{default:c(()=>[t(j)&&t(j).length?(G(),Ge(st,{key:0},[i(Ee,{list:t(E),onChange:l[2]||(l[2]=y=>Ie(y,t(E)))},{default:c(()=>[(G(!0),Ge(st,null,ca(t(j).slice((t(v)-1)*t(X),t(v)*t(X)),y=>(G(),Pe(et,{key:y.id,embedded:"",size:"small",class:"mb-1"},{default:c(()=>[i(wt,{"default-expanded-names":y.children?.length?["1"]:[],"display-directive":"show"},{"header-extra":c(({collapsed:we})=>[i(je,{align:"center"},{default:c(()=>[i(t(Ke),{size:"small",bordered:!1,type:y.isActive?"success":"error"},{default:c(()=>[xe(O(y.isActive?t(r)("visible"):t(r)("hidden")),1)]),_:2},1032,["type"]),i(he,{vertical:"",class:ot(["!mx-0",t(o)("!bg-zinc-400","!bg-slate-500")])},null,8,["class"]),i(t(T),{size:"small",type:"primary",secondary:"",onClick:Ct(at=>ge(y),["stop"])},{default:c(()=>[i(t(x),null,{default:c(()=>[i(f,{icon:"carbon:edit"})]),_:1})]),_:1},8,["onClick"]),i(t(T),{size:"small",type:"error",secondary:"",onClick:Ct(at=>Be(y),["stop"])},{default:c(()=>[i(t(x),null,{default:c(()=>[i(f,{icon:"carbon:trash-can"})]),_:1})]),_:1},8,["onClick"]),i(t(T),{size:"small",type:"info",secondary:"",onClick:Ct(at=>ge(null,y.id),["stop"])},{icon:c(()=>[i(t(x),null,{default:c(()=>[i(f,{icon:"carbon:category"})]),_:1})]),default:c(()=>[xe(" "+O(t(r)("subCategory"))+" ",1),i(t(Ke),{size:"small",bordered:!1,type:"primary",class:"ml-1"},{default:c(()=>[xe(O(y.children?.length),1)]),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1024),l[16]||(l[16]=ye("div",{class:"w-6"},null,-1)),i(t(x),null,{default:c(()=>[we?(G(),Pe(f,{key:0,icon:"fa-solid:chevron-left"})):(G(),Pe(f,{key:1,icon:"fa-solid:chevron-down"}))]),_:2},1024)]),arrow:c(()=>[...l[17]||(l[17]=[ye("span",null,null,-1)])]),default:c(()=>[i(ht,{name:"1"},{header:c(()=>[ye("div",Ll,[i(t(x),{size:"21",class:"cursor-move mr-4"},{default:c(()=>[i(f,{icon:"fa-solid:grip-lines"})]),_:1}),i(he,{vertical:"",class:ot(t(o)("!bg-zinc-400","!bg-slate-500"))},null,8,["class"]),ye("div",Ol,[ye("span",Hl,O(t(a)(y.name))+" ("+O(y.articlesCount)+" "+O(t(r)("article_s"))+") ",1),ye("small",Kl,O(y.slug),1)])])]),default:c(()=>[y.description?(G(),Ge(st,{key:0},[i(he,{class:ot([t(o)("!bg-zinc-300","!bg-slate-500"),"!my-0 !h-0.5"])},null,8,["class"]),ye("div",Yl,O(t(a)(y.description)),1)],64)):nt("",!0),y.children?.length?(G(),Ge(st,{key:1},[i(he,{class:ot([t(o)("!bg-zinc-300","!bg-slate-500"),"!mt-0 !mb-2 !h-0.5"])},null,8,["class"]),i(Ee,{list:y.children,onChange:we=>Ie(we,y.children||[])},{default:c(()=>[(G(!0),Ge(st,null,ca(y.children,we=>(G(),Pe(et,{key:we.id,size:"small",class:"mb-1"},{header:c(()=>[ye("div",jl,[i(t(x),{size:"21",class:"cursor-move mr-4"},{default:c(()=>[i(f,{icon:"fa-solid:grip-lines"})]),_:1}),i(he,{vertical:"",class:ot(t(o)("!bg-zinc-400","!bg-slate-500"))},null,8,["class"]),ye("div",Ql,[ye("span",Gl,O(t(a)(we.name)),1),ye("small",Wl,O(we.slug),1)])])]),"header-extra":c(()=>[i(je,{align:"center"},{default:c(()=>[i(t(Ke),{size:"small",bordered:!1,type:we.isActive?"success":"error"},{default:c(()=>[xe(O(we.isActive?t(r)("visible"):t(r)("hidden")),1)]),_:2},1032,["type"]),i(he,{vertical:"",class:ot(["!mx-0",t(o)("!bg-zinc-400","!bg-slate-500")])},null,8,["class"]),i(t(T),{size:"small",type:"primary",secondary:"",onClick:Ct(at=>ge(we,y.id),["stop"])},{default:c(()=>[i(t(x),null,{default:c(()=>[i(f,{icon:"carbon:edit"})]),_:1})]),_:1},8,["onClick"]),i(t(T),{size:"small",type:"error",secondary:"",onClick:Ct(at=>Be(we),["stop"])},{default:c(()=>[i(t(x),null,{default:c(()=>[i(f,{icon:"carbon:trash-can"})]),_:1})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:2},1032,["list","onChange"])],64)):nt("",!0)]),_:2},1024)]),_:2},1032,["default-expanded-names"])]),_:2},1024))),128))]),_:1},8,["list"]),i(ut,{page:t(v),"onUpdate:page":l[3]||(l[3]=y=>Et(v)?v.value=y:null),class:"mt-5 justify-end","show-size-picker":"","page-size":t(X),"page-sizes":[6,12,24,36,48,60],"page-count":Math.ceil(t(E).length/t(X)),"onUpdate:pageSize":A},{prefix:c(()=>[xe(O(`${t(E).length} ${t(r)("categorie_s")}`),1)]),_:1},8,["page","page-size","page-count"])],64)):(G(),Pe(et,{key:1,size:"large",class:ot(`mb-2 !border-dashed !border-2 ${t(o)("!border-zinc-300","!border-zinc-600")}`)},{default:c(()=>[i(Qe,{description:t(r)("noCategoryAvailable")},{icon:c(()=>[i(t(x),null,{default:c(()=>[t(L)?(G(),Pe(f,{key:0,icon:"carbon:search"})):(G(),Pe(f,{key:1,icon:"carbon:categories"}))]),_:1})]),extra:c(()=>[t(L)?nt("",!0):(G(),Ge("div",Jl,[i(t(T),{size:"small",secondary:"",onClick:l[4]||(l[4]=y=>ge(null))},{icon:c(()=>[i(t(x),null,{default:c(()=>[i(f,{icon:"carbon:add-alt"})]),_:1})]),default:c(()=>[xe(" "+O(t(r)("addCategory")),1)]),_:1})]))]),_:1},8,["description"])]),_:1},8,["class"]))]),_:1},8,["show"])])]),_:1}),i(Se,{show:t(Fe),"onUpdate:show":l[5]||(l[5]=y=>Et(Fe)?Fe.value=y:null),title:t(r)("selectImage"),"upload-config":{folder:an,limit:0,maxSize:0,baseUrl:t(le)?.apiUrl+"/media-files/upload",excludedExtensions:[]},onSubmit:_t},null,8,["show","title","upload-config"]),i(zt,{show:t(I),"onUpdate:show":l[14]||(l[14]=y=>Et(I)?I.value=y:null),loading:t(F)||t(ue)||t(_e),preset:"dialog",style:{width:"500px"},"show-icon":!1,bordered:!1,"mask-closable":!1,title:t(be)?t(ne)?t(r)("editSubCategory"):t(r)("editCategory"):t(ne)?t(r)("addSubCategory"):t(r)("addCategory"),"positive-text":t(r)("validate"),"negative-text":t(r)("cancel"),onPositiveClick:Q,onNegativeClick:l[15]||(l[15]=y=>I.value=!1)},{default:c(()=>[i(Ot,{ref_key:"formRef",ref:se,class:"mt-5",model:t(b),rules:oe,"show-require-mark":!1,size:"medium"},{default:c(()=>[i(ke,{"show-label":!1,path:"name"},{default:c(()=>[i(yt,{modelValue:t(b).name,"onUpdate:modelValue":l[6]||(l[6]=y=>t(b).name=y),placeholder:t(r)("name"),class:"w-full",sync:""},{label:c(()=>[xe(O(t(r)("name")),1)]),_:1},8,["modelValue","placeholder"])]),_:1}),i(ke,{"show-label":!1,path:"description"},{default:c(()=>[i(yt,{modelValue:t(b).description,"onUpdate:modelValue":l[7]||(l[7]=y=>t(b).description=y),placeholder:t(r)("description"),type:"textarea",class:"w-full",rows:3,sync:""},{label:c(()=>[xe(O(t(r)("description")),1)]),_:1},8,["modelValue","placeholder"])]),_:1}),i(g,{"x-gap":"12",span:24},{default:c(()=>[i(Ve,{span:12,label:t(r)("position"),path:"position"},{default:c(()=>[i(Nt,{value:t(b).position,"onUpdate:value":l[8]||(l[8]=y=>t(b).position=y),placeholder:t(r)("position"),class:"w-full",min:0},null,8,["value","placeholder"])]),_:1},8,["label"]),i(Ve,{span:12,label:t(r)("color"),path:"color"},{default:c(()=>[ye("div",Xl,[t(b).color?(G(),Ge(st,{key:0},[i(t(T),{text:"",type:"error",style:{"font-size":"21px"},onClick:l[9]||(l[9]=y=>t(b).color="")},{default:c(()=>[i(t(x),null,{default:c(()=>[i(f,{icon:"carbon:trash-can"})]),_:1})]),_:1}),i(he,{vertical:""})],64)):nt("",!0),i(It,{"pure-color":t(b).color,"onUpdate:pureColor":l[10]||(l[10]=y=>t(b).color=y),"default-pure-color":"#00000000","picker-type":"chrome","use-type":"pure",format:"hex",shape:"circle","z-index":5e3,theme:t(R)?"white":"black",lang:t(fe)},null,8,["pure-color","theme","lang"])])]),_:1},8,["label"])]),_:1}),i(he,{dashed:"",class:"!my-2"}),i(g,{"x-gap":"12",span:24},{default:c(()=>[i(Ve,{span:12,label:t(r)("preview"),path:"image"},{default:c(()=>[i(je,{align:"center",justify:"center",style:{height:"100%"}},{default:c(()=>[i(St,{class:"cursor-pointer","object-fit":"cover",style:Fl("border: 1px dashed "+t(o)("green","white")),size:150,src:t(h)(t(b).image||""),onClick:l[11]||(l[11]=y=>Fe.value=!0)},{default:c(()=>[t(b).image?nt("",!0):(G(),Pe(t(x),{key:0,size:64},{default:c(()=>[i(f,{icon:"carbon:image",class:"text-gray-400"})]),_:1}))]),_:1},8,["style","src"]),t(b).image?(G(),Pe(t(T),{key:0,quaternary:"",onClick:l[12]||(l[12]=y=>vt())},{icon:c(()=>[i(t(x),null,{default:c(()=>[i(f,{icon:"carbon:trash-can"})]),_:1})]),default:c(()=>[xe(" "+O(t(r)("clear")),1)]),_:1})):nt("",!0)]),_:1})]),_:1},8,["label"]),i(Ve,{span:12,label:t(r)("status"),path:"isActive"},{default:c(()=>[i(Lt,{value:t(b).isActive,"onUpdate:value":l[13]||(l[13]=y=>t(b).isActive=y),size:"small"},{checked:c(()=>[xe(O(t(r)("visible")),1)]),unchecked:c(()=>[xe(O(t(r)("hidden")),1)]),_:1},8,["value"])]),_:1},8,["label"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show","loading","title","positive-text","negative-text"])],64)}}}),nn=N=>{const{displayFormErrors:k}=Te(),{request:C}=qe(),{t:_}=ie(),a=Me(),h=Ae();return Ye({queryKey:["news-comments"],operation:"insert",isPaginated:!0,insertToPage:"first",getItemId:o=>"id"in o&&o.id?o.id:`temp-${crypto.randomUUID()}`,mutationFn:async o=>{a.start();try{const r=await C({method:"post",url:"/news-comments",data:ft(o,["id"])});if(!r.success)throw new Error(r.error||_("anErrorOccurred"));return r.result.data}finally{a.finish()}},mutationOptions:{onSuccess:()=>{h.success(_("success"))},onError:o=>{switch(o?.response?.data?.errorCode){case pt.FORM_INVALID_DATA:k(o?.response?.data?.data);break;default:h.error(_("anErrorOccurred"))}},...N}})},sn=N=>{const{displayFormErrors:k}=Te(),{request:C}=qe(),{t:_}=ie(),a=Me(),h=Ae();return Ye({queryKey:["news-comments"],operation:"update",isPaginated:!0,getItemId:o=>o.id??`temp-${crypto.randomUUID()}`,mutationFn:async o=>{a.start();try{const r=await C({method:"put",url:`/news-comments/${o.id}`,data:ft(o,["id"])});if(!r.success)throw new Error(r.error||_("anErrorOccurred"));return r.result.data}finally{a.finish()}},mutationOptions:{onSuccess:()=>{h.success(_("success"))},onError:o=>{switch(o?.response?.data?.errorCode){case pt.FORM_INVALID_DATA:k(o?.response?.data?.data);break;default:h.error(_("anErrorOccurred"))}},...N}})},on=N=>{const{request:k}=qe(),{t:C}=ie(),_=Me(),a=Ae();return Ye({queryKey:["news-comments"],operation:"remove",isPaginated:!0,allowEmptyPages:!1,getItemId:h=>h.id??`temp-${crypto.randomUUID()}`,mutationFn:async({id:h})=>{_.start();const o=await k({method:"delete",url:`/news-comments/${h}`});if(_.finish(),!o.success)throw new Error(o.error);return o.result?.data},mutationOptions:{onSuccess:()=>{a.success(C("success"))},onError:h=>{a.error(C("anErrorOccurred"))},...N}})},{defineComponent:rn}=await ee("vue"),{unref:w,createVNode:H,withCtx:ce,toDisplayString:Yt,createTextVNode:jt,vShow:un,withDirectives:cn,resolveComponent:zs,isRef:ma,Fragment:dn,openBlock:mn,createElementBlock:pn}=await ee("vue"),{ref:$e,computed:Vt,h:K,watch:pa}=await ee("vue"),fn=rn({__name:"index",setup(N){const k=Rt(),{mergeArrays:C,tr:_}=Te(),{t:a,locale:h}=ie(),{mutate:o,isPending:r}=on(),{mutate:fe,isPending:n}=nn(),{mutate:te,isPending:V}=sn(),ae=$e(""),_e=Na(ae,500),ve=$e(),ue=$e([]),Ne=Vt(()=>[{title:a("content"),key:"content",resizable:!0,width:300,fixed:"left",sortOrder:!1,sorter:"default",render(l){return K(xa,{class:"text-xs",lineClamp:1,expandTrigger:"click",tooltip:!1},{default:()=>l.content})}},{title:a("name"),key:"name",resizable:!0,width:150,ellipsis:{tooltip:!0}},{title:a("article"),key:"article",resizable:!0,width:250,ellipsis:{tooltip:!0},render(l){return K("div",{},{default:()=>_(l.article?.title)})},sortOrder:!1,sorter:"default"},{title:a("email"),key:"email",resizable:!0,width:150,ellipsis:{tooltip:!0}},{title:a("status"),key:"isActive",width:100,render(l){return K(Ke,{type:l.isActive?"success":"error",bordered:!1},{default:()=>l.isActive?a("published"):a("unpublished")})},sortOrder:!1,sorter:"default"},{title:a("lastEdition"),key:"updatedAt",width:125,render(l){return K("div",{},{default:()=>it(l.updatedAt,{locale:h.value})})}},{title:a("creation"),key:"createdAt",width:125,render(l){return K("div",{},{default:()=>it(l.createdAt,{locale:h.value})})}},{title:()=>K($a,{},{default:()=>[K(Ze,{ref:ve,placeholder:a("search"),value:ae.value,onInput:l=>{ae.value=l,ae.value||E()},clearable:!0}),K(T,{onClick:()=>{E()}},{default:()=>K(x,{color:"white"},{default:()=>K(P,{icon:"carbon:search"})})})]}),key:"actions",width:200,render(l){return K("div",{class:"flex justify-end items-center w-full"},[K(vl,{value:l.isActive?1:0,"onUpdate:value":async f=>{te({id:l.id,isActive:f})},trigger:"click",placement:"left",options:[{label:a("published"),value:1},{label:a("unpublished"),value:0}]},{default:()=>[K(T,{size:"small",type:"warning",secondary:!0,renderIcon:()=>K(x,null,{default:()=>K(P,{icon:"carbon:certificate-check"})})},{default:()=>a("status")})]}),K("div",{class:"w-2"}),K(T,{size:"small",type:"error",secondary:!0,onClick:()=>{k.warning({title:a("confirm"),content:a("confirmDeleteComment"),positiveText:a("yes"),negativeText:a("no"),onPositiveClick:async()=>{o(l)}})},renderIcon:()=>K(x,null,{default:()=>K(P,{icon:"carbon:trash-can"})})})])},fixed:"right"}]),F=$e(0),Y=$e(24),R=$e(1),le=Vt(()=>({pageSize:Y.value,query:_e.value,page:R.value})),L=l=>{R.value=l,E()},D=l=>{Y.value=l,E()},{data:j,refetch:E,isPending:X}=Za(le);pa(()=>j.value,l=>{ue.value=l?.comments||[],F.value=l?.meta?.total||0,R.value=l?.meta?.currentPage||1},{deep:!0,immediate:!0});const v=$e(!1),A=$e(null),ne=$e(null),I=$e({name:"",email:"",content:"",isActive:!0,articleId:void 0}),be={name:[{required:!0,message:a("fillRequired")}],email:[{required:!0,message:a("fillRequired")},{trigger:["input"],validator(l,f){return f&&!Al.isEmail(f)?new Error(a("invalidEmail")):!0}}],content:[{required:!0,message:a("fillRequired")}],articleId:[{required:!0,message:a("fillRequired")}]},se=l=>{A.value=pe.cloneDeep(l),I.value={name:"",email:"",content:"",isActive:!0,articleId:void 0},v.value=!0},b=async()=>(ne.value?.validate(async l=>{if(!l){const f={name:I.value.name,email:I.value.email,content:I.value.content,isActive:I.value.isActive,articleId:I.value.articleId};A.value?(f.id=A.value.id,te(f)):fe(f),v.value=!1}}),!1),oe=$e([]),ge=$e([]),{mutateAsync:Be,isPending:Q}=Nl(),{mutateAsync:Ie,isPending:Fe}=Il(),_t=Vt(()=>Fe.value||Q.value),vt=async l=>{if(!l.length){ge.value=[];return}ge.value=await Ie(l)};pa(()=>I.value.articleId,async l=>{l&&(oe.value=await Be({ids:[l]}))});const z=Vt(()=>C(oe.value,ge.value,"id"));return(l,f)=>{const je=Pt,gt=ea,he=ta,et=Xt,Ee=Ft,ht=Aa,wt=Zt,ut=Bt,Qe=qt;return mn(),pn(dn,null,[H(je,{to:"#add-comment-action"},{default:ce(()=>[cn(H(w(T),{type:"primary",secondary:"",onClick:f[0]||(f[0]=q=>se(null))},{icon:ce(()=>[H(w(x),{size:"18"},{default:ce(()=>[H(w(P),{icon:"carbon:add-alt"})]),_:1})]),default:ce(()=>[jt(" "+Yt(w(a)("addComment")),1)]),_:1},512),[[un,!1]])]),_:1}),H(he,null,{default:ce(()=>[H(gt,{"pagination-behavior-on-filter":"first",columns:w(Ne),data:w(ue),loading:w(X),"single-line":!1,"scroll-x":1500,striped:""},null,8,["columns","data","loading"])]),_:1}),H(et,{page:w(R),"onUpdate:page":[f[1]||(f[1]=q=>ma(R)?R.value=q:null),L],class:"mt-5 justify-end","show-size-picker":"","page-size":w(Y),"page-sizes":[6,12,24,36,48,60],"page-count":Math.ceil(w(F)/w(Y)),"onUpdate:pageSize":D},null,8,["page","page-size","page-count"]),H(Qe,{show:w(v),"onUpdate:show":f[7]||(f[7]=q=>ma(v)?v.value=q:null),loading:w(n)||w(V)||w(r),preset:"dialog",style:{width:"500px"},"show-icon":!1,bordered:!1,"mask-closable":!1,title:w(A)?w(a)("editComment"):w(a)("addComment"),"positive-text":w(a)("validate"),"negative-text":w(a)("cancel"),onPositiveClick:b,onNegativeClick:f[8]||(f[8]=q=>v.value=!1)},{default:ce(()=>[H(ut,{ref_key:"formRef",ref:ne,class:"mt-5",model:w(I),rules:be,"show-require-mark":!1,size:"medium"},{default:ce(()=>[H(Ee,{label:w(a)("name"),path:"name"},{default:ce(()=>[H(w(Ze),{value:w(I).name,"onUpdate:value":f[2]||(f[2]=q=>w(I).name=q),placeholder:w(a)("name"),class:"w-full"},null,8,["value","placeholder"])]),_:1},8,["label"]),H(Ee,{label:w(a)("email"),path:"email"},{default:ce(()=>[H(w(Ze),{value:w(I).email,"onUpdate:value":f[3]||(f[3]=q=>w(I).email=q),placeholder:w(a)("email"),class:"w-full"},null,8,["value","placeholder"])]),_:1},8,["label"]),H(Ee,{label:w(a)("article"),path:"article"},{default:ce(()=>[H(ht,{value:w(I).articleId,"onUpdate:value":f[4]||(f[4]=q=>w(I).articleId=q),options:w(z),placeholder:w(a)("article"),loading:w(_t),filterable:"",clearable:"",remote:"","value-field":"id","label-field":"fullname",class:"w-full",onSearch:vt},null,8,["value","options","placeholder","loading"])]),_:1},8,["label"]),H(Ee,{label:w(a)("content"),path:"content"},{default:ce(()=>[H(w(Ze),{value:w(I).content,"onUpdate:value":f[5]||(f[5]=q=>w(I).content=q),placeholder:w(a)("content"),type:"textarea",class:"w-full"},null,8,["value","placeholder"])]),_:1},8,["label"]),H(Ee,{label:w(a)("status"),path:"isActive"},{default:ce(()=>[H(wt,{value:w(I).isActive,"onUpdate:value":f[6]||(f[6]=q=>w(I).isActive=q),size:"small"},{checked:ce(()=>[jt(Yt(w(a)("published")),1)]),unchecked:ce(()=>[jt(Yt(w(a)("unpublished")),1)]),_:1},8,["value"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["show","loading","title","positive-text","negative-text"])],64)}}}),_n=()=>{const{t:N}=ie(),k=[{label:N("draft"),value:J.DRAFT,tagType:"default"},{label:N("pending"),value:J.PENDING,tagType:"info"},{label:N("published"),value:J.PUBLISHED,tagType:"success"},{label:N("trash"),value:J.TRASH,tagType:"error"}];return{getNewsArticleStatusTagType:a=>k.find(h=>h.value===a)?.tagType||"default",getNewsArticleStatusLabel:a=>k.find(h=>h.value===a)?.label,newsArticleStatus:k}},{defineComponent:vn}=await ee("vue"),{unref:e,toDisplayString:U,createElementVNode:rt,createVNode:u,withCtx:m,createTextVNode:B,openBlock:Z,createBlock:ct,createCommentVNode:dt,createElementBlock:ze,resolveComponent:Ds,isRef:De,renderList:fa,Fragment:Qt,vShow:gn,withDirectives:hn,normalizeStyle:wn}=await ee("vue"),yn={key:0,class:"flex items-center gap-3"},bn={key:1,class:"flex items-center gap-3"},kn={class:"flex justify-end"},Cn={key:0},xn={key:0},$n={key:0},An={key:1},Nn={key:2},In={key:3},Sn={class:"flex justify-center"},zn={class:"text-base"},Dn={class:"px-10 mt-20"},Un={class:"w-full text-center"},{inject:Tn,ref:M,computed:xt,h:$,watch:_a}=await ee("vue"),Mn="articles",En=vn({__name:"index",setup(N){const k=Ae(),C=Rt(),{tr:_,pickByTheme:a,fileUrl:h}=Te(),{newsArticleStatus:o}=_n(),{tags:r,orderedCategories:fe}=el(),{t:n,locale:te}=ie(),V=tl(),ae=Tn("appConfig"),{mutate:_e,isPending:ve}=Sl(),{mutate:ue,isPending:Ne}=zl(),{mutate:F,isPending:Y}=Dl(),{mutate:R,isPending:le}=Ul(),{mutate:L,isPending:D}=Tl(),j=M([]),E=M([]),X=M([]),v=M(0),A=M(""),ne=M(),I=Na(A,500),be=M([]),se=M(!1),b=M(null),oe=M(null),ge=xt(()=>[{type:"selection"},{title:n("title"),key:"title",resizable:!0,width:250,fixed:"left",ellipsis:{tooltip:!0},render(p){return $("div",{},{default:()=>_(p.title)})}},{title:n("summary"),key:"summary",resizable:!0,width:200,render(p){return $(xa,{class:"text-xs",lineClamp:1,expandTrigger:"click",tooltip:!1},{default:()=>_(p.summary)})}},{title:n("categories"),key:"categories",width:150,render(p){return $("div",{},{default:()=>p.categories?.map(s=>s.name).map(s=>$(Ke,{type:"info",size:"small",class:"mr-1 mb-1"},{default:()=>_(s)}))})}},{title:n("tags"),key:"tags",width:150,render(p){return $("div",{},{default:()=>p.tags?.map(s=>s.name).map(s=>$(Ke,{type:"primary",size:"small",class:"mr-1 mb-1"},{default:()=>_(s)}))})}},{title:n("headline"),key:"isHeadline",resizable:!0,width:150,ellipsis:{tooltip:!0},render(p){return $(Ke,{type:p.isHeadline?"success":"error",bordered:!1},{default:()=>p.isHeadline?n("yes"):n("no")})}},{title:n("author"),key:"author",resizable:!0,width:150,ellipsis:{tooltip:!0},render(p){return $("div",{},{default:()=>p.author?.firstname+" "+p.author?.lastname})}},{title:n("lastEdition"),key:"updatedAt",width:125,render(p){return $("div",{},{default:()=>it(p.updatedAt,{locale:te.value})})}},{title:n("creation"),key:"createdAt",width:125,render(p){return $("div",{},{default:()=>it(p.createdAt,{locale:te.value})})}},{title:()=>$($a,{},{default:()=>[$(Ze,{ref:ne,placeholder:n("search"),value:A.value,onInput:p=>{A.value=p,A.value||l()},clearable:!0}),$(T,{onClick:()=>{l()}},{default:()=>$(x,{color:"white"},{default:()=>$(P,{icon:"carbon:search"})})})]}),key:"actions",width:225,render(p){return $("div",{class:"flex justify-end items-center w-full"},[$(T,{size:"small",type:"warning",secondary:!0,onClick:()=>{zt(p)},renderIcon:()=>$(x,null,{default:()=>$(P,{icon:"carbon:edit"})})},{default:()=>n("edit")}),$("div",{class:"w-2"}),$(T,{size:"small",type:"info",secondary:!0,onClick:()=>{b.value=p,oe.value=p.status,se.value=!0},renderIcon:()=>$(x,null,{default:()=>$(P,{icon:"mdi:equal"})})},v.value==J.TRASH?{}:{default:()=>n("status")}),$("div",{class:"w-2"}),v.value==J.TRASH?$(T,{size:"small",type:"error",secondary:!0,onClick:()=>{C.warning({title:n("confirm"),content:n("confirmDeleteComment"),positiveText:n("yes"),negativeText:n("no"),onPositiveClick:async()=>{p.id&&_e(p)}})},renderIcon:()=>$(x,null,{default:()=>$(P,{icon:"carbon:trash-can"})})}):null])},fixed:"right"}]),Be=M(0),Q=M(24),Ie=M(1),Fe=xt(()=>({pageSize:Q.value,query:I.value,page:Ie.value,status:v.value,categories:j.value,tags:E.value,months:X.value})),_t=p=>{Ie.value=p,l()},vt=p=>{Q.value=p,l()},{data:z,refetch:l,isPending:f}=al(Fe);_a(()=>z.value,p=>{be.value=p?.articles||[],Be.value=p?.meta?.total||0,Ie.value=p?.meta?.currentPage||1},{deep:!0,immediate:!0});const{data:je}=ll(),{data:gt}=nl(),{data:he}=sl(),{data:et}=Mt(J.DRAFT),{data:Ee}=Mt(J.PUBLISHED),{data:ht}=Mt(J.PENDING),{data:wt}=Mt(J.TRASH),{data:ut}=ol(V.userData?.id||0),Qe=xt(()=>gt.value?.map(p=>({label:p,value:p}))),q=xt(()=>!!(Y.value||Ne.value||le.value||ve.value||D.value)),tt=M(!1),Se=M([]),yt=M(Se.value),ke=M([]),Nt=M(ke.value),Ve=M(null),It=M(null),g=M({authorId:V.userData?.id,publisherId:V.userData?.id,title:"",slug:"",summary:"",content:'{"fr":""}',featuredImage:"",featuredImageUrl:"",legend:"",allowComments:!0,isHeadline:!1,status:J.DRAFT,publishedAt:ra(new Date,{outPattern:"YYYY-MM-DD HH:mm:ss",locale:te.value})}),St=M(g.value),Lt={title:[{required:!0,message:n("fillRequired")}],slug:[{required:!0,message:n("fillRequired")}],content:[{required:!0,message:n("fillRequired")}],summary:[{required:!0,message:n("fillRequired")}],featuredImage:[{required:!0,message:n("fillRequired")}],authorId:[{required:!0,message:n("fillRequired")}],publisherId:[{required:!0,message:n("fillRequired")}]},Ot=xt(()=>pe.isEqual(Se.value,yt.value)&&pe.isEqual(ke.value,Nt.value)&&pe.isEqual(g.value,St.value)),zt=p=>{Ve.value=pe.cloneDeep(p),p?(g.value=pe.cloneDeep(p),Se.value=p.tags?.map(s=>s.id)??[],ke.value=p.categories?.map(s=>s.id)??[]):(g.value={authorId:V.userData?.id,publisherId:V.userData?.id,title:"",slug:"",summary:"",content:'{"fr":""}',featuredImage:"",featuredImageUrl:"",legend:"",allowComments:!0,isHeadline:!1,status:J.DRAFT,publishedAt:ra(new Date,{outPattern:"YYYY-MM-DD HH:mm:ss",locale:te.value})},Se.value=[],ke.value=[]),yt.value=pe.cloneDeep(Se.value),Nt.value=pe.cloneDeep(ke.value),St.value=pe.cloneDeep(g.value),tt.value=!0},y=async()=>(It.value?.validate(async p=>{if(!p){const s={authorId:g.value.authorId,publisherId:g.value.publisherId,title:g.value.title,slug:g.value.slug,summary:g.value.summary,content:g.value.content,featuredImage:g.value.featuredImage,legend:g.value.legend,allowComments:g.value.allowComments,isHeadline:g.value.isHeadline,status:g.value.status,publishedAt:g.value.publishedAt,categories:ke.value,tags:Se.value};Ve.value?ue({id:Ve.value.id,...s}):F(s),tt.value=!1}}),!1),we=async()=>{b.value&&ue({id:b.value?.id,status:oe.value},{onSuccess:()=>{b.value=null,oe.value=null,se.value=!1}})},at=p=>[p.parentId?$(x,{style:{verticalAlign:"-0.15em",marginRight:"4px"}},{default:()=>$(P,{icon:"mdi:arrow-right"})}):null,`${_(p.name)}`],aa=p=>$("span",{},{default:()=>`${_(p.name)||p.name}`}),Sa=p=>$("span",{},{default:()=>it(p.label,{inPattern:"YYYY-MM",outPattern:"MMMM YYYY",locale:te.value})}),za=p=>/^[a-z0-9_-]*$/.test(p);_a(()=>g.value.title,p=>{Ve.value||(g.value.slug=Ml(_(p),{trim:!0,lower:!0,strict:!0}))});const bt=M(!1),Da=async p=>{g.value.featuredImage=p,bt.value=!1},Ua=()=>{g.value.featuredImage=""},la=M(ia()),Ce=M([]),Ta=p=>p.id,Ma=p=>{Ce.value=p};function Ht(){Ce.value=[],la.value=ia()}const Ea=async()=>(Ce.value.length?C.warning({title:n("confirm"),content:n("deleteSelectionWarningMessage",[Ce.value.length]),positiveText:n("yes"),negativeText:n("no"),onPositiveClick:()=>{L(Ce.value,{onSuccess:()=>{Ht()}})}}):k.warning(n("noItemSelected")),!1),Va=async()=>(Ce.value.length?C.warning({title:n("confirm"),content:n("editSelectionStatusWarningMessage",[Ce.value.length]),positiveText:n("yes"),negativeText:n("no"),onPositiveClick:async()=>{R({selectedItems:Ce.value,data:{status:oe.value}},{onSuccess:()=>{se.value=!1,Ht()}})}}):k.warning(n("noItemSelected")),!1);return(p,s)=>{const kt=gl,lt=Aa,Pa=Pt,Dt=wl,na=hl,sa=ba,Ra=ea,qa=ta,Ba=Xt,Fa=wa,La=ya,Oa=qt,Ha=kl,Ka=Jt,Ut=Wt,Le=Ft,Tt=Ca,Kt=ka,Ya=bl,oa=yl,ja=Bt,Qa=ul;return Z(),ze(Qt,null,[u(Pa,{to:"#add-article-action"},{default:m(()=>[e(Ce).length?(Z(),ze("section",yn,[rt("span",null,U(e(n)("nbItemsSelected",[e(Ce).length])),1),e(v)==e(J).TRASH?(Z(),ct(e(T),{key:0,secondary:"",type:"error",size:"small",onClick:Ea},{icon:m(()=>[u(e(x),null,{default:m(()=>[u(e(P),{icon:"carbon:trash-can"})]),_:1})]),default:m(()=>[B(" "+U(e(n)("delete")),1)]),_:1})):dt("",!0),u(e(T),{type:"info",size:"small",secondary:"",onClick:s[0]||(s[0]=()=>{b.value=null,oe.value=null,se.value=!0})},{icon:m(()=>[u(e(x),null,{default:m(()=>[u(e(P),{icon:"mdi:equal"})]),_:1})]),default:m(()=>[B(" "+U(e(n)("editStatus")),1)]),_:1}),u(e(T),{type:"warning",size:"small",secondary:"",onClick:Ht},{icon:m(()=>[u(e(x),null,{default:m(()=>[u(e(P),{icon:"carbon:close"})]),_:1})]),default:m(()=>[B(" "+U(e(n)("cancelSelection")),1)]),_:1})])):(Z(),ze("section",bn,[u(lt,{value:e(X),"onUpdate:value":[s[2]||(s[2]=d=>De(X)?X.value=d:null),s[3]||(s[3]=d=>e(l)())],"render-label":Sa,options:e(Qe),placeholder:e(n)("months"),"max-tag-count":"responsive",filterable:"",multiple:"","label-field":"label","value-field":"value",class:"!w-[200px]"},{action:m(()=>[u(kt,{size:"large",class:"w-full","default-checked":e(Qe)?.length&&e(X).length===e(Qe)?.length,"onUpdate:checked":s[1]||(s[1]=d=>{d?X.value=e(Qe)?.map(Oe=>Oe.value)||[]:X.value=[],e(l)()})},{default:m(()=>[B(U(e(n)("selectAll")),1)]),_:1},8,["default-checked"])]),_:1},8,["value","options","placeholder"]),u(lt,{value:e(E),"onUpdate:value":[s[5]||(s[5]=d=>De(E)?E.value=d:null),s[6]||(s[6]=d=>e(l)())],"render-label":aa,placeholder:e(n)("tags"),options:e(r),"max-tag-count":"responsive",filterable:"",multiple:"","label-field":"name","value-field":"id",class:"!w-[200px]"},{action:m(()=>[u(kt,{size:"large",class:"w-full","default-checked":e(r)?.length&&e(E).length===e(r).length,"onUpdate:checked":s[4]||(s[4]=d=>{d?E.value=(e(r)||[]).map(Oe=>Oe.id).filter(Oe=>Oe):E.value=[],e(l)()})},{default:m(()=>[B(U(e(n)("selectAll")),1)]),_:1},8,["default-checked"])]),_:1},8,["value","placeholder","options"]),u(lt,{value:e(j),"onUpdate:value":[s[8]||(s[8]=d=>De(j)?j.value=d:null),s[9]||(s[9]=d=>e(l)())],"render-label":at,options:e(fe),placeholder:e(n)("categories"),"max-tag-count":"responsive",filterable:"",multiple:"","label-field":"name","value-field":"id",class:"!w-[250px]"},{action:m(()=>[u(kt,{size:"large",class:"w-full","default-checked":e(fe).length&&e(j).length===e(fe).length,"onUpdate:checked":s[7]||(s[7]=d=>{d?j.value=e(fe).map(Oe=>Oe.id).filter(Oe=>Oe):j.value=[],e(l)()})},{default:m(()=>[B(U(e(n)("selectAll")),1)]),_:1},8,["default-checked"])]),_:1},8,["value","options","placeholder"]),u(e(T),{type:"primary",secondary:"",onClick:s[10]||(s[10]=d=>zt(null))},{icon:m(()=>[u(e(x),null,{default:m(()=>[u(e(P),{icon:"carbon:add-alt"})]),_:1})]),default:m(()=>[B(" "+U(e(n)("addArticle")),1)]),_:1})]))]),_:1}),u(sa,{size:"small",class:"mb-5"},{default:m(()=>[rt("div",kn,[u(na,{value:e(v),"onUpdate:value":[s[11]||(s[11]=d=>De(v)?v.value=d:null),s[12]||(s[12]=d=>e(l)())],name:"filterstatusradiobuttongroup",size:"medium",disabled:!!e(Ce).length},{default:m(()=>[u(Dt,{value:0},{default:m(()=>[B(U(e(n)("all"))+"  ",1),e(he)?(Z(),ze("span",Cn," ("+U(e(he))+") ",1)):dt("",!0)]),_:1}),u(Dt,{value:10},{default:m(()=>[B(U(e(n)("myArticles"))+"  ",1),e(ut)?(Z(),ze("span",xn," ("+U(e(ut))+") ",1)):dt("",!0)]),_:1}),(Z(!0),ze(Qt,null,fa(e(o),d=>(Z(),ct(Dt,{key:d.value,value:d.value},{default:m(()=>[B(U(d.label)+"  ",1),d.value==e(J).DRAFT?(Z(),ze("span",$n," ("+U(e(et))+") ",1)):d.value==e(J).PUBLISHED?(Z(),ze("span",An," ("+U(e(Ee))+") ",1)):d.value==e(J).PENDING?(Z(),ze("span",Nn," ("+U(e(ht))+") ",1)):d.value==e(J).TRASH?(Z(),ze("span",In," ("+U(e(wt))+") ",1)):dt("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["value","disabled"])])]),_:1}),u(qa,null,{default:m(()=>[(Z(),ct(Ra,{key:e(la),columns:e(ge),data:e(be),loading:e(f),"single-line":!1,"scroll-x":1500,"row-key":Ta,"pagination-behavior-on-filter":"first",size:"small",striped:"","onUpdate:checkedRowKeys":Ma},null,8,["columns","data","loading","row-key"]))]),_:1}),u(Ba,{page:e(Ie),"onUpdate:page":[s[13]||(s[13]=d=>De(Ie)?Ie.value=d:null),_t],class:"mt-5 justify-end","show-size-picker":"","page-size":e(Q),"page-sizes":[6,12,24,36,48,60],"page-count":Math.ceil(e(Be)/e(Q)),"onUpdate:pageSize":vt},null,8,["page","page-size","page-count"]),u(Fa,{show:e(bt),"onUpdate:show":s[14]||(s[14]=d=>De(bt)?bt.value=d:null),title:e(n)("selectImage"),"upload-config":{folder:Mn,limit:0,maxSize:0,baseUrl:e(ae)?.apiUrl+"/media-files/upload",excludedExtensions:[]},onSubmit:Da},null,8,["show","title","upload-config"]),u(Oa,{show:e(se),"onUpdate:show":s[17]||(s[17]=d=>De(se)?se.value=d:null),preset:"card",style:{width:"500px"},bordered:!1,"mask-closable":!1,"close-on-esc":!1,title:e(n)("editStatus")},{default:m(()=>[u(La,{show:e(q)},{default:m(()=>[rt("div",Sn,[u(na,{value:e(oe),"onUpdate:value":[s[15]||(s[15]=d=>De(oe)?oe.value=d:null),s[16]||(s[16]=()=>{e(Ce).length?Va():we()})],name:"filterstatusradiobuttongroup",size:"large"},{default:m(()=>[(Z(!0),ze(Qt,null,fa(e(o),d=>(Z(),ct(Dt,{key:d.value,value:d.value,size:"large"},{default:m(()=>[B(U(d.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])]),_:1},8,["show"])]),_:1},8,["show","title"]),u(Qa,{modelValue:e(tt),"onUpdate:modelValue":s[33]||(s[33]=d=>De(tt)?tt.value=d:null),class:"w-full"},{header:m(()=>[rt("div",zn,[u(Ha,{depth:"1"},{default:m(()=>[B(U(e(Ve)?e(n)("editArticle"):e(n)("addArticle")),1)]),_:1})])]),"header-extra":m(()=>[u(Ka,{class:"mr-10",align:"center"},{default:m(()=>[u(e(T),{secondary:"",title:e(n)("save"),loading:e(f)||e(q),disabled:e(Ot),onClick:s[18]||(s[18]=d=>y())},{icon:m(()=>[u(e(x),null,{default:m(()=>[u(e(P),{icon:"carbon:save"})]),_:1})]),default:m(()=>[B(" "+U(e(n)("save")),1)]),_:1},8,["title","loading","disabled"])]),_:1})]),default:m(()=>[rt("section",Dn,[u(ja,{ref_key:"formRef",ref:It,model:e(g),rules:Lt,"show-require-mark":!1,size:"medium"},{default:m(()=>[u(Kt,{cols:"5","x-gap":14,"y-gap":12,"item-responsive":""},{default:m(()=>[u(oa,{span:"0:5 400:5 600:2 800:2"},{default:m(()=>[u(Le,{"show-label":!1,path:"title"},{default:m(()=>[u(Ut,{modelValue:e(g).title,"onUpdate:modelValue":s[19]||(s[19]=d=>e(g).title=d),placeholder:e(n)("title"),class:"w-full",sync:""},{label:m(()=>[B(U(e(n)("title")),1)]),_:1},8,["modelValue","placeholder"])]),_:1}),u(Le,{label:e(n)("slug"),path:"slug"},{default:m(()=>[u(e(Ze),{value:e(g).slug,"onUpdate:value":s[20]||(s[20]=d=>e(g).slug=d),placeholder:e(n)("slug"),"allow-input":za,class:"w-full"},null,8,["value","placeholder"])]),_:1},8,["label"]),u(Kt,{"x-gap":"12",span:24},{default:m(()=>[u(Tt,{span:12,label:e(n)("status"),path:"status"},{default:m(()=>[u(lt,{value:e(g).status,"onUpdate:value":s[21]||(s[21]=d=>e(g).status=d),placeholder:e(n)("status"),options:e(o),class:"w-full"},null,8,["value","placeholder","options"])]),_:1},8,["label"]),u(Tt,{span:12,label:e(n)("author"),path:"authorId"},{default:m(()=>[u(lt,{value:e(g).authorId,"onUpdate:value":s[22]||(s[22]=d=>e(g).authorId=d),placeholder:e(n)("author"),options:e(je),"label-field":"fullname","value-field":"id",class:"w-full"},null,8,["value","placeholder","options"])]),_:1},8,["label"])]),_:1}),hn(u(Le,{label:e(n)("publicationDate"),path:"publishedAt"},{default:m(()=>[u(Ya,{"formatted-value":e(g).publishedAt,"onUpdate:formattedValue":s[23]||(s[23]=d=>e(g).publishedAt=d),"value-format":"yyyy-MM-dd HH:mm:ss",format:"dd MMMM yyyy - HH:mm",type:"datetime",class:"w-full"},null,8,["formatted-value"])]),_:1},8,["label"]),[[gn,e(g).status===e(J).PUBLISHED]]),u(Le,{label:e(n)("featuredImage"),path:"featuredImage"},{default:m(()=>[u(sa,null,{default:m(()=>[rt("section",Un,[rt("div",{class:"cursor-pointer w-full h-[200px] flex items-center justify-center rounded-sm",style:wn(`
                      border: 1px dashed ${e(a)("green","white")};
                      background-image: url('${e(h)(e(g).featuredImageUrl||e(g).featuredImage||"")}');
                      background-position: center;
                      background-size: cover
                    `),onClick:s[24]||(s[24]=d=>bt.value=!0)},[e(g).featuredImage?dt("",!0):(Z(),ct(e(x),{key:0,size:64},{default:m(()=>[u(e(P),{icon:"carbon:image",class:"text-gray-400"})]),_:1}))],4),e(g).featuredImage?(Z(),ct(e(T),{key:0,class:"!mt-5",quaternary:"",onClick:s[25]||(s[25]=d=>Ua())},{icon:m(()=>[u(e(x),null,{default:m(()=>[u(e(P),{icon:"carbon:trash-can"})]),_:1})]),default:m(()=>[B(" "+U(e(n)("clear")),1)]),_:1})):dt("",!0)])]),_:1})]),_:1},8,["label"]),u(Le,{"show-label":!1,path:"legend"},{default:m(()=>[u(Ut,{modelValue:e(g).legend,"onUpdate:modelValue":s[26]||(s[26]=d=>e(g).legend=d),placeholder:e(n)("legend"),class:"w-full",sync:""},{label:m(()=>[B(U(e(n)("legend")),1)]),_:1},8,["modelValue","placeholder"])]),_:1})]),_:1}),u(oa,{span:"0:5 400:5 600:3 800:3"},{default:m(()=>[u(Le,{"show-label":!1,path:"summary"},{default:m(()=>[u(Ut,{modelValue:e(g).summary,"onUpdate:modelValue":s[27]||(s[27]=d=>e(g).summary=d),placeholder:e(n)("summary"),type:"textarea",class:"w-full",autosize:{minRows:3,maxRows:4},sync:""},{label:m(()=>[B(U(e(n)("summary")),1)]),_:1},8,["modelValue","placeholder"])]),_:1}),u(Le,{"show-label":!1,path:"content"},{default:m(()=>[u(Ut,{modelValue:e(g).content,"onUpdate:modelValue":s[28]||(s[28]=d=>e(g).content=d),"should-not-group-editor-when-full":"",placeholder:e(n)("content"),type:"editor",class:"w-full",sync:""},{label:m(()=>[B(U(e(n)("content")),1)]),_:1},8,["modelValue","placeholder"])]),_:1}),u(Le,{label:e(n)("categories"),path:"categories"},{default:m(()=>[u(lt,{value:e(ke),"onUpdate:value":s[29]||(s[29]=d=>De(ke)?ke.value=d:null),"render-label":at,placeholder:e(n)("categories"),options:e(fe),"max-tag-count":"responsive",filterable:"",multiple:"","label-field":"name","value-field":"id",class:"w-full"},null,8,["value","placeholder","options"])]),_:1},8,["label"]),u(Le,{label:e(n)("tags"),path:"tags"},{default:m(()=>[u(lt,{value:e(Se),"onUpdate:value":s[30]||(s[30]=d=>De(Se)?Se.value=d:null),"render-label":aa,placeholder:e(n)("tags"),options:e(r),"max-tag-count":"responsive",filterable:"",multiple:"",tag:"","label-field":"name","value-field":"id",class:"w-full"},null,8,["value","placeholder","options"])]),_:1},8,["label"]),u(Kt,{"x-gap":"12",span:24},{default:m(()=>[u(Tt,{"show-label":!1,span:12,path:"allowComments"},{default:m(()=>[u(kt,{checked:e(g).allowComments,"onUpdate:checked":s[31]||(s[31]=d=>e(g).allowComments=d)},{default:m(()=>[B(U(e(n)("allowComments")),1)]),_:1},8,["checked"])]),_:1}),u(Tt,{"show-label":!1,span:12,path:"isHeadline"},{default:m(()=>[u(kt,{checked:e(g).isHeadline,"onUpdate:checked":s[32]||(s[32]=d=>e(g).isHeadline=d)},{default:m(()=>[B(U(e(n)("headline")),1)]),_:1},8,["checked"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])])]),_:1},8,["modelValue"])],64)}}}),Vn=Ia(En,[["__scopeId","data-v-e7fb886f"]]),Pn=N=>{const{displayFormErrors:k}=Te(),{request:C}=qe(),{t:_}=ie(),a=Ae(),h=Me();return Ye({queryKey:["news-tags"],operation:"insert",getItemId:o=>o.id??`temp-${crypto.randomUUID()}`,mutationFn:async o=>{h.start();const r=await C({method:"post",url:"/news-tags",data:ft(o,["id"])});if(h.finish(),r.failure&&r.error)throw new Error(r.error);return r.result.data},mutationOptions:{onSuccess:()=>{a.success(_("success"))},onError:o=>{o?.response?.data?.errorCode===pt.FORM_INVALID_DATA?k(o?.response?.data?.data):a.error(_("anErrorOccurred"))},...N}})},Rn=N=>{const{displayFormErrors:k}=Te(),{request:C}=qe(),{t:_}=ie(),a=Ae(),h=Me();return Ye({queryKey:["news-tags"],operation:"update",getItemId:o=>o.id??`temp-${crypto.randomUUID()}`,mutationFn:async o=>{h.start();const r=await C({method:"put",url:`/news-tags/${o.id}`,data:ft(o,["id"])});if(h.finish(),r.failure&&r.error)throw new Error(r.error);return r.result.data},mutationOptions:{onSuccess:()=>{a.success(_("success"))},onError:o=>{o?.response?.data?.errorCode===pt.FORM_INVALID_DATA?k(o?.response?.data?.data):a.error(_("anErrorOccurred"))},...N}})},qn=N=>{const{request:k}=qe(),{t:C}=ie(),_=Ae(),a=Me();return Ye({queryKey:["news-tags"],operation:"remove",getItemId:h=>h.id??`temp-${crypto.randomUUID()}`,mutationFn:async({id:h})=>{a.start();const o=await k({method:"delete",url:`/news-tags/${h}`});if(a.finish(),!o.success)throw new Error(o.error);return o.result.data},mutationOptions:{onSuccess:()=>{_.success(C("success"))},onError:h=>{_.error(C("anErrorOccurred"))},...N}})},{defineComponent:Bn}=await ee("vue"),{unref:S,createVNode:de,withCtx:me,toDisplayString:$t,createTextVNode:At,resolveComponent:Us,isRef:Fn,Fragment:Ln,openBlock:On,createElementBlock:Hn}=await ee("vue"),{ref:mt,h:W,computed:Kn}=await ee("vue"),Yn=Bn({__name:"index",setup(N){const k=Ae(),C=Rt(),{tr:_}=Te(),{t:a,locale:h}=ie(),{data:o,isPending:r}=rl(),{mutate:fe,isPending:n}=qn(),{mutate:te,isPending:V}=Rn(),{mutate:ae,isPending:_e}=Pn(),ve=mt(""),ue=mt(),Ne={pageSize:12,prefix:({itemCount:v})=>W("div",{class:"font-bold"},{default:()=>`${a("total")}: ${v}`})},F=[{title:a("name"),key:"name",resizable:!0,width:150,ellipsis:{tooltip:!0},fixed:"left",sortOrder:!1,sorter:"default",render(v){return W("div",{},{default:()=>_(v.name)})}},{title:a("description"),key:"description",resizable:!0,width:200,ellipsis:{tooltip:!0},render(v){return W("small",{},{default:()=>_(v.description)})}},{title:a("status"),key:"isActive",width:100,render(v){return W(Ke,{type:v.isActive?"success":"error",bordered:!1},{default:()=>v.isActive?a("visible"):a("hidden")})},sortOrder:!1,sorter:"default"},{title:a("article_s"),key:"articlesCount",width:90,render(v){return W(Ke,{type:"info",bordered:!1},{default:()=>v.articlesCount})},sortOrder:!1,sorter:"default"},{title:a("updateAt"),key:"updatedAt",width:125,render(v){return W("div",{},{default:()=>it(v.updatedAt,{locale:h.value,outPattern:"DD MMMM YYYY"})})}},{title:a("createdAt"),key:"createdAt",width:125,render(v){return W("div",{},{default:()=>it(v.createdAt,{locale:h.value,outPattern:"DD MMMM YYYY"})})}},{title:()=>W(Ze,{ref:ue,placeholder:a("search"),value:ve.value,onInput:v=>{ve.value=v}},{suffix:()=>W(x,{},{default:()=>W(P,{icon:"carbon:search"})})}),key:"actions",width:150,render(v){return W("div",{class:"flex justify-end items-center w-full"},[W(T,{size:"small",type:"warning",secondary:!0,onClick:()=>{E(v)},renderIcon:()=>W(x,null,{default:()=>W(P,{icon:"carbon:edit"})})}),W("div",{class:"w-2"}),W(T,{size:"small",type:"error",secondary:!0,onClick:()=>{C.warning({title:a("confirm"),content:a("confirmDeleteNewsTag"),positiveText:a("yes"),negativeText:a("no"),onPositiveClick:async()=>{v.id&&fe({id:v.id})}})},renderIcon:()=>W(x,null,{default:()=>W(P,{icon:"carbon:trash-can"})})})])},fixed:"right"}],Y=Kn(()=>{if(!ve.value)return o.value;const v=o.value?.filter(A=>A.name.toLowerCase().includes(ve.value.toLowerCase())||A.description?.toLowerCase().includes(ve.value.toLowerCase()));return ue.value&&ue.value.focus(),v}),R=mt(!1),le=mt(null),L=mt(null),D=mt({name:"",description:"",isActive:!0}),j={name:[{required:!0,message:a("fillRequired")}],description:[{required:!0,message:a("fillRequired")}]},E=v=>{le.value=pe.cloneDeep(v),v?D.value=pe.cloneDeep(v):D.value={name:"",description:"",isActive:!0},R.value=!0},X=async()=>(L.value?.validate(async v=>{if(!v){const A={name:D.value.name,description:D.value.description,isActive:D.value.isActive};le.value?le.value.name!==D.value.name&&(o.value||[]).findIndex(ne=>ne.name==D.value.name)>-1?k.error(a("sameTagNameMessage")):te({id:le.value.id,...A}):(o.value||[]).findIndex(ne=>ne.name==D.value.name)>-1?k.error(a("sameTagNameMessage")):ae(A),R.value=!1}}),!1);return(v,A)=>{const ne=Pt,I=ea,be=ta,se=Wt,b=Ft,oe=Zt,ge=Bt,Be=qt;return On(),Hn(Ln,null,[de(ne,{to:"#add-tag-action"},{default:me(()=>[de(S(T),{type:"primary",secondary:"",onClick:A[0]||(A[0]=Q=>E(null))},{icon:me(()=>[de(S(x),{size:"18"},{default:me(()=>[de(S(P),{icon:"carbon:add-alt"})]),_:1})]),default:me(()=>[At(" "+$t(S(a)("addTag")),1)]),_:1})]),_:1}),de(be,null,{default:me(()=>[de(I,{columns:F,data:S(Y),pagination:Ne,loading:S(r),"single-line":!1,"scroll-x":1e3,size:"small",striped:""},null,8,["data","loading"])]),_:1}),de(Be,{show:S(R),"onUpdate:show":A[4]||(A[4]=Q=>Fn(R)?R.value=Q:null),loading:S(_e)||S(V)||S(n),preset:"dialog",style:{width:"450px"},bordered:!1,"show-icon":!1,"mask-closable":!1,title:S(le)?S(a)("editTag"):S(a)("addTag"),"positive-text":S(a)("validate"),"negative-text":S(a)("cancel"),onPositiveClick:X,onNegativeClick:A[5]||(A[5]=Q=>R.value=!1)},{default:me(()=>[de(ge,{ref_key:"formRef",ref:L,class:"mt-5",model:S(D),rules:j,"show-require-mark":!1,size:"medium"},{default:me(()=>[de(b,{"show-label":!1,path:"name"},{default:me(()=>[de(se,{modelValue:S(D).name,"onUpdate:modelValue":A[1]||(A[1]=Q=>S(D).name=Q),placeholder:S(a)("name"),class:"w-full",sync:""},{label:me(()=>[At($t(S(a)("name")),1)]),_:1},8,["modelValue","placeholder"])]),_:1}),de(b,{"show-label":!1,path:"description"},{default:me(()=>[de(se,{modelValue:S(D).description,"onUpdate:modelValue":A[2]||(A[2]=Q=>S(D).description=Q),placeholder:S(a)("description"),type:"textarea",class:"w-full",rows:3,sync:""},{label:me(()=>[At($t(S(a)("description")),1)]),_:1},8,["modelValue","placeholder"])]),_:1}),de(b,{label:S(a)("status"),path:"isActive"},{default:me(()=>[de(oe,{value:S(D).isActive,"onUpdate:value":A[3]||(A[3]=Q=>S(D).isActive=Q),size:"small"},{checked:me(()=>[At($t(S(a)("visible")),1)]),unchecked:me(()=>[At($t(S(a)("hidden")),1)]),_:1},8,["value"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["show","loading","title","positive-text","negative-text"])],64)}}}),{defineComponent:jn}=await ee("vue"),{unref:re,vShow:We,createElementVNode:He,withDirectives:Je,resolveComponent:Ts,withCtx:Xe,createVNode:Ue,TransitionGroup:Qn,normalizeStyle:Gn,openBlock:Wn,createBlock:Jn}=await ee("vue"),Xn={id:"header-btn"},Zn={id:"add-article-action"},es={id:"add-comment-action"},ts={id:"add-category-action"},as={id:"add-tag-action"},ls={key:"articles"},ns={key:"comments"},ss={key:"categories"},os={key:"tags"},{defineComponent:rs,ref:va,h:Gt,computed:ga,watch:is,onMounted:us}=await ee("vue"),{defineStore:cs}=await ee("pinia"),ds=rs({name:il.NEWS_MANAGEMENT.NAME}),ms=jn({...ds,setup(N){const k=["articles","categories","comments","tags"],C=F=>k.includes(F),{t:_}=ie(),a=El(),{is2XlScreen:h,isXlScreen:o,isLgScreen:r,isMdScreen:fe,isSmScreen:n}=Te(),te=ha(),V=cs("news-management",()=>({currentMenuItemKey:va("articles")}))(),ae=(F,Y)=>()=>Gt(x,{},{default:()=>Gt(P,{icon:F})}),_e=(F,Y)=>()=>Gt("span",{id:pe.camelCase(Y)},{default:()=>F}),ve=ga(()=>[{label:_e(_("articles"),"articles"),key:"articles",icon:ae("carbon:document")},{label:_e(_("comments"),"comments"),key:"comments",icon:ae("carbon:chat")},{label:_e(_("categories"),"categories"),key:"categories",icon:ae("carbon:categories")},{label:_e(_("tags"),"tags"),key:"tags",icon:ae("carbon:tag")}]),ue=ga(()=>te.contentLayoutSize.height-200),Ne=va();return is(()=>[fe.value,n.value,r.value,o.value],([F,Y,R,le])=>{Ne.value=F||Y||R||le,setTimeout(()=>{Ne.value=void 0},500)}),us(()=>{setTimeout(()=>{a.params.key&&C(a.params.key)&&(V.currentMenuItemKey=a.params.key)},500)}),(F,Y)=>{const R=Jt,le=$l,L=xl,D=Cl,j=Ga;return Wn(),Jn(j,null,{"header-extra":Xe(()=>[Ue(R,null,{default:Xe(()=>[He("div",Xn,[Je(He("div",Zn,null,512),[[We,re(V).currentMenuItemKey==="articles"]]),Je(He("div",es,null,512),[[We,re(V).currentMenuItemKey==="comments"]]),Je(He("div",ts,null,512),[[We,re(V).currentMenuItemKey==="categories"]]),Je(He("div",as,null,512),[[We,re(V).currentMenuItemKey==="tags"]])])]),_:1})]),default:Xe(()=>[Ue(D,{style:Gn(`height: ${re(ue)}px`)},{default:Xe(()=>[Ue(D,{position:"absolute",style:{top:"0",bottom:"0"},"has-sider":""},{default:Xe(()=>[Ue(L,{bordered:"","show-trigger":"","collapse-mode":"width","content-style":"padding: 4px",collapsed:re(Ne),"default-collapsed":!re(h),"collapsed-width":64,"native-scrollbar":!1,width:re(h)?300:275},{default:Xe(()=>[Ue(le,{value:re(V).currentMenuItemKey,"onUpdate:value":Y[0]||(Y[0]=E=>re(V).currentMenuItemKey=E),"collapsed-width":64,"collapsed-icon-size":22,options:re(ve)},null,8,["value","options"])]),_:1},8,["collapsed","default-collapsed","width"]),Ue(D,{"content-style":"padding: 10px 24px","native-scrollbar":!1},{default:Xe(()=>[Ue(Qn,{name:"slide-fade"},{default:Xe(()=>[Je(He("section",ls,[Ue(Vn)],512),[[We,re(V).currentMenuItemKey==="articles"]]),Je(He("section",ns,[Ue(fn)],512),[[We,re(V).currentMenuItemKey==="comments"]]),Je(He("section",ss,[Ue(ln)],512),[[We,re(V).currentMenuItemKey==="categories"]]),Je(He("section",os,[Ue(Yn)],512),[[We,re(V).currentMenuItemKey==="tags"]])]),_:1})]),_:1})]),_:1})]),_:1},8,["style"])]),_:1})}}}),Ms=Ia(ms,[["__scopeId","data-v-72fc85b4"]]);export{Ms as default};
