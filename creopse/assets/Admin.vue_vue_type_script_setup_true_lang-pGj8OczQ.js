import{i as p}from"./css-render_vue3-ssr-Vbotx5Ir.js";import{I as F}from"./iconify_vue-BwapRRpV.js";import{u as V,a as U,c as B,_ as L,e as M,P as q,R as v}from"./index-B2LlKIv2.js";import{R as i}from"./response-error-code-DXeaxdrh.js";import{u as z}from"./vue-router-B7M2c80d.js";import{c as G,b as Y,A as W,I as X,D as $,B as j,N as J}from"./naive-ui-CrTIpLJ9.js";import{u as K}from"./vue-i18n-CWrb4u3f.js";const{defineComponent:Q}=await p("vue"),{unref:o,toDisplayString:u,createTextVNode:_,resolveComponent:ue,withCtx:s,createVNode:a,createElementVNode:d,openBlock:Z,createBlock:ee}=await p("vue"),oe={class:"w-full flex"},{ref:m}=await p("vue"),_e=Q({__name:"Admin",props:{mode:{default:"creation"}},emits:["back"],setup(I,{emit:w}){const n=I,C=w,{t:e}=K(),{request:f}=M(),{displayFormErrors:h}=V(),{userHasSuperAdminRole:R}=U(),c=B(),A=z(),S=G(),r=Y(),l=m(!1),g=m(null),y=m({}),E={},x=()=>{g.value?.validate(async k=>{if(!k){l.value=!0;const t=await f({url:"/auth/profile",method:"post",data:{type:q.ADMIN,id:c.userData?.id,profileData:{}}});if(t.failure&&t.error)switch(t.error?.response?.data?.errorCode){case i.AUTH_PROFILE_ALREADY_EXISTS:r.error(e("profileAlreadyExists"));break;case i.AUTH_MISSING_DATA:r.error(e("missingData"));break;case i.FORM_INVALID_DATA:h(t.error?.response?.data?.data);break;case i.AUTH_USER_NOT_FOUND:r.error(e("userNotFound"));break;case i.AUTH_PROFILE_TYPE_NOT_FOUND:r.error(e("profileTypeNotFound"));break;default:r.error(e("registerProfileNotSuccessful"))}else R()?(c.userData=t.result.data,A.replace(v.HOME.PATH)):(await f({url:"/auth/logout"}),S.success({title:e("success"),content:e("accountCreatedWithSuccess1"),positiveText:e("ok")}),c.resetAuthData(),A.replace(v.LOGIN.PATH));l.value=!1}})};return n.mode=="edition",(k,t)=>{const H=X,O=$,N=L,T=F,D=J,b=j,P=W;return Z(),ee(P,{size:"medium",class:"w-full"},{default:s(()=>[a(N,{name:"slide-fade",appear:""},{default:s(()=>[d("section",null,[a(H,{title:n.mode=="edition"?o(e)("update"):o(e)("validation"),type:"success",class:"mb-10"},{default:s(()=>[_(u(n.mode=="edition"?o(e)("updateCompleted"):o(e)("registrationCompleted")),1)]),_:1},8,["title"]),a(O,{ref_key:"formRef",ref:g,model:o(y),rules:E,"show-label":!1,"show-require-mark":!1,size:"medium"},null,8,["model"])])]),_:1}),a(N,{name:"slide-fade",appear:""},{default:s(()=>[d("section",oe,[a(b,{class:"flex-1",loading:o(l),onClick:t[0]||(t[0]=te=>C("back"))},{icon:s(()=>[a(D,null,{default:s(()=>[a(T,{icon:"carbon:arrow-left"})]),_:1})]),default:s(()=>[_(" "+u(n.mode=="edition"?o(e)("close"):o(e)("back")),1)]),_:1},8,["loading"]),t[1]||(t[1]=d("div",{class:"w-2"},null,-1)),a(b,{class:"flex-1",type:"primary","icon-placement":"right",loading:o(l),onClick:x},{icon:s(()=>[a(D,null,{default:s(()=>[a(T,{icon:"carbon:checkmark-outline"})]),_:1})]),default:s(()=>[_(" "+u(n.mode=="edition"?o(e)("save"):o(e)("validate")),1)]),_:1},8,["loading"])])]),_:1})]),_:1})}}});export{_e as _};
