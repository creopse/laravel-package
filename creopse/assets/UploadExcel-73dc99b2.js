import{r as I,u}from"./xlsx-83e6f69b.js";import{_ as O}from"./fawmi_vue-google-maps-439c501d.js";import{u as P}from"./vue-i18n-0da1582b.js";import{r as f,u as d}from"./vue_reactivity-852d8377.js";import{o as R,c as T,a as h,l as y,Y as V,aO as j}from"./vue_runtime-core-273b5003.js";import{t as D}from"./vue_shared-7dcc3b7f.js";import{_ as A}from"./naive-ui-ab0dda7d.js";const H={__name:"UploadExcel",props:{beforeUpload:{type:Function,default:null},onSuccess:{type:Function,default:null}},setup(U){const l=U,{t:s}=P(),c=f(!1),p=f(null),_=f({header:null,results:null});function k({header:e,results:t}){_.value={header:e,results:t},l.onSuccess&&l.onSuccess(_.value)}function N(e){if(e.stopPropagation(),e.preventDefault(),c.value)return;const t=e.dataTransfer.files;if(t.length!==1){console.log(s("supportUploadingOneFile"));return}const o=t[0];if(!E(o))return console.log(s("formatNotSupported")),!1;g(o),e.stopPropagation(),e.preventDefault()}function m(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"}function S(){p.value.click()}function b(e){const o=e.target.files[0];o&&g(o)}function g(e){if(p.value=null,!l.beforeUpload){x(e);return}l.beforeUpload(e)&&x(e)}function x(e){return c.value=!0,new Promise((t,o)=>{const n=new FileReader;n.onload=i=>{const r=i.target.result,a=I(r,{type:"array"}),C=a.SheetNames[0],v=a.Sheets[C],F=w(v),B=u.sheet_to_json(v);k({header:F,results:B}),c.value=!1,t()},n.readAsArrayBuffer(e)})}function w(e){const t=[],o=u.decode_range(e["!ref"]);let n;const i=o.s.r;for(n=o.s.c;n<=o.e.c;++n){const r=e[u.encode_cell({c:n,r:i})];let a="UNKNOWN "+n;r&&r.t&&(a=u.format_cell(r)),t.push(a)}return t}function E(e){return/\.(xlsx|xls|csv)$/.test(e.name)}return(e,t)=>{const o=A;return R(),T("div",null,[h("input",{ref_key:"excelUploadInput",ref:p,class:"excel-upload-input",type:"file",accept:".xlsx, .xls",onChange:b},null,544),h("div",{class:"drop",onDrop:N,onDragover:m,onDragenter:m},[y(D(d(s)("dropExcelFileHereOr"))+" ",1),V(o,{loading:d(c),style:{"margin-left":"16px"},size:"small",type:"primary",onClick:S},{default:j(()=>[y(D(d(s)("browse")),1)]),_:1},8,["loading"])],32)])}}},J=O(H,[["__scopeId","data-v-c15025e0"]]);export{J as _};
