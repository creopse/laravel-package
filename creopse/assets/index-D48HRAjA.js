import{i as _e}from"./css-render_vue3-ssr-Vbotx5Ir.js";import{_ as Ma}from"./PageLayout.vue_vue_type_script_setup_true_lang-OixN3STA.js";import{u as gt,j as St,f as da,_ as Ta,e as Dt,r as tt,c as Va,k as aa,R as Ra}from"./index-B2LlKIv2.js";import{_ as jt}from"./I18nInput-D7U2qJkw.js";import{_ as Mt,a as pa,b as Na}from"./index.vue_vue_type_script_setup_true_lang-BG9tDE2Y.js";import{I as O}from"./iconify_vue-BwapRRpV.js";import{R as at}from"./response-error-code-DXeaxdrh.js";import{R as Ua}from"./vue-pick-colors-FPim5JW0.js";import{a as Kt,d as Ea}from"./pinia-DbZVydD4.js";import{_ as xe}from"./lodash-DjP7BPMr.js";import{a as Tt,b as Vt,c as Rt,g as Gt,F as Ge,N as z,B as q,A as Wt,Z as qa,$ as Pa,V as La,a0 as Fe,a1 as Xt,a2 as Ba,a3 as Nt,D as Ut,E as Et,G as ma,H as fa,a4 as Fa,_ as Ha,k as Zt,X as va,a5 as Oa,a6 as _a,a7 as Jt,j as ga,M as Ya,a8 as Ka,a9 as ja,O as Ga,R as Wa,aa as Xa,P as Za,n as Ja,m as Qa,h as el}from"./naive-ui-CrTIpLJ9.js";import{u as it}from"./vue-i18n-CWrb4u3f.js";import{_ as Qt}from"./NaiveMobileTableAdapter.vue_vue_type_script_setup_true_lang-DRZao2ZZ.js";import{_ as tl}from"./validator-QVVspsrX.js";import{s as al}from"./slugify-B8X89fKF.js";import{v as la}from"./uuid-8I8R7izr.js";import{_ as ha}from"./fawmi_vue-google-maps-DHKJ2mA8.js";import{a as ll}from"./vue-router-B7M2c80d.js";const{defineComponent:sl}=await _e("vue"),{unref:t,resolveComponent:nl,createVNode:s,withCtx:c,isRef:It,toDisplayString:J,createTextVNode:Me,openBlock:le,createBlock:Ue,createCommentVNode:Ze,renderList:sa,Fragment:Je,createElementBlock:Oe,normalizeClass:Qe,withModifiers:ft,createElementVNode:Ae,normalizeStyle:ol}=await _e("vue"),rl={class:"flex items-center"},il={class:"flex flex-col"},ul={class:"text-sm font-bold"},cl={class:"text-xs font-normal"},dl={class:"text-xs my-1"},pl={class:"flex items-center"},ml={class:"flex flex-col"},fl={class:"text-sm font-bold"},vl={class:"text-xs font-normal"},_l={key:0,class:"mt-4"},gl={class:"flex items-center"},{inject:hl,ref:ze,computed:wl}=await _e("vue"),yl="categories",bl=sl({__name:"index",setup(X){const k=Tt(),$=Vt(),ce=Rt(),{tr:K,fileUrl:Y,pickByTheme:Z,displayFormErrors:_}=gt(),{request:f}=Dt(),{t:i}=it(),{categories:M}=Kt(St()),{loadCategories:ne}=St(),{isLightTheme:N}=Kt(da()),ge=hl("appConfig"),a=ze([]),de=ze(!1),A=ze(""),E=ze(),I=wl(()=>{if(!A.value)return a.value;const x=a.value.filter(u=>u.name.toLowerCase().includes(A.value.toLowerCase())||u.description?.toLowerCase().includes(A.value.toLowerCase())||u.children?.some(S=>S.name.toLowerCase().includes(A.value.toLowerCase())||S.description?.toLowerCase().includes(A.value.toLowerCase())));return E.value&&E.value.focus(),x}),T=async()=>{k.start(),de.value=!0,await ne(),a.value=M.value.filter(x=>!x.parentId);for(let x=0;x<a.value.length;x++)a.value[x].children=M.value.filter(u=>u.parentId===a.value[x].id);de.value=!1,k.finish()};T();const R=ze(12),b=ze(1),L=x=>{R.value=x},F=ze(null),he=ze(!1),o=ze(!1),C=ze(null),j=ze(null),h=ze({name:"",description:"",isActive:!0,position:0,image:"",color:""}),Ce={name:[{required:!0,message:i("fillRequired")}]},pe=(x,u=null)=>{C.value=xe.cloneDeep(x),x?h.value=xe.cloneDeep(x):h.value={name:"",description:"",isActive:!0,position:0,image:"",color:""},F.value=u,o.value=!0},ae=async x=>{ce.warning({title:i("confirm"),content:x.parentId?i("confirmDeleteSubCategory"):i("confirmDeleteCategory"),positiveText:i("yes"),negativeText:i("no"),onPositiveClick:async()=>{(await f({method:"delete",url:`/news-categories/${x.id}`})).success?($.success(i("success")),T()):$.error(i("anErrorOccurred"))}})},Ve=async()=>(j.value?.validate(async x=>{if(!x)if(C.value)if(C.value.name!==h.value.name&&M.value.findIndex(u=>u.name==h.value.name)>-1)$.error(i("sameCategoryNameMessage"));else{k.start(),he.value=!0;const u={name:h.value.name,description:h.value.description,isActive:h.value.isActive,position:h.value.position,image:h.value.image,color:h.value.color,parentId:F.value},S=await f({method:"put",url:`/news-categories/${C.value.id}`,data:u});S.success&&S.result.data&&($.success(i("success")),T()),he.value=!1,k.finish(),o.value=!1}else if(M.value.findIndex(u=>u.name==h.value.name)>-1)$.error(i("sameCategoryNameMessage"));else{k.start(),he.value=!0;const u={name:h.value.name,description:h.value.description,isActive:h.value.isActive,position:h.value.position,image:h.value.image,color:h.value.color,parentId:F.value},S=await f({method:"post",url:"/news-categories",data:u});if(S.failure&&S.error)switch(S.error?.response?.data?.errorCode){case at.FORM_INVALID_DATA:_(S.error?.response?.data?.data);break;default:$.error(i("anErrorOccurred"))}else $.success(i("success")),T();he.value=!1,k.finish(),o.value=!1}}),!1),me=async(x,u)=>{(await f({method:"put",url:"/news-categories/position",data:{items:u}})).success&&T()},g=ze(!1),v=async x=>{h.value.image=x,g.value=!1},oe=()=>{h.value.image=""};return(x,u)=>{const S=O,Ie=Gt,H=Mt,B=La,Se=Wt,fe=nl("Draggable"),G=Pa,De=qa,ht=Xt,We=Ba,wt=Ta,m=pa,ut=jt,yt=Et,qt=Fa,Xe=fa,bt=ma,Pt=Ha,kt=Zt,$t=Ut,Lt=Nt;return le(),Oe(Je,null,[s(H,{to:"#add-category-action"},{default:c(()=>[s(Ie,{align:"center"},{default:c(()=>[s(t(Ge),{ref_key:"searchInputRef",ref:E,value:t(A),"onUpdate:value":u[0]||(u[0]=w=>It(A)?A.value=w:null),clearable:!0,placeholder:t(i)("search")},{suffix:c(()=>[s(t(z),null,{default:c(()=>[s(S,{icon:"carbon:search"})]),_:1})]),_:1},8,["value","placeholder"]),t(I).length?(le(),Ue(t(q),{key:0,type:"primary",onClick:u[1]||(u[1]=w=>pe(null))},{icon:c(()=>[s(t(z),{size:"18"},{default:c(()=>[s(S,{icon:"carbon:add-alt"})]),_:1})]),default:c(()=>[Me(" "+J(t(i)("addCategory")),1)]),_:1})):Ze("",!0)]),_:1})]),_:1}),s(wt,{appear:"",name:"slide-fade"},{default:c(()=>[Ae("section",null,[t(I)&&t(I).length?(le(),Oe(Je,{key:0},[s(fe,{list:t(a),onChange:u[2]||(u[2]=w=>me(w,t(a)))},{default:c(()=>[(le(!0),Oe(Je,null,sa(t(I).slice((t(b)-1)*t(R),t(b)*t(R)),w=>(le(),Ue(Se,{key:w.id,embedded:"",size:"small",class:"mb-1"},{default:c(()=>[s(De,{"default-expanded-names":w.children?.length?["1"]:[],"display-directive":"show"},{"header-extra":c(({collapsed:re})=>[s(Ie,{align:"center"},{default:c(()=>[s(t(Fe),{size:"small",bordered:!1,type:w.isActive?"success":"error"},{default:c(()=>[Me(J(w.isActive?t(i)("visible"):t(i)("hidden")),1)]),_:2},1032,["type"]),s(B,{vertical:"",class:Qe(["!mx-0",t(Z)("!bg-zinc-400","!bg-slate-500")])},null,8,["class"]),s(t(q),{size:"small",type:"primary",secondary:t(N),onClick:ft(lt=>pe(w),["stop"])},{default:c(()=>[s(t(z),null,{default:c(()=>[s(S,{icon:"carbon:edit"})]),_:1})]),_:2},1032,["secondary","onClick"]),s(t(q),{size:"small",type:"error",secondary:t(N),onClick:ft(lt=>ae(w),["stop"])},{default:c(()=>[s(t(z),null,{default:c(()=>[s(S,{icon:"carbon:trash-can"})]),_:1})]),_:2},1032,["secondary","onClick"]),s(t(q),{size:"small",type:"info",secondary:t(N),onClick:ft(lt=>pe(null,w.id),["stop"])},{icon:c(()=>[s(t(z),null,{default:c(()=>[s(S,{icon:"carbon:category"})]),_:1})]),default:c(()=>[Me(" "+J(t(i)("subCategory"))+" ",1),s(t(Fe),{size:"small",bordered:!1,type:"primary",class:"ml-1"},{default:c(()=>[Me(J(w.children?.length),1)]),_:2},1024)]),_:2},1032,["secondary","onClick"])]),_:2},1024),u[16]||(u[16]=Ae("div",{class:"w-6"},null,-1)),s(t(z),null,{default:c(()=>[re?(le(),Ue(S,{key:0,icon:"fa-solid:chevron-left"})):(le(),Ue(S,{key:1,icon:"fa-solid:chevron-down"}))]),_:2},1024)]),arrow:c(()=>u[17]||(u[17]=[Ae("span",null,null,-1)])),default:c(()=>[s(G,{name:"1"},{header:c(()=>[Ae("div",rl,[s(t(z),{size:"21",class:"cursor-move mr-4"},{default:c(()=>[s(S,{icon:"fa-solid:grip-lines"})]),_:1}),s(B,{vertical:"",class:Qe(t(Z)("!bg-zinc-400","!bg-slate-500"))},null,8,["class"]),Ae("div",il,[Ae("span",ul,J(t(K)(w.name))+" ("+J(w.articlesCount)+" "+J(t(i)("article_s"))+") ",1),Ae("small",cl,J(w.slug),1)])])]),default:c(()=>[w.description?(le(),Oe(Je,{key:0},[s(B,{class:Qe([t(Z)("!bg-zinc-300","!bg-slate-500"),"!my-0 !h-0.5"])},null,8,["class"]),Ae("div",dl,J(t(K)(w.description)),1)],64)):Ze("",!0),w.children?.length?(le(),Oe(Je,{key:1},[s(B,{class:Qe([t(Z)("!bg-zinc-300","!bg-slate-500"),"!mt-0 !mb-2 !h-0.5"])},null,8,["class"]),s(fe,{list:w.children,onChange:re=>me(re,w.children||[])},{default:c(()=>[(le(!0),Oe(Je,null,sa(w.children,re=>(le(),Ue(Se,{key:re.id,size:"small",class:"mb-1"},{header:c(()=>[Ae("div",pl,[s(t(z),{size:"21",class:"cursor-move mr-4"},{default:c(()=>[s(S,{icon:"fa-solid:grip-lines"})]),_:1}),s(B,{vertical:"",class:Qe(t(Z)("!bg-zinc-400","!bg-slate-500"))},null,8,["class"]),Ae("div",ml,[Ae("span",fl,J(t(K)(re.name)),1),Ae("small",vl,J(re.slug),1)])])]),"header-extra":c(()=>[s(Ie,{align:"center"},{default:c(()=>[s(t(Fe),{size:"small",bordered:!1,type:re.isActive?"success":"error"},{default:c(()=>[Me(J(re.isActive?t(i)("visible"):t(i)("hidden")),1)]),_:2},1032,["type"]),s(B,{vertical:"",class:Qe(["!mx-0",t(Z)("!bg-zinc-400","!bg-slate-500")])},null,8,["class"]),s(t(q),{size:"small",type:"primary",secondary:t(N),onClick:ft(lt=>pe(re,w.id),["stop"])},{default:c(()=>[s(t(z),null,{default:c(()=>[s(S,{icon:"carbon:edit"})]),_:1})]),_:2},1032,["secondary","onClick"]),s(t(q),{size:"small",type:"error",secondary:t(N),onClick:ft(lt=>ae(re),["stop"])},{default:c(()=>[s(t(z),null,{default:c(()=>[s(S,{icon:"carbon:trash-can"})]),_:1})]),_:2},1032,["secondary","onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:2},1032,["list","onChange"])],64)):Ze("",!0)]),_:2},1024)]),_:2},1032,["default-expanded-names"])]),_:2},1024))),128))]),_:1},8,["list"]),s(ht,{page:t(b),"onUpdate:page":u[3]||(u[3]=w=>It(b)?b.value=w:null),class:"mt-5 justify-end","show-size-picker":"","page-size":t(R),"page-sizes":[6,10,24,36,48],"page-count":Math.ceil(t(a).length/t(R)),"onUpdate:pageSize":L},{prefix:c(()=>[Me(J(`${t(a).length} ${t(i)("categorie_s")}`),1)]),_:1},8,["page","page-size","page-count"])],64)):(le(),Ue(Se,{key:1,size:"large",class:Qe(`mb-2 !border-dashed !border-2 ${t(Z)("!border-zinc-300","!border-zinc-600")}`)},{default:c(()=>[s(We,{description:t(i)("noCategoryAvailable")},{icon:c(()=>[s(t(z),null,{default:c(()=>[t(A)?(le(),Ue(S,{key:0,icon:"carbon:search"})):(le(),Ue(S,{key:1,icon:"carbon:categories"}))]),_:1})]),extra:c(()=>[t(A)?Ze("",!0):(le(),Oe("div",_l,[s(t(q),{size:"small",onClick:u[4]||(u[4]=w=>pe(null))},{icon:c(()=>[s(t(z),null,{default:c(()=>[s(S,{icon:"carbon:add-alt"})]),_:1})]),default:c(()=>[Me(" "+J(t(i)("addCategory")),1)]),_:1})]))]),_:1},8,["description"])]),_:1},8,["class"]))])]),_:1}),s(m,{show:t(g),"onUpdate:show":u[5]||(u[5]=w=>It(g)?g.value=w:null),title:t(i)("selectImage"),"upload-config":{folder:yl,limit:0,maxSize:0,baseUrl:t(ge)?.apiUrl+"/media-files/upload",excludedExtensions:[]},onSubmit:v},null,8,["show","title","upload-config"]),s(Lt,{show:t(o),"onUpdate:show":u[14]||(u[14]=w=>It(o)?o.value=w:null),loading:t(he),preset:"dialog",style:{width:"500px"},"show-icon":!1,bordered:!1,"mask-closable":!1,title:t(C)?t(F)?t(i)("editSubCategory"):t(i)("editCategory"):t(F)?t(i)("addSubCategory"):t(i)("addCategory"),"positive-text":t(i)("validate"),"negative-text":t(i)("cancel"),onPositiveClick:Ve,onNegativeClick:u[15]||(u[15]=w=>o.value=!1)},{default:c(()=>[s($t,{ref_key:"formRef",ref:j,class:"mt-5",model:t(h),rules:Ce,"show-require-mark":!1,size:"medium"},{default:c(()=>[s(yt,{"show-label":!1,path:"name"},{default:c(()=>[s(ut,{modelValue:t(h).name,"onUpdate:modelValue":u[6]||(u[6]=w=>t(h).name=w),placeholder:t(i)("name"),class:"w-full",sync:""},{label:c(()=>[Me(J(t(i)("name")),1)]),_:1},8,["modelValue","placeholder"])]),_:1}),s(yt,{"show-label":!1,path:"description"},{default:c(()=>[s(ut,{modelValue:t(h).description,"onUpdate:modelValue":u[7]||(u[7]=w=>t(h).description=w),placeholder:t(i)("description"),type:"textarea",class:"w-full",rows:3,sync:""},{label:c(()=>[Me(J(t(i)("description")),1)]),_:1},8,["modelValue","placeholder"])]),_:1}),s(bt,{"x-gap":"12",span:24},{default:c(()=>[s(Xe,{span:12,label:t(i)("position"),path:"position"},{default:c(()=>[s(qt,{value:t(h).position,"onUpdate:value":u[8]||(u[8]=w=>t(h).position=w),placeholder:t(i)("position"),class:"w-full",min:0},null,8,["value","placeholder"])]),_:1},8,["label"]),s(Xe,{span:12,label:t(i)("color"),path:"color"},{default:c(()=>[Ae("div",gl,[t(h).color?(le(),Oe(Je,{key:0},[s(t(q),{text:"",type:"error",style:{"font-size":"21px"},onClick:u[9]||(u[9]=w=>t(h).color="")},{default:c(()=>[s(t(z),null,{default:c(()=>[s(S,{icon:"carbon:trash-can"})]),_:1})]),_:1}),s(B,{vertical:""})],64)):Ze("",!0),s(t(Ua),{value:t(h).color,"onUpdate:value":u[10]||(u[10]=w=>t(h).color=w),class:"cursor-pointer",theme:t(N)?"light":"dark","z-index":5e3,format:"hex",size:"25"},null,8,["value","theme"])])]),_:1},8,["label"])]),_:1}),s(B,{dashed:"",class:"!my-2"}),s(bt,{"x-gap":"12",span:24},{default:c(()=>[s(Xe,{span:12,label:t(i)("preview"),path:"image"},{default:c(()=>[s(Ie,{align:"center",justify:"center",style:{height:"100%"}},{default:c(()=>[s(Pt,{class:"cursor-pointer","object-fit":"cover",style:ol("border: 1px dashed "+t(Z)("green","white")),size:150,src:t(Y)(t(h).image||""),onClick:u[11]||(u[11]=w=>g.value=!0)},{default:c(()=>[t(h).image?Ze("",!0):(le(),Ue(t(z),{key:0,size:64},{default:c(()=>[s(S,{icon:"carbon:image",class:"text-gray-400"})]),_:1}))]),_:1},8,["style","src"]),t(h).image?(le(),Ue(t(q),{key:0,quaternary:"",onClick:u[12]||(u[12]=w=>oe())},{icon:c(()=>[s(t(z),null,{default:c(()=>[s(S,{icon:"carbon:trash-can"})]),_:1})]),default:c(()=>[Me(" "+J(t(i)("clear")),1)]),_:1})):Ze("",!0)]),_:1})]),_:1},8,["label"]),s(Xe,{span:12,label:t(i)("status"),path:"isActive"},{default:c(()=>[s(kt,{value:t(h).isActive,"onUpdate:value":u[13]||(u[13]=w=>t(h).isActive=w),size:"small"},{checked:c(()=>[Me(J(t(i)("visible")),1)]),unchecked:c(()=>[Me(J(t(i)("hidden")),1)]),_:1},8,["value"])]),_:1},8,["label"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show","loading","title","positive-text","negative-text"])],64)}}}),{defineComponent:kl}=await _e("vue"),{unref:y,createVNode:Q,withCtx:ye,toDisplayString:Ft,createTextVNode:Ht,vShow:$l,withDirectives:xl,resolveComponent:Bs,isRef:na,Fragment:Cl,openBlock:Al,createElementBlock:zl}=await _e("vue"),{ref:ve,computed:oa,h:ee,watch:Il}=await _e("vue"),Sl=kl({__name:"index",setup(X){const k=Tt(),$=Vt(),ce=Rt(),{displayFormErrors:K,mergeArrays:Y,tr:Z}=gt(),{request:_}=Dt(),{t:f,locale:i}=it(),M=ve(""),ne=ve(),N=ve([]),ge=ve(!1),a=oa(()=>[{title:f("content"),key:"content",resizable:!0,width:300,fixed:"left",sortOrder:!1,sorter:"default",render(g){return ee(va,{class:"text-xs",lineClamp:1,expandTrigger:"click",tooltip:!1},{default:()=>g.content})}},{title:f("name"),key:"name",resizable:!0,width:150,ellipsis:{tooltip:!0}},{title:f("article"),key:"article",resizable:!0,width:250,ellipsis:{tooltip:!0},render(g){return ee("div",{},{default:()=>Z(g.article?.title)})},sortOrder:!1,sorter:"default"},{title:f("email"),key:"email",resizable:!0,width:150,ellipsis:{tooltip:!0}},{title:f("status"),key:"isActive",width:100,render(g){return ee(Fe,{type:g.isActive?"success":"error",bordered:!1},{default:()=>g.isActive?f("published"):f("unpublished")})},sortOrder:!1,sorter:"default"},{title:f("lastEdition"),key:"updatedAt",width:125,render(g){return ee("div",{},{default:()=>tt(g.updatedAt,{locale:i.value})})}},{title:f("creation"),key:"createdAt",width:125,render(g){return ee("div",{},{default:()=>tt(g.createdAt,{locale:i.value})})}},{title:()=>ee(_a,{},{default:()=>[ee(Ge,{ref:ne,placeholder:f("search"),value:M.value,onInput:g=>{M.value=g,M.value||R(`/news-comments?pageSize=${A.value}&page=${E.value}&query=${M.value}`)},clearable:!0}),ee(q,{onClick:()=>{R(`/news-comments?pageSize=${A.value}&page=${E.value}&query=${M.value}`)}},{default:()=>ee(z,{color:"white"},{default:()=>ee(O,{icon:"carbon:search"})})})]}),key:"actions",width:200,render(g){return ee("div",{class:"flex justify-end items-center w-full"},[ee(Oa,{value:g.isActive?1:0,"onUpdate:value":async v=>{k.start(),b.value=!0;const oe=await _({url:`/news-comments/${g.id}`,method:"put",data:{isActive:v}});if(oe.failure&&oe.error)switch(oe.error?.response?.data?.errorCode){case at.FORM_INVALID_DATA:K(oe.error?.response?.data?.data);break;default:$.error(f("anErrorOccurred"))}else $.success(f("success")),R(`/news-comments?pageSize=${A.value}&page=${E.value}&query=${M.value}`);b.value=!1,k.finish()},trigger:"click",placement:"left",options:[{label:f("published"),value:1},{label:f("unpublished"),value:0}]},{default:()=>[ee(q,{size:"small",type:"warning",renderIcon:()=>ee(z,null,{default:()=>ee(O,{icon:"carbon:certificate-check"})})},{default:()=>f("status")})]}),ee("div",{class:"w-2"}),ee(q,{size:"small",type:"error",onClick:()=>{ce.warning({title:f("confirm"),content:f("confirmDeleteComment"),positiveText:f("yes"),negativeText:f("no"),onPositiveClick:async()=>{k.start(),(await _({url:`/news-comments/${g.id}`,method:"delete"})).success?$.success(f("success")):$.error(f("anErrorOccurred")),k.finish(),R(`/news-comments?pageSize=${A.value}&page=${E.value}&query=${M.value}`)}})},renderIcon:()=>ee(z,null,{default:()=>ee(O,{icon:"carbon:trash-can"})})})])},fixed:"right"}]),de=ve(0),A=ve(10),E=ve(1),I=g=>{R(`/news-comments?pageSize=${A.value}&page=${g}&query=${M.value}`)},T=g=>{A.value=g,R(`/news-comments?pageSize=${A.value}&query=${M.value}`)},R=async(g=null,v=!1)=>{ge.value=!0,k.start();const oe=await _({url:g||`/news-comments?pageSize=${A.value}&query=${M.value}`});oe.success&&oe.result&&(de.value=oe.result.data?.meta?.total||0,E.value=oe.result.data?.meta?.currentPage||1,N.value=oe.result.data?.comments||[]),k.finish(),ge.value=!1};R(null,!0);const b=ve(!1),L=ve(!1),F=ve(null),he=ve(null),o=ve({name:"",email:"",content:"",isActive:!0,articleId:void 0}),C={name:[{required:!0,message:f("fillRequired")}],email:[{required:!0,message:f("fillRequired")},{trigger:["input"],validator(g,v){return v&&!tl.isEmail(v)?new Error(f("invalidEmail")):!0}}],content:[{required:!0,message:f("fillRequired")}],articleId:[{required:!0,message:f("fillRequired")}]},j=g=>{F.value=xe.cloneDeep(g),o.value={name:"",email:"",content:"",isActive:!0,articleId:void 0},L.value=!0},h=async()=>(he.value?.validate(async g=>{if(!g)if(F.value)k.start(),b.value=!0,(await _({url:`/news-comments/${F.value.id}`,method:"put",data:{name:o.value.name,email:o.value.email,content:o.value.content,isActive:o.value.isActive,articleId:o.value.articleId}})).success?$.success(f("success")):$.error(f("anErrorOccurred")),b.value=!1,k.finish(),R(`/news-comments?pageSize=${A.value}&page=${E.value}&query=${M.value}`),L.value=!1;else{k.start(),b.value=!0;const v=await _({url:"/news-comments",method:"post",data:{name:o.value.name,email:o.value.email,content:o.value.content,isActive:o.value.isActive,articleId:o.value.articleId}});if(v.failure&&v.error)switch(v.error?.response?.data?.errorCode){case at.FORM_INVALID_DATA:K(v.error?.response?.data?.data);break;default:$.error(f("anErrorOccurred"))}else $.success(f("success"));b.value=!1,k.finish(),R(`/news-comments?pageSize=${A.value}&page=${E.value}&query=${M.value}`),L.value=!1}}),!1),Ce=ve(!1),pe=ve([]),ae=ve([]),Ve=async g=>{if(!g.length){ae.value=[];return}Ce.value=!0;const v=await _({url:`/news-articles/search/${g}`});v.success&&v.result&&(ae.value=v.result.data),Ce.value=!1};Il(()=>o.value.articleId,async g=>{if(!g)return;Ce.value=!0;const v=await _({url:"/news-articles/list",method:"post",data:{ids:[g]}});v.success&&v.result&&(pe.value=v.result.data),Ce.value=!1});const me=oa(()=>Y(pe.value,ae.value,"id"));return(g,v)=>{const oe=Mt,x=Jt,u=Qt,S=Xt,Ie=Et,H=ga,B=Zt,Se=Ut,fe=Nt;return Al(),zl(Cl,null,[Q(oe,{to:"#add-comment-action"},{default:ye(()=>[xl(Q(y(q),{type:"primary",onClick:v[0]||(v[0]=G=>j(null))},{icon:ye(()=>[Q(y(z),{size:"18"},{default:ye(()=>[Q(y(O),{icon:"carbon:add-alt"})]),_:1})]),default:ye(()=>[Ht(" "+Ft(y(f)("addComment")),1)]),_:1},512),[[$l,!1]])]),_:1}),Q(u,null,{default:ye(()=>[Q(x,{"pagination-behavior-on-filter":"first",columns:y(a),data:y(N),loading:y(ge),"single-line":!1,"scroll-x":1500,striped:""},null,8,["columns","data","loading"])]),_:1}),Q(S,{page:y(E),"onUpdate:page":[v[1]||(v[1]=G=>na(E)?E.value=G:null),I],class:"mt-5 justify-end","show-size-picker":"","page-size":y(A),"page-sizes":[6,10,24,36,48],"page-count":Math.ceil(y(de)/y(A)),"onUpdate:pageSize":T},null,8,["page","page-size","page-count"]),Q(fe,{show:y(L),"onUpdate:show":v[7]||(v[7]=G=>na(L)?L.value=G:null),loading:y(b),preset:"dialog",style:{width:"500px"},"show-icon":!1,bordered:!1,"mask-closable":!1,title:y(F)?y(f)("editComment"):y(f)("addComment"),"positive-text":y(f)("validate"),"negative-text":y(f)("cancel"),onPositiveClick:h,onNegativeClick:v[8]||(v[8]=G=>L.value=!1)},{default:ye(()=>[Q(Se,{ref_key:"formRef",ref:he,class:"mt-5",model:y(o),rules:C,"show-require-mark":!1,size:"medium"},{default:ye(()=>[Q(Ie,{label:y(f)("name"),path:"name"},{default:ye(()=>[Q(y(Ge),{value:y(o).name,"onUpdate:value":v[2]||(v[2]=G=>y(o).name=G),placeholder:y(f)("name"),class:"w-full"},null,8,["value","placeholder"])]),_:1},8,["label"]),Q(Ie,{label:y(f)("email"),path:"email"},{default:ye(()=>[Q(y(Ge),{value:y(o).email,"onUpdate:value":v[3]||(v[3]=G=>y(o).email=G),placeholder:y(f)("email"),class:"w-full"},null,8,["value","placeholder"])]),_:1},8,["label"]),Q(Ie,{label:y(f)("article"),path:"article"},{default:ye(()=>[Q(H,{value:y(o).articleId,"onUpdate:value":v[4]||(v[4]=G=>y(o).articleId=G),options:y(me),placeholder:y(f)("article"),loading:y(Ce),filterable:"",clearable:"",remote:"","value-field":"id","label-field":"fullname",class:"w-full",onSearch:Ve},null,8,["value","options","placeholder","loading"])]),_:1},8,["label"]),Q(Ie,{label:y(f)("content"),path:"content"},{default:ye(()=>[Q(y(Ge),{value:y(o).content,"onUpdate:value":v[5]||(v[5]=G=>y(o).content=G),placeholder:y(f)("content"),type:"textarea",class:"w-full"},null,8,["value","placeholder"])]),_:1},8,["label"]),Q(Ie,{label:y(f)("status"),path:"isActive"},{default:ye(()=>[Q(B,{value:y(o).isActive,"onUpdate:value":v[6]||(v[6]=G=>y(o).isActive=G),size:"small"},{checked:ye(()=>[Ht(Ft(y(f)("published")),1)]),unchecked:ye(()=>[Ht(Ft(y(f)("unpublished")),1)]),_:1},8,["value"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["show","loading","title","positive-text","negative-text"])],64)}}});var te=(X=>(X[X.DRAFT=1]="DRAFT",X[X.PENDING=2]="PENDING",X[X.PUBLISHED=3]="PUBLISHED",X[X.TRASH=4]="TRASH",X))(te||{});const Dl=()=>{const{t:X}=it(),k=[{label:X("draft"),value:te.DRAFT,tagType:"default"},{label:X("pending"),value:te.PENDING,tagType:"info"},{label:X("published"),value:te.PUBLISHED,tagType:"success"},{label:X("trash"),value:te.TRASH,tagType:"error"}];return{getNewsArticleStatusTagType:K=>k.find(Y=>Y.value===K)?.tagType||"default",getNewsArticleStatusLabel:K=>k.find(Y=>Y.value===K)?.label,newsArticleStatus:k}},{defineComponent:Ml}=await _e("vue"),{unref:e,toDisplayString:P,createElementVNode:et,createVNode:r,withCtx:d,createTextVNode:W,openBlock:be,createBlock:ot,createCommentVNode:rt,createElementBlock:Ye,resolveComponent:Fs,isRef:Ne,renderList:ra,Fragment:Ot,vShow:Tl,withDirectives:Vl,normalizeStyle:Rl}=await _e("vue"),Nl={key:0,class:"flex items-center gap-3"},Ul={key:1,class:"flex items-center gap-3"},El={class:"flex justify-end"},ql={key:0},Pl={key:0},Ll={key:0},Bl={class:"flex justify-center"},Fl={class:"text-base"},Hl={class:"px-10 mt-20"},Ol={class:"w-full text-center"},{inject:Yl,ref:D,computed:ia,h:V,watch:Kl}=await _e("vue"),jl="articles",Gl=Ml({__name:"index",setup(X){const k=Tt(),$=Vt(),ce=Rt(),{displayFormErrors:K,tr:Y,pickByTheme:Z,fileUrl:_}=gt(),{newsArticleStatus:f}=Dl(),{request:i}=Dt(),{tags:M,orderedCategories:ne}=Kt(St()),{loadCategories:N,loadTags:ge}=St(),{t:a,locale:de}=it(),A=Va(),E=Yl("appConfig"),I=D([]),T=D([]),R=D([]),b=D(0),L=n=>{let l=`${n}&query=${F.value}&status=${b.value}`;for(const ie of I.value)l+=`&categories[]=${ie}`;for(const ie of T.value)l+=`&tags[]=${ie}`;for(const ie of R.value)l+=`&months[]=${ie}`;return l},F=D(""),he=D(),o=D([]),C=D([]),j=D([]),h=D({}),Ce=D(0),pe=D(0),ae=D(!1),Ve=D(null),me=D(null),g=D(!1),v=ia(()=>[{type:"selection"},{title:a("title"),key:"title",resizable:!0,width:250,fixed:"left",ellipsis:{tooltip:!0},render(n){return V("div",{},{default:()=>Y(n.title)})}},{title:a("summary"),key:"summary",resizable:!0,width:200,render(n){return V(va,{class:"text-xs",lineClamp:1,expandTrigger:"click",tooltip:!1},{default:()=>Y(n.summary)})}},{title:a("categories"),key:"categories",width:150,render(n){return V("div",{},{default:()=>n.categories?.map(l=>l.name).map(l=>V(Fe,{type:"info",size:"small",class:"mr-1 mb-1"},{default:()=>Y(l)}))})}},{title:a("tags"),key:"tags",width:150,render(n){return V("div",{},{default:()=>n.tags?.map(l=>l.name).map(l=>V(Fe,{type:"primary",size:"small",class:"mr-1 mb-1"},{default:()=>Y(l)}))})}},{title:a("headline"),key:"isHeadline",resizable:!0,width:150,ellipsis:{tooltip:!0},render(n){return V(Fe,{type:n.isHeadline?"success":"error",bordered:!1},{default:()=>n.isHeadline?a("yes"):a("no")})}},{title:a("author"),key:"author",resizable:!0,width:150,ellipsis:{tooltip:!0},render(n){return V("div",{},{default:()=>n.author?.firstname+" "+n.author?.lastname})}},{title:a("lastEdition"),key:"updatedAt",width:125,render(n){return V("div",{},{default:()=>tt(n.updatedAt,{locale:de.value})})}},{title:a("creation"),key:"createdAt",width:125,render(n){return V("div",{},{default:()=>tt(n.createdAt,{locale:de.value})})}},{title:()=>V(_a,{},{default:()=>[V(Ge,{ref:he,placeholder:a("search"),value:F.value,onInput:n=>{F.value=n,F.value||H(L(`/news-articles?pageSize=${x.value}&page=${u.value}`))},clearable:!0}),V(q,{onClick:()=>{H(L(`/news-articles?pageSize=${x.value}&page=${u.value}`))}},{default:()=>V(z,{color:"white"},{default:()=>V(O,{icon:"carbon:search"})})})]}),key:"actions",width:225,render(n){return V("div",{class:"flex justify-end items-center w-full"},[V(q,{size:"small",type:"warning",onClick:()=>{Xe(n)},renderIcon:()=>V(z,null,{default:()=>V(O,{icon:"carbon:edit"})})},{default:()=>a("edit")}),V("div",{class:"w-2"}),V(q,{size:"small",type:"info",onClick:()=>{Ve.value=n,me.value=n.status,ae.value=!0},renderIcon:()=>V(z,null,{default:()=>V(O,{icon:"mdi:equal"})})},b.value==te.TRASH?{}:{default:()=>a("status")}),V("div",{class:"w-2"}),b.value==te.TRASH?V(q,{size:"small",type:"error",onClick:()=>{ce.warning({title:a("confirm"),content:a("confirmDeleteComment"),positiveText:a("yes"),negativeText:a("no"),onPositiveClick:async()=>{k.start(),(await i({url:`/news-articles/${n.id}`,method:"delete"})).success?$.success(a("success")):$.error(a("anErrorOccurred")),k.finish(),H(L(`/news-articles?pageSize=${x.value}&page=${u.value}`))}})},renderIcon:()=>V(z,null,{default:()=>V(O,{icon:"carbon:trash-can"})})}):null])},fixed:"right"}]),oe=D(0),x=D(10),u=D(1),S=n=>{H(L(`/news-articles?pageSize=${x.value}&page=${n}`))},Ie=n=>{x.value=n,H(L(`/news-articles?pageSize=${x.value}`))},H=async(n=null,l=!1)=>{g.value=!0,k.start();const ie=await i({url:n||L(`/news-articles?pageSize=${x.value}`)});if(ie.success&&ie.result&&(oe.value=ie.result.data?.meta?.total||0,u.value=ie.result.data?.meta?.currentPage||1,o.value=ie.result.data?.articles||[]),l){const Re=await i({url:"/users/type/administrators"});Re.success&&Re.result&&(C.value=Re.result.data||[]);const ct=await i({url:"/news-articles/list/months"});ct.success&&ct.result&&(j.value=(ct.result.data||[]).map(Ct=>({label:Ct,value:Ct})));const He=await i({url:"/count/news-articles"});He.success&&He.result&&(pe.value=He.result.data);const st=await i({url:`/count/news-articles/status/${te.DRAFT}`});st.success&&st.result&&(h.value[te.DRAFT]=st.result.data);const nt=await i({url:`/count/news-articles/status/${te.PUBLISHED}`});nt.success&&nt.result&&(h.value[te.PUBLISHED]=nt.result.data);const dt=await i({url:`/count/news-articles/status/${te.PENDING}`});dt.success&&dt.result&&(h.value[te.PENDING]=dt.result.data);const pt=await i({url:`/count/news-articles/status/${te.TRASH}`});pt.success&&pt.result&&(h.value[te.TRASH]=pt.result.data);const mt=await i({url:`/count/news-articles/author/${A.userData?.id}`});mt.success&&mt.result&&(Ce.value=mt.result.data),await N(),await ge()}xt(),k.finish(),g.value=!1};H(null,!0);const B=D(!1),Se=D(!1),fe=D([]),G=D(fe.value),De=D([]),ht=D(De.value),We=D(null),wt=D(null),m=D({authorId:A.userData?.id,publisherId:A.userData?.id,title:"",slug:"",summary:"",content:'{"fr":""}',featuredImage:"",featuredImageUrl:"",legend:"",allowComments:!0,isHeadline:!1,status:te.DRAFT,publishedAt:aa(new Date,{outPattern:"YYYY-MM-DD HH:mm:ss",locale:de.value})}),ut=D(m.value),yt={title:[{required:!0,message:a("fillRequired")}],slug:[{required:!0,message:a("fillRequired")}],content:[{required:!0,message:a("fillRequired")}],summary:[{required:!0,message:a("fillRequired")}],featuredImage:[{required:!0,message:a("fillRequired")}],authorId:[{required:!0,message:a("fillRequired")}],publisherId:[{required:!0,message:a("fillRequired")}]},qt=ia(()=>xe.isEqual(fe.value,G.value)&&xe.isEqual(De.value,ht.value)&&xe.isEqual(m.value,ut.value)),Xe=n=>{We.value=xe.cloneDeep(n),n?(m.value=xe.cloneDeep(n),fe.value=n.tags?.map(l=>l.id)??[],De.value=n.categories?.map(l=>l.id)??[]):(m.value={authorId:A.userData?.id,publisherId:A.userData?.id,title:"",slug:"",summary:"",content:'{"fr":""}',featuredImage:"",featuredImageUrl:"",legend:"",allowComments:!0,isHeadline:!1,status:te.DRAFT,publishedAt:aa(new Date,{outPattern:"YYYY-MM-DD HH:mm:ss",locale:de.value})},fe.value=[],De.value=[]),G.value=xe.cloneDeep(fe.value),ht.value=xe.cloneDeep(De.value),ut.value=xe.cloneDeep(m.value),Se.value=!0},bt=async()=>(wt.value?.validate(async n=>{if(!n)if(We.value){k.start(),B.value=!0;const l=await i({url:`/news-articles/${We.value.id}`,method:"put",data:{authorId:m.value.authorId,publisherId:m.value.publisherId,title:m.value.title,slug:m.value.slug,summary:m.value.summary,content:m.value.content,featuredImage:m.value.featuredImage,legend:m.value.legend,allowComments:m.value.allowComments,isHeadline:m.value.isHeadline,status:m.value.status,publishedAt:m.value.publishedAt,categories:De.value,tags:fe.value}});if(l.failure&&l.error)switch(l.error?.response?.data?.errorCode){case at.FORM_INVALID_DATA:K(l.error?.response?.data?.data);break;default:$.error(a("anErrorOccurred"))}else $.success(a("success"));B.value=!1,k.finish(),H(L(`/news-articles?pageSize=${x.value}&page=${u.value}`)),Se.value=!1}else{k.start(),B.value=!0;const l=await i({url:"/news-articles",method:"post",data:{authorId:m.value.authorId,publisherId:m.value.publisherId,title:m.value.title,slug:m.value.slug,summary:m.value.summary,content:m.value.content,featuredImage:m.value.featuredImage,legend:m.value.legend,allowComments:m.value.allowComments,isHeadline:m.value.isHeadline,status:m.value.status,publishedAt:m.value.publishedAt,categories:De.value,tags:fe.value}});if(l.failure&&l.error)switch(l.error?.response?.data?.errorCode){case at.FORM_INVALID_DATA:K(l.error?.response?.data?.data);break;default:$.error(a("anErrorOccurred"))}else $.success(a("success"));B.value=!1,k.finish(),H(L(`/news-articles?pageSize=${x.value}&page=${u.value}`)),Se.value=!1}}),!1),Pt=async()=>{if(Ve.value){k.start(),B.value=!0;const n=await i({url:`/news-articles/${Ve.value.id}`,method:"put",data:{status:me.value}});if(n.failure&&n.error)switch(n.error?.response?.data?.errorCode){case at.FORM_INVALID_DATA:K(n.error?.response?.data?.data);break;default:$.error(a("anErrorOccurred"))}else $.success(a("success"));H(L(`/news-articles?pageSize=${x.value}&page=${u.value}`),!0),B.value=!1,k.finish()}Ve.value=null,me.value=null,ae.value=!1},kt=n=>[n.parentId?V(z,{style:{verticalAlign:"-0.15em",marginRight:"4px"}},{default:()=>V(O,{icon:"mdi:arrow-right"})}):null,`${Y(n.name)}`],$t=n=>V("span",{},{default:()=>`${Y(n.name)||n.name}`}),Lt=n=>V("span",{},{default:()=>tt(n.label,{inPattern:"YYYY-MM",outPattern:"MMMM YYYY",locale:de.value})}),w=n=>/^[a-z0-9_-]*$/.test(n);Kl(()=>m.value.title,n=>{We.value||(m.value.slug=al(Y(n),{trim:!0,lower:!0,strict:!0}))});const re=D(!1),lt=async n=>{m.value.featuredImage=n,re.value=!1},wa=()=>{m.value.featuredImage=""},ea=D(la()),we=D([]),ya=n=>n.id,ba=n=>{we.value=n};function xt(){we.value=[],ea.value=la()}const ka=async()=>(we.value.length?ce.warning({title:a("confirm"),content:a("deleteSelectionWarningMessage",[we.value.length]),positiveText:a("yes"),negativeText:a("no"),onPositiveClick:async()=>{B.value=!0,k.start();for(let n=0;n<we.value.length;n++)(await i({url:`/news-articles/${we.value[n]}`,method:"delete"})).success;H(null,!0),k.finish(),B.value=!1,$.success(a("success")),xt()}}):$.warning(a("noItemSelected")),!1),$a=async()=>(we.value.length?ce.warning({title:a("confirm"),content:a("editSelectionStatusWarningMessage",[we.value.length]),positiveText:a("yes"),negativeText:a("no"),onPositiveClick:async()=>{B.value=!0,k.start();for(let n=0;n<we.value.length;n++)(await i({url:`/news-articles/${we.value[n]}`,method:"put",data:{status:me.value}})).success;H(null,!0),k.finish(),B.value=!1,ae.value=!1,$.success(a("success")),xt()}}):$.warning(a("noItemSelected")),!1);return(n,l)=>{const ie=Ya,Re=ga,ct=Mt,He=ja,st=Ka,nt=Wt,dt=Jt,pt=Qt,mt=Xt,Ct=pa,xa=Ga,Ca=Nt,Aa=Za,za=Gt,At=jt,Ee=Et,zt=fa,Bt=ma,Ia=Xa,ta=Wa,Sa=Ut,Da=Na;return be(),Ye(Ot,null,[r(ct,{to:"#add-article-action"},{default:d(()=>[e(we).length?(be(),Ye("section",Nl,[et("span",null,P(e(a)("nbItemsSelected",[e(we).length])),1),e(b)==e(te).TRASH?(be(),ot(e(q),{key:0,type:"error",size:"small",onClick:ka},{icon:d(()=>[r(e(z),null,{default:d(()=>[r(e(O),{icon:"carbon:trash-can"})]),_:1})]),default:d(()=>[W(" "+P(e(a)("delete")),1)]),_:1})):rt("",!0),r(e(q),{type:"info",size:"small",onClick:l[0]||(l[0]=()=>{Ve.value=null,me.value=null,ae.value=!0})},{icon:d(()=>[r(e(z),null,{default:d(()=>[r(e(O),{icon:"mdi:equal"})]),_:1})]),default:d(()=>[W(" "+P(e(a)("editStatus")),1)]),_:1}),r(e(q),{type:"warning",size:"small",onClick:xt},{icon:d(()=>[r(e(z),null,{default:d(()=>[r(e(O),{icon:"carbon:close"})]),_:1})]),default:d(()=>[W(" "+P(e(a)("cancelSelection")),1)]),_:1})])):(be(),Ye("section",Ul,[r(Re,{value:e(R),"onUpdate:value":[l[2]||(l[2]=p=>Ne(R)?R.value=p:null),l[3]||(l[3]=p=>H())],"render-label":Lt,options:e(j),placeholder:e(a)("months"),"max-tag-count":"responsive",filterable:"",multiple:"","label-field":"label","value-field":"value",class:"!w-[200px]"},{action:d(()=>[r(ie,{size:"large",class:"w-full","default-checked":e(j).length&&e(R).length===e(j).length,"onUpdate:checked":l[1]||(l[1]=p=>{p?R.value=e(j).map(qe=>qe.value):R.value=[],H()})},{default:d(()=>[W(P(e(a)("selectAll")),1)]),_:1},8,["default-checked"])]),_:1},8,["value","options","placeholder"]),r(Re,{value:e(T),"onUpdate:value":[l[5]||(l[5]=p=>Ne(T)?T.value=p:null),l[6]||(l[6]=p=>H())],"render-label":$t,placeholder:e(a)("tags"),options:e(M),"max-tag-count":"responsive",filterable:"",multiple:"","label-field":"name","value-field":"id",class:"!w-[200px]"},{action:d(()=>[r(ie,{size:"large",class:"w-full","default-checked":e(M).length&&e(T).length===e(M).length,"onUpdate:checked":l[4]||(l[4]=p=>{p?T.value=e(M).map(qe=>qe.id).filter(qe=>qe):T.value=[],H()})},{default:d(()=>[W(P(e(a)("selectAll")),1)]),_:1},8,["default-checked"])]),_:1},8,["value","placeholder","options"]),r(Re,{value:e(I),"onUpdate:value":[l[8]||(l[8]=p=>Ne(I)?I.value=p:null),l[9]||(l[9]=p=>H())],"render-label":kt,options:e(ne),placeholder:e(a)("categories"),"max-tag-count":"responsive",filterable:"",multiple:"","label-field":"name","value-field":"id",class:"!w-[250px]"},{action:d(()=>[r(ie,{size:"large",class:"w-full","default-checked":e(ne).length&&e(I).length===e(ne).length,"onUpdate:checked":l[7]||(l[7]=p=>{p?I.value=e(ne).map(qe=>qe.id).filter(qe=>qe):I.value=[],H()})},{default:d(()=>[W(P(e(a)("selectAll")),1)]),_:1},8,["default-checked"])]),_:1},8,["value","options","placeholder"]),r(e(q),{type:"primary",onClick:l[10]||(l[10]=p=>Xe(null))},{icon:d(()=>[r(e(z),null,{default:d(()=>[r(e(O),{icon:"carbon:add-alt"})]),_:1})]),default:d(()=>[W(" "+P(e(a)("addArticle")),1)]),_:1})]))]),_:1}),r(nt,{size:"small",class:"mb-5"},{default:d(()=>[et("div",El,[r(st,{value:e(b),"onUpdate:value":[l[11]||(l[11]=p=>Ne(b)?b.value=p:null),l[12]||(l[12]=p=>H())],name:"filterstatusradiobuttongroup",size:"medium",disabled:!!e(we).length},{default:d(()=>[r(He,{value:0},{default:d(()=>[W(P(e(a)("all"))+"  ",1),e(pe)?(be(),Ye("span",ql," ("+P(e(pe))+") ",1)):rt("",!0)]),_:1}),r(He,{value:10},{default:d(()=>[W(P(e(a)("myArticles"))+"  ",1),e(Ce)?(be(),Ye("span",Pl," ("+P(e(Ce))+") ",1)):rt("",!0)]),_:1}),(be(!0),Ye(Ot,null,ra(e(f),p=>(be(),ot(He,{key:p.value,value:p.value},{default:d(()=>[W(P(p.label)+"  ",1),e(h)[p.value]?(be(),Ye("span",Ll," ("+P(e(h)[p.value])+") ",1)):rt("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["value","disabled"])])]),_:1}),r(pt,null,{default:d(()=>[(be(),ot(dt,{key:e(ea),columns:e(v),data:e(o),loading:e(g),"single-line":!1,"scroll-x":1500,"row-key":ya,"pagination-behavior-on-filter":"first",size:"small",striped:"","onUpdate:checkedRowKeys":ba},null,8,["columns","data","loading","row-key"]))]),_:1}),r(mt,{page:e(u),"onUpdate:page":[l[13]||(l[13]=p=>Ne(u)?u.value=p:null),S],class:"mt-5 justify-end","show-size-picker":"","page-size":e(x),"page-sizes":[6,10,24,36,48],"page-count":Math.ceil(e(oe)/e(x)),"onUpdate:pageSize":Ie},null,8,["page","page-size","page-count"]),r(Ct,{show:e(re),"onUpdate:show":l[14]||(l[14]=p=>Ne(re)?re.value=p:null),title:e(a)("selectImage"),"upload-config":{folder:jl,limit:0,maxSize:0,baseUrl:e(E)?.apiUrl+"/media-files/upload",excludedExtensions:[]},onSubmit:lt},null,8,["show","title","upload-config"]),r(Ca,{show:e(ae),"onUpdate:show":l[17]||(l[17]=p=>Ne(ae)?ae.value=p:null),preset:"card",style:{width:"500px"},bordered:!1,"mask-closable":!1,"close-on-esc":!1,title:e(a)("editStatus")},{default:d(()=>[r(xa,{show:e(B)},{default:d(()=>[et("div",Bl,[r(st,{value:e(me),"onUpdate:value":[l[15]||(l[15]=p=>Ne(me)?me.value=p:null),l[16]||(l[16]=()=>{e(we).length?$a():Pt()})],name:"filterstatusradiobuttongroup",size:"large"},{default:d(()=>[(be(!0),Ye(Ot,null,ra(e(f),p=>(be(),ot(He,{key:p.value,value:p.value,size:"large"},{default:d(()=>[W(P(p.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])]),_:1},8,["show"])]),_:1},8,["show","title"]),r(Da,{modelValue:e(Se),"onUpdate:modelValue":l[33]||(l[33]=p=>Ne(Se)?Se.value=p:null),class:"w-full"},{header:d(()=>[et("div",Fl,[r(Aa,{depth:"1"},{default:d(()=>[W(P(e(We)?e(a)("editArticle"):e(a)("addArticle")),1)]),_:1})])]),"header-extra":d(()=>[r(za,{class:"mr-10",align:"center"},{default:d(()=>[r(e(q),{type:"success",title:e(a)("save"),loading:e(g)||e(B),disabled:e(qt),onClick:l[18]||(l[18]=p=>bt())},{icon:d(()=>[r(e(z),null,{default:d(()=>[r(e(O),{icon:"carbon:save"})]),_:1})]),default:d(()=>[W(" "+P(e(a)("save")),1)]),_:1},8,["title","loading","disabled"])]),_:1})]),default:d(()=>[et("section",Hl,[r(Sa,{ref_key:"formRef",ref:wt,model:e(m),rules:yt,"show-require-mark":!1,size:"medium"},{default:d(()=>[r(Bt,{cols:"5","x-gap":14,"y-gap":12,"item-responsive":""},{default:d(()=>[r(ta,{span:"0:5 400:5 600:2 800:2"},{default:d(()=>[r(Ee,{"show-label":!1,path:"title"},{default:d(()=>[r(At,{modelValue:e(m).title,"onUpdate:modelValue":l[19]||(l[19]=p=>e(m).title=p),placeholder:e(a)("title"),class:"w-full",sync:""},{label:d(()=>[W(P(e(a)("title")),1)]),_:1},8,["modelValue","placeholder"])]),_:1}),r(Ee,{label:e(a)("slug"),path:"slug"},{default:d(()=>[r(e(Ge),{value:e(m).slug,"onUpdate:value":l[20]||(l[20]=p=>e(m).slug=p),placeholder:e(a)("slug"),"allow-input":w,class:"w-full"},null,8,["value","placeholder"])]),_:1},8,["label"]),r(Bt,{"x-gap":"12",span:24},{default:d(()=>[r(zt,{span:12,label:e(a)("status"),path:"status"},{default:d(()=>[r(Re,{value:e(m).status,"onUpdate:value":l[21]||(l[21]=p=>e(m).status=p),placeholder:e(a)("status"),options:e(f),class:"w-full"},null,8,["value","placeholder","options"])]),_:1},8,["label"]),r(zt,{span:12,label:e(a)("author"),path:"authorId"},{default:d(()=>[r(Re,{value:e(m).authorId,"onUpdate:value":l[22]||(l[22]=p=>e(m).authorId=p),placeholder:e(a)("author"),options:e(C),"label-field":"fullname","value-field":"id",class:"w-full"},null,8,["value","placeholder","options"])]),_:1},8,["label"])]),_:1}),Vl(r(Ee,{label:e(a)("publicationDate"),path:"publishedAt"},{default:d(()=>[r(Ia,{"formatted-value":e(m).publishedAt,"onUpdate:formattedValue":l[23]||(l[23]=p=>e(m).publishedAt=p),"value-format":"yyyy-MM-dd HH:mm:ss",format:"dd MMMM yyyy - HH:mm",type:"datetime",class:"w-full"},null,8,["formatted-value"])]),_:1},8,["label"]),[[Tl,e(m).status===e(te).PUBLISHED]]),r(Ee,{label:e(a)("featuredImage"),path:"featuredImage"},{default:d(()=>[r(nt,null,{default:d(()=>[et("section",Ol,[et("div",{class:"cursor-pointer w-full h-[200px] flex items-center justify-center rounded-sm",style:Rl(`
                      border: 1px dashed ${e(Z)("green","white")};
                      background-image: url('${e(_)(e(m).featuredImageUrl||e(m).featuredImage||"")}');
                      background-position: center;
                      background-size: cover
                    `),onClick:l[24]||(l[24]=p=>re.value=!0)},[e(m).featuredImage?rt("",!0):(be(),ot(e(z),{key:0,size:64},{default:d(()=>[r(e(O),{icon:"carbon:image",class:"text-gray-400"})]),_:1}))],4),e(m).featuredImage?(be(),ot(e(q),{key:0,class:"!mt-5",quaternary:"",onClick:l[25]||(l[25]=p=>wa())},{icon:d(()=>[r(e(z),null,{default:d(()=>[r(e(O),{icon:"carbon:trash-can"})]),_:1})]),default:d(()=>[W(" "+P(e(a)("clear")),1)]),_:1})):rt("",!0)])]),_:1})]),_:1},8,["label"]),r(Ee,{"show-label":!1,path:"legend"},{default:d(()=>[r(At,{modelValue:e(m).legend,"onUpdate:modelValue":l[26]||(l[26]=p=>e(m).legend=p),placeholder:e(a)("legend"),class:"w-full",sync:""},{label:d(()=>[W(P(e(a)("legend")),1)]),_:1},8,["modelValue","placeholder"])]),_:1})]),_:1}),r(ta,{span:"0:5 400:5 600:3 800:3"},{default:d(()=>[r(Ee,{"show-label":!1,path:"summary"},{default:d(()=>[r(At,{modelValue:e(m).summary,"onUpdate:modelValue":l[27]||(l[27]=p=>e(m).summary=p),placeholder:e(a)("summary"),type:"textarea",class:"w-full",autosize:{minRows:3,maxRows:4},sync:""},{label:d(()=>[W(P(e(a)("summary")),1)]),_:1},8,["modelValue","placeholder"])]),_:1}),r(Ee,{"show-label":!1,path:"content"},{default:d(()=>[r(At,{modelValue:e(m).content,"onUpdate:modelValue":l[28]||(l[28]=p=>e(m).content=p),"should-not-group-editor-when-full":"",placeholder:e(a)("content"),type:"editor",class:"w-full",sync:""},{label:d(()=>[W(P(e(a)("content")),1)]),_:1},8,["modelValue","placeholder"])]),_:1}),r(Ee,{label:e(a)("categories"),path:"categories"},{default:d(()=>[r(Re,{value:e(De),"onUpdate:value":l[29]||(l[29]=p=>Ne(De)?De.value=p:null),"render-label":kt,placeholder:e(a)("categories"),options:e(ne),"max-tag-count":"responsive",filterable:"",multiple:"","label-field":"name","value-field":"id",class:"w-full"},null,8,["value","placeholder","options"])]),_:1},8,["label"]),r(Ee,{label:e(a)("tags"),path:"tags"},{default:d(()=>[r(Re,{value:e(fe),"onUpdate:value":l[30]||(l[30]=p=>Ne(fe)?fe.value=p:null),"render-label":$t,placeholder:e(a)("tags"),options:e(M),"max-tag-count":"responsive",filterable:"",multiple:"",tag:"","label-field":"name","value-field":"id",class:"w-full"},null,8,["value","placeholder","options"])]),_:1},8,["label"]),r(Bt,{"x-gap":"12",span:24},{default:d(()=>[r(zt,{"show-label":!1,span:12,path:"allowComments"},{default:d(()=>[r(ie,{checked:e(m).allowComments,"onUpdate:checked":l[31]||(l[31]=p=>e(m).allowComments=p)},{default:d(()=>[W(P(e(a)("allowComments")),1)]),_:1},8,["checked"])]),_:1}),r(zt,{"show-label":!1,span:12,path:"isHeadline"},{default:d(()=>[r(ie,{checked:e(m).isHeadline,"onUpdate:checked":l[32]||(l[32]=p=>e(m).isHeadline=p)},{default:d(()=>[W(P(e(a)("headline")),1)]),_:1},8,["checked"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])])]),_:1},8,["modelValue"])],64)}}}),Wl=ha(Gl,[["__scopeId","data-v-d2f4d1c5"]]),{defineComponent:Xl}=await _e("vue"),{unref:U,createVNode:ke,withCtx:$e,toDisplayString:vt,createTextVNode:_t,resolveComponent:Hs,isRef:Zl,Fragment:Jl,openBlock:Ql,createElementBlock:es}=await _e("vue"),{ref:Pe,h:se,computed:ts}=await _e("vue"),as=Xl({__name:"index",setup(X){const k=Tt(),$=Vt(),ce=Rt(),{displayFormErrors:K,tr:Y}=gt(),{request:Z}=Dt(),{t:_,locale:f}=it(),i=Pe(!1),M=Pe([]),ne=Pe(""),N=Pe(),ge={pageSize:12,prefix:({itemCount:o})=>se("div",{class:"font-bold"},{default:()=>`${_("total")}: ${o}`})},a=[{title:_("name"),key:"name",resizable:!0,width:150,ellipsis:{tooltip:!0},fixed:"left",sortOrder:!1,sorter:"default",render(o){return se("div",{},{default:()=>Y(o.name)})}},{title:_("description"),key:"description",resizable:!0,width:200,ellipsis:{tooltip:!0},render(o){return se("small",{},{default:()=>Y(o.description)})}},{title:_("status"),key:"isActive",width:100,render(o){return se(Fe,{type:o.isActive?"success":"error",bordered:!1},{default:()=>o.isActive?_("visible"):_("hidden")})},sortOrder:!1,sorter:"default"},{title:_("article_s"),key:"articlesCount",width:90,render(o){return se(Fe,{type:"info",bordered:!1},{default:()=>o.articlesCount})},sortOrder:!1,sorter:"default"},{title:_("updateAt"),key:"updatedAt",width:125,render(o){return se("div",{},{default:()=>tt(o.updatedAt,{locale:f.value,outPattern:"DD MMMM YYYY"})})}},{title:_("createdAt"),key:"createdAt",width:125,render(o){return se("div",{},{default:()=>tt(o.createdAt,{locale:f.value,outPattern:"DD MMMM YYYY"})})}},{title:()=>se(Ge,{ref:N,placeholder:_("search"),value:ne.value,onInput:o=>{ne.value=o}},{suffix:()=>se(z,{},{default:()=>se(O,{icon:"carbon:search"})})}),key:"actions",width:150,render(o){return se("div",{class:"flex justify-end items-center w-full"},[se(q,{size:"small",type:"warning",onClick:()=>{F(o)},renderIcon:()=>se(z,null,{default:()=>se(O,{icon:"carbon:edit"})})}),se("div",{class:"w-2"}),se(q,{size:"small",type:"error",onClick:()=>{ce.warning({title:_("confirm"),content:_("confirmDeleteNewsTag"),positiveText:_("yes"),negativeText:_("no"),onPositiveClick:async()=>{(await Z({method:"delete",url:`/news-tags/${o.id}`})).success?($.success(_("success")),A()):$.error(_("anErrorOccurred"))}})},renderIcon:()=>se(z,null,{default:()=>se(O,{icon:"carbon:trash-can"})})})])},fixed:"right"}],de=ts(()=>{if(!ne.value)return M.value;const o=M.value.filter(C=>C.name.toLowerCase().includes(ne.value.toLowerCase())||C.description?.toLowerCase().includes(ne.value.toLowerCase()));return N.value&&N.value.focus(),o}),A=async()=>{i.value=!0;const o=await Z({url:"/news-tags"});o.success&&o.result&&(M.value=o.result.data),i.value=!1};A();const E=Pe(!1),I=Pe(!1),T=Pe(null),R=Pe(null),b=Pe({name:"",description:"",isActive:!0}),L={name:[{required:!0,message:_("fillRequired")}],description:[{required:!0,message:_("fillRequired")}]},F=o=>{T.value=xe.cloneDeep(o),o?b.value=xe.cloneDeep(o):b.value={name:"",description:"",isActive:!0},I.value=!0},he=async()=>(R.value?.validate(async o=>{if(!o)if(T.value)if(T.value.name!==b.value.name&&M.value.findIndex(C=>C.name==b.value.name)>-1)$.error(_("sameTagNameMessage"));else{k.start(),E.value=!0;const C={name:b.value.name,description:b.value.description,isActive:b.value.isActive},j=await Z({method:"put",url:`/news-tags/${T.value.id}`,data:C});j.success&&j.result.data&&($.success(_("success")),A()),E.value=!1,k.finish(),I.value=!1}else if(M.value.findIndex(C=>C.name==b.value.name)>-1)$.error(_("sameTagNameMessage"));else{k.start(),E.value=!0;const C={name:b.value.name,description:b.value.description,isActive:b.value.isActive},j=await Z({method:"post",url:"/news-tags",data:C});if(j.failure&&j.error)switch(j.error?.response?.data?.errorCode){case at.FORM_INVALID_DATA:K(j.error?.response?.data?.data);break;default:$.error(_("anErrorOccurred"))}else $.success(_("success")),A();E.value=!1,k.finish(),I.value=!1}}),!1);return(o,C)=>{const j=Mt,h=Jt,Ce=Qt,pe=jt,ae=Et,Ve=Zt,me=Ut,g=Nt;return Ql(),es(Jl,null,[ke(j,{to:"#add-tag-action"},{default:$e(()=>[ke(U(q),{type:"primary",onClick:C[0]||(C[0]=v=>F(null))},{icon:$e(()=>[ke(U(z),{size:"18"},{default:$e(()=>[ke(U(O),{icon:"carbon:add-alt"})]),_:1})]),default:$e(()=>[_t(" "+vt(U(_)("addTag")),1)]),_:1})]),_:1}),ke(Ce,null,{default:$e(()=>[ke(h,{columns:a,data:U(de),pagination:ge,loading:U(i),"single-line":!1,"scroll-x":1e3,size:"small",striped:""},null,8,["data","loading"])]),_:1}),ke(g,{show:U(I),"onUpdate:show":C[4]||(C[4]=v=>Zl(I)?I.value=v:null),loading:U(E),preset:"dialog",style:{width:"450px"},bordered:!1,"show-icon":!1,"mask-closable":!1,title:U(T)?U(_)("editTag"):U(_)("addTag"),"positive-text":U(_)("validate"),"negative-text":U(_)("cancel"),onPositiveClick:he,onNegativeClick:C[5]||(C[5]=v=>I.value=!1)},{default:$e(()=>[ke(me,{ref_key:"formRef",ref:R,class:"mt-5",model:U(b),rules:L,"show-require-mark":!1,size:"medium"},{default:$e(()=>[ke(ae,{"show-label":!1,path:"name"},{default:$e(()=>[ke(pe,{modelValue:U(b).name,"onUpdate:modelValue":C[1]||(C[1]=v=>U(b).name=v),placeholder:U(_)("name"),class:"w-full",sync:""},{label:$e(()=>[_t(vt(U(_)("name")),1)]),_:1},8,["modelValue","placeholder"])]),_:1}),ke(ae,{"show-label":!1,path:"description"},{default:$e(()=>[ke(pe,{modelValue:U(b).description,"onUpdate:modelValue":C[2]||(C[2]=v=>U(b).description=v),placeholder:U(_)("description"),type:"textarea",class:"w-full",rows:3,sync:""},{label:$e(()=>[_t(vt(U(_)("description")),1)]),_:1},8,["modelValue","placeholder"])]),_:1}),ke(ae,{label:U(_)("status"),path:"isActive"},{default:$e(()=>[ke(Ve,{value:U(b).isActive,"onUpdate:value":C[3]||(C[3]=v=>U(b).isActive=v),size:"small"},{checked:$e(()=>[_t(vt(U(_)("visible")),1)]),unchecked:$e(()=>[_t(vt(U(_)("hidden")),1)]),_:1},8,["value"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["show","loading","title","positive-text","negative-text"])],64)}}}),{useCssVars:ls,defineComponent:ss}=await _e("vue"),{unref:ue,vShow:Ke,createElementVNode:Le,withDirectives:je,resolveComponent:Os,withCtx:Be,createVNode:Te,TransitionGroup:ns,normalizeStyle:os,openBlock:rs,createBlock:is}=await _e("vue"),us={id:"header-btn"},cs={id:"add-article-action"},ds={id:"add-comment-action"},ps={id:"add-category-action"},ms={id:"add-tag-action"},fs={key:"articles"},vs={key:"comments"},_s={key:"categories"},gs={key:"tags"},{defineComponent:hs,ref:ua,h:Yt,computed:ca,watch:ws,onMounted:ys}=await _e("vue"),bs=hs({name:Ra.NEWS_MANAGEMENT.NAME}),ks=ss({...bs,setup(X){ls(I=>({ae8402e2:ue(M)}));const k=["articles","categories","comments","tags"],$=I=>k.includes(I),{t:ce}=it(),K=ll(),{is2XlScreen:Y,isXlScreen:Z,isLgScreen:_,isMdScreen:f,isSmScreen:i,appSecondaryColor:M}=gt(),ne=da(),N=Ea("news-management",()=>({currentMenuItemKey:ua("articles")}))(),ge=(I,T)=>()=>Yt(z,{color:N.currentMenuItemKey==T?"white":""},{default:()=>Yt(O,{icon:I})}),a=(I,T)=>()=>Yt("span",{class:`${N.currentMenuItemKey==T?"text-white":""}`,id:xe.camelCase(T)},{default:()=>I}),de=ca(()=>[{label:a(ce("articles"),"articles"),key:"articles",icon:ge("carbon:document","articles")},{label:a(ce("comments"),"comments"),key:"comments",icon:ge("carbon:chat","comments")},{label:a(ce("categories"),"categories"),key:"categories",icon:ge("carbon:categories","categories")},{label:a(ce("tags"),"tags"),key:"tags",icon:ge("carbon:tag","tags")}]),A=ca(()=>ne.contentLayoutSize.height-200),E=ua();return ws(()=>[f.value,i.value,_.value,Z.value],([I,T,R,b])=>{E.value=I||T||R||b,setTimeout(()=>{E.value=void 0},500)}),ys(()=>{K.params.key&&$(K.params.key)&&(N.currentMenuItemKey=K.params.key)}),(I,T)=>{const R=Gt,b=el,L=Qa,F=Ja,he=Wt,o=Ma;return rs(),is(o,null,{"header-extra":Be(()=>[Te(R,null,{default:Be(()=>[Le("div",us,[je(Le("div",cs,null,512),[[Ke,ue(N).currentMenuItemKey==="articles"]]),je(Le("div",ds,null,512),[[Ke,ue(N).currentMenuItemKey==="comments"]]),je(Le("div",ps,null,512),[[Ke,ue(N).currentMenuItemKey==="categories"]]),je(Le("div",ms,null,512),[[Ke,ue(N).currentMenuItemKey==="tags"]])])]),_:1})]),default:Be(()=>[Te(he,{embedded:""},{default:Be(()=>[Te(F,{style:os(`height: ${ue(A)}px`)},{default:Be(()=>[Te(F,{position:"absolute",style:{top:"0",bottom:"0"},"has-sider":""},{default:Be(()=>[Te(L,{bordered:"","show-trigger":"","collapse-mode":"width","content-style":"padding: 4px",collapsed:ue(E),"default-collapsed":!ue(Y),"collapsed-width":64,"native-scrollbar":!1,width:ue(Y)?300:275},{default:Be(()=>[Te(b,{value:ue(N).currentMenuItemKey,"onUpdate:value":T[0]||(T[0]=C=>ue(N).currentMenuItemKey=C),"collapsed-width":64,"collapsed-icon-size":22,options:ue(de)},null,8,["value","options"])]),_:1},8,["collapsed","default-collapsed","width"]),Te(F,{"content-style":"padding: 10px 24px","native-scrollbar":!1},{default:Be(()=>[Te(ns,{name:"slide-fade"},{default:Be(()=>[je(Le("section",fs,[Te(Wl)],512),[[Ke,ue(N).currentMenuItemKey==="articles"]]),je(Le("section",vs,[Te(Sl)],512),[[Ke,ue(N).currentMenuItemKey==="comments"]]),je(Le("section",_s,[Te(bl)],512),[[Ke,ue(N).currentMenuItemKey==="categories"]]),je(Le("section",gs,[Te(as)],512),[[Ke,ue(N).currentMenuItemKey==="tags"]])]),_:1})]),_:1})]),_:1})]),_:1},8,["style"])]),_:1})]),_:1})}}}),Ys=ha(ks,[["__scopeId","data-v-b2ad2fbf"]]);export{Ys as default};
