import{i as A}from"./css-render_vue3-ssr-Vbotx5Ir.js";import{_ as X}from"./PageLayout.vue_vue_type_script_setup_true_lang-OixN3STA.js";import{_ as Y}from"./I18nInput-D7U2qJkw.js";import{I as Z}from"./iconify_vue-BwapRRpV.js";import{u as ee,d as ae,C as z,e as te,D as le,E as ne,R as se,F as N}from"./index-B2LlKIv2.js";import{_ as U}from"./lodash-DjP7BPMr.js";import{a as oe,b as ie,c as ue,ak as re,am as ce,A as de,G as pe,R as fe,g as _e,k as me,F as ge,B as ve,N as ye}from"./naive-ui-CrTIpLJ9.js";import{u as be}from"./vue-i18n-CWrb4u3f.js";const{defineComponent:we}=await A("vue"),{unref:t,resolveComponent:Oe,createVNode:a,withCtx:e,toDisplayString:i,createTextVNode:y,createElementVNode:o,normalizeClass:R,openBlock:D,createElementBlock:he,createCommentVNode:ke,createBlock:xe}=await A("vue"),Pe={class:"mb-4"},Te={class:"w-[260px]"},Ce={key:0,class:"mb-4"},Se={class:"text-gray"},Ie={class:"mb-4"},ze={class:"mb-4"},{defineComponent:Re,inject:Ae,ref:T,computed:V}=await A("vue"),Be=Re({name:se.APP_SETTINGS.NAME}),$e=we({...Be,setup(je){const{t:n}=be(),{request:B}=te(),{isSmScreen:C,formatKey:E}=ee(),b=oe(),w=ie(),K=ue(),S=ae(),F=Ae("appConfig"),f=T(!1),s=T(z(N)),h=T(z(N)),L=V(()=>U.isEqual(s.value,h.value)),O=async()=>{f.value=!0;const _=await B({url:"/app-settings",method:"put",data:s.value});if(_.success&&_.result){if(w.success(n("success")),s.value.basePath!==h.value.basePath){const l=h.value.basePath||"creopse",g=s.value.basePath||"creopse",u=new URL(window.location.href),p=`/${l}`,d=`/${g}`;if(u.pathname.startsWith(p)){u.pathname=u.pathname.replace(p,d);const v=u.pathname+u.search+u.hash;history.replaceState({},"",v)}}}else w.error(n("unableToUpdateSettings"));await k()},$=async()=>{K.warning({title:n("confirm"),content:n("confirmRestoreDefaultSettings"),positiveText:n("yes"),negativeText:n("no"),onPositiveClick:async()=>{f.value=!0,await S.initDefaultSettings(),await k(),f.value=!1}})},k=async()=>{b.start(),f.value=!0,await S.loadSettings(),S.settings?.forEach(_=>{s.value[_.key]!=null&&(s.value[_.key]=_.value)}),h.value=U.cloneDeep(s.value),f.value=!1,b.finish()};k();const H=()=>{le(ne(s.value),"settings")},x=T(null),q=()=>{x.value&&(x.value.value="",x.value.click())};function G(_){const l=_.target;if(!l.files||!l.files[0])return;const g=l.files[0],u=new FileReader;u.onload=async()=>{try{b.start(),f.value=!0;const p=JSON.parse(u.result),d=z(p),v={};for(const[r,m]of Object.entries(d))r in s.value&&(v[r]=m);await B({url:"/app-settings",method:"put",data:v}),await k(),f.value=!1,b.finish(),w.success(n("success"))}catch{w.error(n("unableToImportFile"))}},u.readAsText(g)}const J=V(()=>!0);return(_,l)=>{const g=Z,u=ye,p=ve,d=_e,v=me,r=de,m=fe,M=Y,P=pe,I=ge,j=ce,W=re,Q=X;return D(),xe(Q,null,{"header-extra":e(()=>[a(d,null,{default:e(()=>[a(p,{loading:t(f),onClick:$},{icon:e(()=>[a(u,{size:"18"},{default:e(()=>[a(g,{icon:"carbon:reset"})]),_:1})]),default:e(()=>[y(" "+i(t(n)("restore")),1)]),_:1},8,["loading"]),a(p,{type:"success",onClick:H},{icon:e(()=>[a(u,{size:"18"},{default:e(()=>[a(g,{icon:"carbon:upload"})]),_:1})]),default:e(()=>[y(" "+i(t(n)("export")),1)]),_:1}),a(p,{type:"info",onClick:q},{icon:e(()=>[a(u,{size:"18"},{default:e(()=>[a(g,{icon:"carbon:download"})]),_:1})]),default:e(()=>[y(" "+i(t(n)("import")),1)]),_:1}),o("input",{ref_key:"importInputRef",ref:x,type:"file",accept:".json",class:"hidden",onChange:G},null,544),a(p,{loading:t(f),disabled:t(L),type:"primary",onClick:O},{icon:e(()=>[a(u,{size:"18"},{default:e(()=>[a(g,{icon:"carbon:save"})]),_:1})]),default:e(()=>[y(" "+i(t(n)("save")),1)]),_:1},8,["loading","disabled"])]),_:1})]),default:e(()=>[a(W,{type:"card",animated:""},{default:e(()=>[a(j,{name:"general",tab:t(n)("general")},{default:e(()=>[o("section",Pe,[a(r,{hoverable:"",embedded:""},{header:e(()=>[y(i(t(n)("installationRegistration")),1)]),default:e(()=>[a(P,{cols:"1 s:2 m:2 l:2 xl:2 2xl:2",responsive:"screen","x-gap":12,"y-gap":12},{default:e(()=>[a(m,null,{default:e(()=>[a(r,{class:"w-full h-full",size:"small"},{default:e(()=>[a(d,{align:"center",justify:"space-between"},{default:e(()=>[o("span",null,i(t(n)("disableInstaller")),1),a(v,{value:t(s).disableInstaller,"onUpdate:value":l[0]||(l[0]=c=>t(s).disableInstaller=c),"checked-value":"1","unchecked-value":"0",size:"small"},{checked:e(()=>l[7]||(l[7]=[o("div",{class:"w-6"},null,-1)])),unchecked:e(()=>l[8]||(l[8]=[o("div",{class:"w-6"},null,-1)])),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),a(m,null,{default:e(()=>[a(r,{class:"w-full h-full",size:"small"},{default:e(()=>[a(d,{align:"center",justify:"space-between"},{default:e(()=>[o("span",null,i(t(n)("allowUsersRegistration")),1),a(v,{value:t(s).allowRegistration,"onUpdate:value":l[1]||(l[1]=c=>t(s).allowRegistration=c),"checked-value":"1","unchecked-value":"0",size:"small"},{checked:e(()=>l[9]||(l[9]=[o("div",{class:"w-6"},null,-1)])),unchecked:e(()=>l[10]||(l[10]=[o("div",{class:"w-6"},null,-1)])),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),a(m,null,{default:e(()=>[a(r,{class:"w-full h-full",size:"small"},{default:e(()=>[a(d,{align:"center",justify:"space-between"},{default:e(()=>[o("span",null,i(t(n)("displayAdminProfileTypeAtRegistration")),1),a(v,{value:t(s).displayAdminProfileType,"onUpdate:value":l[2]||(l[2]=c=>t(s).displayAdminProfileType=c),"checked-value":"1","unchecked-value":"0",disabled:!parseInt(t(s).allowRegistration),size:"small"},{checked:e(()=>l[11]||(l[11]=[o("div",{class:"w-6"},null,-1)])),unchecked:e(()=>l[12]||(l[12]=[o("div",{class:"w-6"},null,-1)])),_:1},8,["value","disabled"])]),_:1})]),_:1})]),_:1}),a(m,null,{default:e(()=>[a(r,{class:"w-full h-full",size:"small"},{default:e(()=>[a(d,{align:"center",justify:"space-between"},{default:e(()=>[o("span",null,i(t(n)("adminProfileTypeTitle")),1),o("div",Te,[a(M,{modelValue:t(s).adminProfileTypeLabel,"onUpdate:modelValue":l[3]||(l[3]=c=>t(s).adminProfileTypeLabel=c),placeholder:t(n)("admin"),disabled:!(parseInt(t(s).displayAdminProfileType)&&parseInt(t(s).allowRegistration)),size:"tiny",sync:""},null,8,["modelValue","placeholder","disabled"])])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),t(J)?(D(),he("section",Ce,[a(r,{hoverable:"",embedded:""},{header:e(()=>[y(i(t(n)("pathsAndHosting")),1)]),default:e(()=>[a(P,{cols:"1 ",responsive:"screen","x-gap":12,"y-gap":12},{default:e(()=>[a(m,null,{default:e(()=>[a(r,{class:"w-full h-full",size:"small"},{default:e(()=>[a(d,{align:"center",justify:"space-between"},{default:e(()=>[o("span",null,i(t(n)("adminAccessBasePath")),1),a(I,{value:t(s).basePath,placeholder:"creopse",type:"text",class:R(t(C)?"!w-full":"!w-[400px]"),"onUpdate:value":l[4]||(l[4]=c=>t(s).basePath=t(E)(c))},{prefix:e(()=>[o("span",Se,i(t(F)?.apiBaseUrl)+"/ ",1)]),suffix:e(()=>l[13]||(l[13]=[o("span",{class:"text-gray"},"/",-1)])),_:1},8,["value","class"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])):ke("",!0)]),_:1},8,["tab"]),a(j,{name:"translation",tab:t(n)("translation")},{default:e(()=>[o("section",Ie,[a(r,{hoverable:"",embedded:""},{header:e(()=>[y(i(t(n)("googleTranslate")),1)]),default:e(()=>[a(P,{cols:"1 ",responsive:"screen","x-gap":12,"y-gap":12},{default:e(()=>[a(m,null,{default:e(()=>[a(r,{class:"w-full h-full",size:"small"},{default:e(()=>[a(d,{align:"center",justify:"space-between"},{default:e(()=>[o("span",null,i(t(n)("apiKey")),1),a(I,{value:t(s)["translation.googleTranslate.apiKey"],"onUpdate:value":l[5]||(l[5]=c=>t(s)["translation.googleTranslate.apiKey"]=c),type:"password",class:R(t(C)?"!w-full":"!w-[400px]")},null,8,["value","class"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),o("section",ze,[a(r,{hoverable:"",embedded:""},{header:e(()=>[y(i(t(n)("deepl")),1)]),default:e(()=>[a(P,{cols:"1",responsive:"screen","x-gap":12,"y-gap":12},{default:e(()=>[a(m,null,{default:e(()=>[a(r,{class:"w-full h-full",size:"small"},{default:e(()=>[a(d,{align:"center",justify:"space-between"},{default:e(()=>[o("span",null,i(t(n)("apiKey")),1),a(I,{value:t(s)["translation.deeplTranslate.apiKey"],"onUpdate:value":l[6]||(l[6]=c=>t(s)["translation.deeplTranslate.apiKey"]=c),type:"password",class:R(t(C)?"!w-full":"!w-[400px]")},null,8,["value","class"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])]),_:1},8,["tab"])]),_:1})]),_:1})}}});export{$e as default};
