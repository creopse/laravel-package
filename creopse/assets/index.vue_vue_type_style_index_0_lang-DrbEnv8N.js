import{i as C}from"./css-render_vue3-ssr-Vbotx5Ir.js";import{a as A}from"./index.vue_vue_type_script_setup_true_lang-BG9tDE2Y.js";import{M as f}from"./media-library-DmBw0Umg.js";import{w as T,c as k,o as R,G as I}from"./index-B2LlKIv2.js";import{P as B}from"./ckeditor_ckeditor5-core-Ck1E_gMX.js";import{B as E}from"./ckeditor_ckeditor5-ui-0Cf30f_5.js";import{A as F}from"./ckeditor_ckeditor5-alignment-D8Xo8PHS.js";import{A as U}from"./ckeditor_ckeditor5-autoformat-DxNplFCY.js";import{B as z,I as M,U as $,S as L,C as H,a as P,b as V}from"./ckeditor_ckeditor5-basic-styles-CdvduDHX.js";import{B as _}from"./ckeditor_ckeditor5-block-quote-5tRCTa7z.js";import"./ckeditor_ckeditor5-build-classic-ouvGTuiS.js";import{C as N}from"./ckeditor_ckeditor5-code-block-bJDqrm-K.js";import{C as D}from"./ckeditor_ckeditor5-editor-classic-CdE2lwAL.js";import{E as G}from"./ckeditor_ckeditor5-essentials-Bl_bnSYX.js";import{F as O}from"./ckeditor_ckeditor5-find-and-replace-aiFx64Qk.js";import{F as q,a as W}from"./ckeditor_ckeditor5-font-GQO9QB-V.js";import{H as Q}from"./ckeditor_ckeditor5-heading-R-UpdTfI.js";import{H as j}from"./ckeditor_ckeditor5-horizontal-line-D2589H9m.js";import{I as J,a as K,b as X,c as Y,d as Z,e as ee,f as te,g as oe}from"./ckeditor_ckeditor5-image-D5DHKXVp.js";import{I as ae}from"./ckeditor_ckeditor5-indent-CqtsNUsR.js";import{L as le}from"./ckeditor_ckeditor5-link-BRDNekc1.js";import{L as ie,T as re}from"./ckeditor_ckeditor5-list-BxPI1Vmp.js";import{M as ne}from"./ckeditor_ckeditor5-media-embed-D6W1AFQ_.js";import{R as se}from"./ckeditor_ckeditor5-remove-format-qUofcHc4.js";import{S as de}from"./ckeditor_ckeditor5-source-editing-DnIrdIC5.js";import{S as me,a as ue}from"./ckeditor_ckeditor5-special-characters-BNeSgNzV.js";import{T as pe,a as ce,b as fe,c as ge,d as be}from"./ckeditor_ckeditor5-table-C4DnhPcz.js";import{c as he}from"./ckeditor_ckeditor5-typing-A9cCj5t0.js";import{B as ye}from"./ckeditor_ckeditor5-upload-DfswkLDo.js";import{a as Ce}from"./axios-ChUjVlRB.js";import{u as Ie}from"./vue-i18n-CWrb4u3f.js";const{t:ve}=T.global;class Se extends B{init(){this.editor.ui.componentFactory.add("addCreopseMedia",e=>{const t=new E(e);return t.set({label:ve("addMedia"),withText:!0,tooltip:!0}),t.on("execute",()=>{const n=new Event("add-creopse-media");document.dispatchEvent(n)}),t})}}const{t:h}=T.global;class Te extends B{init(){const a=this.editor;a.ui.componentFactory.add("fullScreen",e=>{const t=new E(e);let n=0;return t.set({label:h("fullscreen"),withText:!0,tooltip:!0}),t.on("execute",()=>{n==1?(a.sourceElement.nextElementSibling.removeAttribute("id"),document.body.removeAttribute("id"),t.set({label:h("fullscreen"),withText:!0,tooltip:!0}),n=0):(a.sourceElement.nextElementSibling.setAttribute("id","fullscreeneditor"),document.body.setAttribute("id","fullscreenoverlay"),t.set({label:h("normalSize"),withText:!0,tooltip:!0}),n=1)}),t})}}class Be{loader;constructor(a){this.loader=a}async upload(){return this.loader.file.then(a=>new Promise((e,t)=>{this._sendRequest(e,t,a)}))}abort(){}async _sendRequest(a,e,t){const n=this.loader,p=I?.apiRequestHeaders,b=k();p&&(p.Authorization=`Bearer ${b.accessToken}`);const c=new FormData,s=await R(t,{maxSizeMB:1});c.append("file",s),c.append("folder","ck"),Ce.post(`${I?.apiUrl}/media-files/upload`,c,{headers:p,onUploadProgress:i=>{i.total!==void 0&&(n.uploadTotal=i.total,n.uploaded=i.loaded)}}).then(async i=>{const g=i.data;a({default:g.data.url})}).catch(i=>{e(i)})}}function Ee(m){m.plugins.get("FileRepository").createUploadAdapter=a=>new Be(a)}const{defineComponent:we}=await C("vue"),{unref:u,resolveComponent:xe,createVNode:v,isRef:Ae,openBlock:ke,createElementBlock:Re}=await C("vue"),{computed:S,ref:Fe,inject:Ue,onMounted:ze,onUnmounted:Me}=await C("vue"),y="{{BASE_URL}}",pt=we({__name:"index",props:{modelValue:{default:""},disabled:{type:Boolean,default:!1},tagName:{default:"div"},placeholder:{default:""},lang:{default:null},minHeight:{default:100},shouldNotGroupWhenFull:{type:Boolean,default:!0},toolbarItems:{default:()=>["heading","|","bold","italic","underline","strikethrough","code","codeBlock","subscript","superscript","removeFormat","selectAll","specialCharacters","|","fontSize","fontFamily","fontColor","fontBackgroundColor","|","horizontalLine","blockQuote","bulletedList","numberedList","todoList","alignment","|","outdent","indent","|","link","uploadImage","insertTable","mediaEmbed","findAndReplace","|","undo","redo","|","sourceEditing","addCreopseMedia","fullScreen"]},imageToolbarItems:{default:()=>["imageStyle:inline","imageStyle:block","imageStyle:side","|","imageStyle:alignLeft","imageStyle:alignCenter","imageStyle:alignRight","|","resizeImage:25","resizeImage:50","resizeImage:75","resizeImage:original","|","toggleImageCaption","imageTextAlternative"]},tableContentToolbar:{default:()=>["toggleTableCaption","tableColumn","tableRow","mergeTableCells"]},enableUpload:{type:Boolean,default:!1}},emits:["update:modelValue","ready","focus","blur","destroy"],setup(m,{emit:a}){const e=m,t=a,n=D,{locale:p,t:b}=Ie(),c=S(()=>{const d={language:e.lang||p.value,placeholder:e.placeholder,plugins:[G,U,z,M,$,L,H,P,V,_,Q,J,K,X,Y,Z,ee,te,oe,le,ie,F,pe,ce,fe,ge,be,ne,ae,he,N,O,q,W,j,re,se,de,me,ue,Se,Te],extraPlugins:[],toolbar:{items:e.toolbarItems,shouldNotGroupWhenFull:e.shouldNotGroupWhenFull},image:{toolbar:e.imageToolbarItems,resizeOptions:[{name:"resizeImage:original",value:null,icon:"original"},{name:"resizeImage:25",value:"25",icon:"small"},{name:"resizeImage:50",value:"50",icon:"medium"},{name:"resizeImage:75",value:"75",icon:"large"}]},table:{contentToolbar:e.tableContentToolbar}};return e.enableUpload?d.extraPlugins.push(Ee):d.plugins.push(ye),d});S(()=>typeof e.minHeight=="number"?`${e.minHeight}px`:e.minHeight);const s=Fe(!1),i=Ue("appConfig"),g=()=>{s.value=!0};ze(()=>{document.addEventListener("add-creopse-media",g)}),Me(()=>{document.removeEventListener("add-creopse-media",g)});const w=d=>{if(d){let o=e.modelValue||"";d.forEach(l=>{l.type==f.IMAGE&&(o+=`<p><img src="${l.url}" /></p>`),l.type==f.DOCUMENT&&(o+=`<p><a href="${l.url}">${l.name}</a></p>`),l.type==f.AUDIO&&(o+=`<p style="text-align:center">[audio]${l.url}[/audio]</p>`),l.type==f.VIDEO&&(o+=`<p style="text-align:center">[video]${l.url}[/video]</p>`),l.type==f.OTHER&&(o+=`<p><a href="${l.url}">${l.name}</a></p>`)}),t("update:modelValue",o?.replace(new RegExp(`${i?.apiBaseUrl}/storage`,"g"),y))}s.value=!1};return(d,o)=>{const l=xe("ckeditor"),x=A;return ke(),Re("section",null,[v(l,{editor:u(n),"tag-name":e.tagName,disabled:e.disabled,config:u(c),"model-value":e.modelValue?.replace(new RegExp(y,"g"),`${u(i)?.apiBaseUrl}/storage`),class:"page-content-editor",onInput:o[0]||(o[0]=r=>t("update:modelValue",r?.replace(new RegExp(`${u(i)?.apiBaseUrl}/storage`,"g"),y))),onDestroy:o[1]||(o[1]=r=>t("destroy",r)),onReady:o[2]||(o[2]=r=>t("ready",r)),onFocus:o[3]||(o[3]=r=>t("focus",r)),onBlur:o[4]||(o[4]=r=>t("blur",r))},null,8,["editor","tag-name","disabled","config","model-value"]),v(x,{show:u(s),"onUpdate:show":o[5]||(o[5]=r=>Ae(s)?s.value=r:null),title:u(b)("add"),"selection-type":"item","selection-multiple":"",onSubmit:w},null,8,["show","title"])])}}});export{pt as _};
