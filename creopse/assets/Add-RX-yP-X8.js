import{i as E}from"./ckeditor_ckeditor5-vue-CmLqe3wy.js";import{_ as P}from"./PageLayout.vue_vue_type_script_setup_true_lang-B_VUtTLL.js";import{I as $}from"./iconify_vue-DXPEksg3.js";import{c as H,Z as J,R as W}from"./main-FI4nmu4j.js";import{a as Y}from"./axios-DeS043Oz.js";import{u as Z,p as G,l as K,a4 as Q,a5 as X,h as ee,m as ne,J as oe,q as te,B as se}from"./naive-ui-dfg6Ko-R.js";import{u as ae}from"./vue-i18n-B92nPylK.js";const{defineComponent:le}=await E("vue"),{unref:o,resolveComponent:be,createVNode:t,withCtx:n,toDisplayString:r,createTextVNode:F,openBlock:d,createBlock:V,createCommentVNode:ce,createElementVNode:L,createElementBlock:m}=await E("vue"),ie={style:{"margin-bottom":"12px"}},re={key:1,class:"text-xs"},ue={key:3,class:"text-xs"},de={key:4,class:"text-xs"},_e={key:5,class:"text-xs"},{defineComponent:pe,ref:T,inject:fe,onMounted:me,onUnmounted:he}=await E("vue"),xe=pe({name:W.MEDIA_LIBRARY.NAME+"Add"}),Ae=le({...xe,setup(ge){const{t:s}=ae(),h=Z(),x=G(),g=T(),y=[],c=T([]),C=T(!1),M=H(),I=fe("appConfig"),v=I?.apiRequestHeaders;v&&(v.Authorization=`Bearer ${M.accessToken}`);const R=async()=>{g.value.submit()},z=()=>{g.value?.clear(),c.value=[]},D=e=>{const i=e.file.file?.name.split(".").pop();return i&&y.map(u=>u.toLowerCase()).includes(i.toLowerCase())?(h.error(s("fileTypeNotAllowed")),!1):!0},U=e=>{c.value=e.fileList},j=({file:e})=>e,q=()=>{},O=async({file:e,data:l,headers:i,action:u,onFinish:f,onError:w,onProgress:k})=>{const _=new FormData;l&&Object.keys(l).forEach(a=>{_.append(a,l[a])});const p=e.file,B=p?.name.split(".").pop(),N=p?.name.replace("."+B,""),b=await J(p,{maxSizeMB:1});_.append("file",b,N),C.value=!0,x.start(),Y.post(u,_,{headers:i,onUploadProgress:a=>{if(a.total!==void 0){const A=Math.round(a.loaded*100/a.total);k({percent:A})}}}).then(async()=>{f();const a=c.value.findIndex(A=>A.id===e.id);a!==-1&&c.value.splice(a,1),h.success(s("success")),x.finish(),C.value=!1}).catch(a=>{h.error(s("anErrorOccurred")),w(),x.finish(),C.value=!1})},S=console.warn;return me(()=>{console.warn=e=>{typeof e=="string"&&e.includes('Non-function value encountered for slot "default"')||S(e)}}),he(()=>{console.warn=S}),(e,l)=>{const i=$,u=ee,f=se,w=te,k=ne,_=oe,p=X,B=Q,N=K,b=P;return d(),V(b,null,{"header-extra":n(()=>[o(c).length?(d(),V(w,{key:0,align:"center"},{default:n(()=>[t(f,{secondary:"",disabled:o(c).length==0,onClick:z},{icon:n(()=>[t(u,null,{default:n(()=>[t(i,{icon:"carbon:close"})]),_:1})]),default:n(()=>[F(" "+r(o(s)("clearList")),1)]),_:1},8,["disabled"]),t(f,{secondary:"",type:"primary",disabled:o(c).length==0,onClick:R},{default:n(()=>[F(r(o(s)("launchImport")),1)]),_:1},8,["disabled"])]),_:1})):ce("",!0)]),default:n(()=>[t(N,{show:!1},{default:n(()=>[t(B,{ref_key:"upload",ref:g,multiple:"","directory-dnd":"","list-type":"image",max:q(),"default-upload":!1,headers:o(v),"custom-request":O,action:o(I)?.apiUrl+"/media-files/upload",onBeforeUpload:D,onChange:U,onFinish:j},{default:n(()=>[t(p,{class:"h-[250px] flex flex-col items-center justify-center"},{default:n(()=>[L("div",ie,[t(u,{size:"48",depth:3},{default:n(()=>[t(i,{icon:"carbon:upload"})]),_:1})]),t(k,{style:{"font-size":"16px"}},{default:n(()=>[F(r(o(s)("uploadAreaTitle")),1)]),_:1}),t(_,{depth:"3",class:"mt-4"},{default:n(()=>[(d(),m("span",re,r(o(s)("noLimitToTheNumberOfFilesToSend")),1)),l[0]||(l[0]=L("br",null,null,-1)),(d(),m("span",ue,r(o(s)("noLimitToTheSizeOfFilesToSend")),1)),l[1]||(l[1]=L("br",null,null,-1)),y.length?(d(),m("span",de,r(o(s)("extensionsAreNotAllowed",[y.join(", ")])),1)):(d(),m("span",_e,r(o(s)("allFileExtensionsAreAllowed")),1))]),_:1})]),_:1})]),_:1},8,["max","headers","action"])]),_:1})]),_:1})}}});export{Ae as default};
