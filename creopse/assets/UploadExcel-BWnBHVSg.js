import{i as k}from"./ckeditor_ckeditor5-vue-CmLqe3wy.js";import{r as I,u as c}from"./xlsx-Be0yiQ5A.js";import{_ as P}from"./fawmi_vue-google-maps-yyESU4s0.js";import{B as T}from"./naive-ui-BrWbllCz.js";import{u as R}from"./vue-i18n-B92nPylK.js";const{createElementVNode:h,unref:p,toDisplayString:y,createTextVNode:D,resolveComponent:J,withCtx:j,createVNode:A,openBlock:H,createElementBlock:O}=await k("vue"),{ref:f}=await k("vue"),z={__name:"UploadExcel",props:{beforeUpload:{type:Function,default:null},onSuccess:{type:Function,default:null}},setup(N){const l=N,{t:d}=R(),s=f(!1),u=f(null),_=f({header:null,results:null});function w({header:e,results:t}){_.value={header:e,results:t},l.onSuccess&&l.onSuccess(_.value)}function S(e){if(e.stopPropagation(),e.preventDefault(),s.value)return;const t=e.dataTransfer.files;if(t.length!==1)return;const o=t[0];if(!U(o))return!1;g(o),e.stopPropagation(),e.preventDefault()}function m(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"}function b(){u.value.click()}function C(e){const o=e.target.files[0];o&&g(o)}function g(e){if(u.value=null,!l.beforeUpload){x(e);return}l.beforeUpload(e)&&x(e)}function x(e){return s.value=!0,new Promise((t,o)=>{const n=new FileReader;n.onload=i=>{const r=i.target.result,a=I(r,{type:"array"}),B=a.SheetNames[0],v=a.Sheets[B],V=E(v),F=c.sheet_to_json(v);w({header:V,results:F}),s.value=!1,t()},n.readAsArrayBuffer(e)})}function E(e){const t=[],o=c.decode_range(e["!ref"]);let n;const i=o.s.r;for(n=o.s.c;n<=o.e.c;++n){const r=e[c.encode_cell({c:n,r:i})];let a="UNKNOWN "+n;r&&r.t&&(a=c.format_cell(r)),t.push(a)}return t}function U(e){return/\.(xlsx|xls|csv)$/.test(e.name)}return(e,t)=>{const o=T;return H(),O("div",null,[h("input",{ref_key:"excelUploadInput",ref:u,class:"excel-upload-input",type:"file",accept:".xlsx, .xls",onChange:C},null,544),h("div",{class:"drop",onDrop:S,onDragover:m,onDragenter:m},[D(y(p(d)("dropExcelFileHereOr"))+" ",1),A(o,{loading:p(s),secondary:"",style:{"margin-left":"16px"},size:"small",type:"primary",onClick:b},{default:j(()=>[D(y(p(d)("browse")),1)]),_:1},8,["loading"])],32)])}}},L=P(z,[["__scopeId","data-v-2d320bd4"]]);export{L as _};
