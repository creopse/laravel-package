import{_ as V}from"./AuthLayout-f7765e62.js";import{d as O,u as T,R as h,_ as L,e as F}from"./index-bdcc2b50.js";import{p as M}from"./password-strength-options-220cc0dc.js";import{e as B}from"./check-password-strength-48654609.js";import{R as G}from"./response-error-code-87d1097e.js";import{a as H,u as U}from"./vue-router-e670704e.js";import{_ as W}from"./validator-c0254ba9.js";import{d as E,b as j,o as R,P as k,aO as i,Y as a,a as m,Q as z,l as Q}from"./vue_runtime-core-4f5fb440.js";import{u as Y}from"./vue-i18n-84a05dd5.js";import{b as $,E as J,F as K,_ as X,G as Z,L as oo}from"./naive-ui-0caedd43.js";import{r as v,u as o}from"./vue_reactivity-852d8377.js";import{t as eo}from"./vue_shared-7dcc3b7f.js";import"./iconify_vue-6750bec6.js";import"./vue_runtime-dom-c0cb2070.js";import"./unhead_vue-71da354f.js";import"./unhead-a4367481.js";import"./hookable-e7fd869b.js";import"./unhead_dom-b5f3dd9b.js";import"./unhead_shared-56c99682.js";import"./fawmi_vue-google-maps-52673af8.js";import"./googlemaps_markerclusterer-b718980f.js";import"./fast-deep-equal-1db9e660.js";import"./axios-96fb5abd.js";import"./process-93c0ea83.js";import"./supercluster-6504d485.js";import"./kdbush-ac640998.js";import"./browser-image-compression-a3ab6596.js";import"./lodash-a9971f22.js";import"./pinia-5dd13ed8.js";import"./vue-demi-71ba0ef2.js";import"./moment-ea709ccd.js";import"./slugify-ce681755.js";import"./vueuse_core-e3c6c607.js";import"./vueuse_shared-d1f69174.js";import"./parse-domain-626a676d.js";import"./is-ip-33949ce5.js";import"./ip-regex-e6f9cbd8.js";import"./super-regex-a8a38319.js";import"./function-timeout-8f7724f6.js";import"./clone-regexp-3bc3d90c.js";import"./is-regexp-5fa9e804.js";import"./ckeditor_ckeditor5-vue-13667b6e.js";import"./vue-83614a91.js";import"./strip-json-comments-680ed425.js";import"./vue-draggable-next-d31a77b2.js";import"./pinia_colada-25af8b56.js";import"./vue-shepherd-6780f0ef.js";import"./shepherd.js-8a3687f6.js";import"./vue-tel-input-40ca5c5d.js";import"./vue3-map-chart-612bd6db.js";import"./crypto-js-eb39eca1.js";import"./pinia-persistence-plugin-50ba422c.js";/* empty css                    *//* empty css               *//* empty css                                      */import"./date-fns-eed65714.js";import"./seemly-5e1e6f41.js";import"./vueuc-b49649f7.js";import"./evtd-b614532e.js";import"./css-render_vue3-ssr-b91bc731.js";import"./vooks-3c892a1c.js";import"./vdirs-b0483831.js";import"./juggle_resize-observer-41516555.js";import"./css-render-9b607bf6.js";import"./emotion_hash-8a8e73f6.js";import"./lodash-es-a215867d.js";import"./treemate-25c27bff.js";import"./date-fns-tz-6c300683.js";import"./async-validator-dc9a4891.js";import"./css-render_plugin-bem-9dde7ffe.js";import"./intlify_shared-f7876323.js";import"./intlify_core-base-c423e336.js";import"./intlify_message-compiler-48af4dac.js";const ro={class:"container h-full"},to={class:"flex justify-center items-center flex-wrap h-full g-6 text-gray-800"},so={class:"md:w-8/12 lg:w-5/12 xl:w-4/12 2xl:w-3/12 sm:w-full"},ao={class:"flex justify-center mb-6"},io=["src","alt"],lo=E({name:h.ADD_NEW_PASSWORD.NAME}),xe=E({...lo,setup(po){const{t:r}=Y(),u=H(),b=U(),y=$(),A=O(),{request:S}=F(),{displayFormErrors:q,logo:x}=T(),g=v(!1),C=v(null),t=v({email:"",password:"",passwordConfirmation:""}),P={email:[{required:!0,message:r("fillRequired")},{trigger:["input"],validator(p,e){return e&&!W.isEmail(e)?new Error(r("invalidEmail")):!0}}],password:[{required:!0,message:r("fillRequired")},{trigger:["input"],validator(p,e){return e&&["too-weak"].includes(B.passwordStrength(e,M).value)?new Error(r("passwordTooWeak")):!0}}],passwordConfirmation:[{required:!0,message:r("fillRequired")},{trigger:["input"],validator(p,e){return e&&e!==t.value.password?new Error(r("nonCompliantPassword")):!0}}]},N=p=>{var e;p.preventDefault(),(e=C.value)==null||e.validate(async n=>{var l,d,c,_,f,w;if(!n){g.value=!0;const s=await S({url:"/auth/reset-password",method:"post",data:{email:t.value.email,token:u.params.token,password:t.value.password,passwordConfirmation:t.value.passwordConfirmation}});if(s.failure&&s.error)switch((c=(d=(l=s.error)==null?void 0:l.response)==null?void 0:d.data)==null?void 0:c.errorCode){case G.FORM_INVALID_DATA:q((w=(f=(_=s.error)==null?void 0:_.response)==null?void 0:f.data)==null?void 0:w.data);break;default:y.error(r("passwordResetFailure"),{closable:!0,duration:5e3})}else y.success(r("passwordResetSuccess"),{closable:!0,duration:1e4}),b.replace(h.LOGIN.PATH);g.value=!1}})},D="Creopse",I=A.getSettingValue("disableInstaller","boolean");return j(()=>{u.params.token||b.replace(h.LOGIN.PATH),t.value.email=u.query.email}),(p,e)=>{const n=J,l=K,d=X,c=Z,_=oo,f=L,w=V;return R(),k(w,{"display-server-alerts":!o(I)},{default:i(()=>[a(f,{name:"slide-fade",appear:""},{default:i(()=>[m("div",ro,[m("div",to,[m("div",so,[a(_,{size:"small",class:"w-full"},{default:i(()=>[m("div",ao,[m("img",{src:o(x),class:"w-54",alt:o(D)},null,8,io)]),a(c,{ref_key:"formRef",ref:C,model:o(t),rules:P,"show-label":!1,"show-require-mark":!1,size:"medium"},{default:i(()=>[o(u).query.email?z("",!0):(R(),k(l,{key:0,label:o(r)("addressEmail"),path:"email"},{default:i(()=>[a(n,{value:o(t).email,"onUpdate:value":e[0]||(e[0]=s=>o(t).email=s),placeholder:o(r)("addressEmail"),class:"w-full"},null,8,["value","placeholder"])]),_:1},8,["label"])),a(l,{label:o(r)("newPassword"),path:"password"},{default:i(()=>[a(n,{value:o(t).password,"onUpdate:value":e[1]||(e[1]=s=>o(t).password=s),placeholder:o(r)("newPassword"),"show-password-on":"mousedown",type:"password",class:"w-full"},null,8,["value","placeholder"])]),_:1},8,["label"]),a(l,{label:o(r)("confirmPassword"),path:"passwordConfirmation"},{default:i(()=>[a(n,{value:o(t).passwordConfirmation,"onUpdate:value":e[2]||(e[2]=s=>o(t).passwordConfirmation=s),placeholder:o(r)("confirmPassword"),disabled:!o(t).password,"show-password-on":"mousedown",type:"password",class:"w-full"},null,8,["value","placeholder","disabled"])]),_:1},8,["label"]),a(d,{block:"",type:"primary",loading:o(g),onClick:N},{default:i(()=>[Q(eo(o(r)("save")),1)]),_:1},8,["loading"])]),_:1},8,["model"])]),_:1})])])])]),_:1})]),_:1},8,["display-server-alerts"])}}});export{xe as default};
