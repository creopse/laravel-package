import{i as m}from"./ckeditor_ckeditor5-vue-CmLqe3wy.js";import{_ as A}from"./AuthLayout.vue_vue_type_script_setup_true_lang-CC1-ihea.js";import{I as E}from"./iconify_vue-DXPEksg3.js";import{p as I}from"./password-strength-options-ByZgG3BK.js";import{d as V,l as D,R as p}from"./main-BRU0R4jH.js";import{p as x}from"./check-password-strength-DpJr94ZL.js";import{a as B,u as T}from"./vue-router-DjpI5axN.js";import{_ as O}from"./validator-DC79P2ge.js";import{a as U,b as L,c as W,B as G,h as H}from"./naive-ui-CqiIy5K7.js";import{u as M}from"./vue-i18n-B92nPylK.js";const{defineComponent:z}=await m("vue"),{unref:e,resolveComponent:ie,createVNode:r,withCtx:t,openBlock:f,createBlock:w,createCommentVNode:$,toDisplayString:j,createTextVNode:F}=await m("vue"),{defineComponent:J,ref:v,onMounted:K}=await m("vue"),Q=J({name:p.ADD_NEW_PASSWORD.NAME}),ue=z({...Q,setup(X){const{t:a}=M(),i=B(),c=T(),{getSettingValue:g}=V(),{mutate:b,isPending:C}=D(),_=v(null),s=v({email:"",password:"",passwordConfirmation:""}),h={email:[{required:!0,message:a("fillRequired")},{trigger:["input"],validator(n,o){return o&&!O.isEmail(o)?new Error(a("invalidEmail")):!0}}],password:[{required:!0,message:a("fillRequired")},{trigger:["input"],validator(n,o){return o&&["too-weak"].includes(x(o,I).value)?new Error(a("passwordTooWeak")):!0}}],passwordConfirmation:[{required:!0,message:a("fillRequired")},{trigger:["input"],validator(n,o){return o&&o!==s.value.password?new Error(a("nonCompliantPassword")):!0}}]},y=n=>{n.preventDefault(),_.value?.validate(async o=>{o||b({email:s.value.email,token:i.params.token,password:s.value.password,passwordConfirmation:s.value.passwordConfirmation},{onSuccess:()=>{c.replace(p.LOGIN.PATH)}})})},k=g("disableInstaller","boolean");return K(()=>{i.params.token||c.replace(p.LOGIN.PATH),s.value.email=i.query.email}),(n,o)=>{const u=W,d=L,P=E,N=H,R=G,S=U,q=A;return f(),w(q,{title:e(a)("setNewPassword"),subtitle:e(a)("chooseSecurePassToAccessUrAccount"),"display-server-alerts":!e(k)},{default:t(()=>[r(S,{ref_key:"formRef",ref:_,model:e(s),rules:h,"show-label":!1,"show-require-mark":!1,size:"medium"},{default:t(()=>[e(i).query.email?$("",!0):(f(),w(d,{key:0,label:e(a)("addressEmail"),path:"email"},{default:t(()=>[r(u,{value:e(s).email,"onUpdate:value":o[0]||(o[0]=l=>e(s).email=l),placeholder:e(a)("addressEmail"),class:"w-full"},null,8,["value","placeholder"])]),_:1},8,["label"])),r(d,{label:e(a)("newPassword"),path:"password"},{default:t(()=>[r(u,{value:e(s).password,"onUpdate:value":o[1]||(o[1]=l=>e(s).password=l),placeholder:e(a)("newPassword"),"show-password-on":"mousedown",type:"password",class:"w-full"},null,8,["value","placeholder"])]),_:1},8,["label"]),r(d,{label:e(a)("confirmPassword"),path:"passwordConfirmation"},{default:t(()=>[r(u,{value:e(s).passwordConfirmation,"onUpdate:value":o[2]||(o[2]=l=>e(s).passwordConfirmation=l),placeholder:e(a)("confirmPassword"),disabled:!e(s).password,"show-password-on":"mousedown",type:"password",class:"w-full"},null,8,["value","placeholder","disabled"])]),_:1},8,["label"]),r(R,{block:"",secondary:"",type:"primary",loading:e(C),onClick:y},{icon:t(()=>[r(N,null,{default:t(()=>[r(P,{icon:"carbon:save"})]),_:1})]),default:t(()=>[F(" "+j(e(a)("save")),1)]),_:1},8,["loading"])]),_:1},8,["model"])]),_:1},8,["title","subtitle","display-server-alerts"])}}});export{ue as default};
