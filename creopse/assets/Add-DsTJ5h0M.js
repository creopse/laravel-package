import{i as E}from"./ckeditor_ckeditor5-vue-D9YIFk5Z.js";import{_ as P}from"./PageLayout.vue_vue_type_script_setup_true_lang-Bbo6kS_9.js";import{I as $}from"./iconify_vue-DK9FHL8l.js";import{c as H,N as K,R as Q}from"./index-5sSKf-sJ.js";import{a as W}from"./axios-ELK0WRh1.js";import{a as Y,u as G,o as J,ad as X,ae as Z,q as ee,K as ne,Q as oe,O as te,B as se}from"./naive-ui-U3LV0D3Q.js";import{u as ae}from"./vue-i18n-DGGON2e6.js";const{defineComponent:le}=await E("vue"),{unref:o,resolveComponent:be,createVNode:t,withCtx:n,toDisplayString:r,createTextVNode:F,openBlock:u,createBlock:V,createCommentVNode:ce,createElementVNode:L,createElementBlock:m}=await E("vue"),ie={style:{"margin-bottom":"12px"}},re={key:1,class:"text-xs"},de={key:3,class:"text-xs"},ue={key:4,class:"text-xs"},_e={key:5,class:"text-xs"},{defineComponent:pe,ref:T,inject:fe,onMounted:me,onUnmounted:he}=await E("vue"),xe=pe({name:Q.MEDIA_LIBRARY.NAME+"Add"}),Ae=le({...xe,setup(ge){const{t:s}=ae(),h=Y(),x=G(),g=T(),y=[],c=T([]),C=T(!1),M=H(),I=fe("appConfig"),v=I?.apiRequestHeaders;v&&(v.Authorization=`Bearer ${M.accessToken}`);const R=async()=>{g.value.submit()},z=()=>{g.value?.clear(),c.value=[]},D=e=>{const i=e.file.file?.name.split(".").pop();return i&&y.map(d=>d.toLowerCase()).includes(i.toLowerCase())?(h.error(s("fileTypeNotAllowed")),!1):!0},O=e=>{c.value=e.fileList},U=({file:e})=>e,j=()=>{},q=async({file:e,data:l,headers:i,action:d,onFinish:f,onError:w,onProgress:N})=>{const _=new FormData;l&&Object.keys(l).forEach(a=>{_.append(a,l[a])});const p=e.file,k=p?.name.split(".").pop(),B=p?.name.replace("."+k,""),b=await K(p,{maxSizeMB:1});_.append("file",b,B),C.value=!0,x.start(),W.post(d,_,{headers:i,onUploadProgress:a=>{if(a.total!==void 0){const A=Math.round(a.loaded*100/a.total);N({percent:A})}}}).then(async()=>{f();const a=c.value.findIndex(A=>A.id===e.id);a!==-1&&c.value.splice(a,1),h.success(s("success")),x.finish(),C.value=!1}).catch(a=>{h.error(s("anErrorOccurred")),w(),x.finish(),C.value=!1})},S=console.warn;return me(()=>{console.warn=e=>{typeof e=="string"&&e.includes('Non-function value encountered for slot "default"')||S(e)}}),he(()=>{console.warn=S}),(e,l)=>{const i=$,d=ee,f=se,w=te,N=ne,_=oe,p=Z,k=X,B=J,b=P;return u(),V(b,null,{"header-extra":n(()=>[o(c).length?(u(),V(w,{key:0,align:"center"},{default:n(()=>[t(f,{secondary:"",disabled:o(c).length==0,onClick:z},{icon:n(()=>[t(d,null,{default:n(()=>[t(i,{icon:"carbon:close"})]),_:1})]),default:n(()=>[F(" "+r(o(s)("clearList")),1)]),_:1},8,["disabled"]),t(f,{secondary:"",type:"primary",disabled:o(c).length==0,onClick:R},{default:n(()=>[F(r(o(s)("launchImport")),1)]),_:1},8,["disabled"])]),_:1})):ce("",!0)]),default:n(()=>[t(B,{show:!1},{default:n(()=>[t(k,{ref_key:"upload",ref:g,multiple:"","directory-dnd":"","list-type":"image",max:j(),"default-upload":!1,headers:o(v),"custom-request":q,action:o(I)?.apiUrl+"/media-files/upload",onBeforeUpload:D,onChange:O,onFinish:U},{default:n(()=>[t(p,{class:"h-[250px] flex flex-col items-center justify-center"},{default:n(()=>[L("div",ie,[t(d,{size:"48",depth:3},{default:n(()=>[t(i,{icon:"carbon:upload"})]),_:1})]),t(N,{style:{"font-size":"16px"}},{default:n(()=>[F(r(o(s)("uploadAreaTitle")),1)]),_:1}),t(_,{depth:"3",class:"mt-4"},{default:n(()=>[(u(),m("span",re,r(o(s)("noLimitToTheNumberOfFilesToSend")),1)),l[0]||(l[0]=L("br",null,null,-1)),(u(),m("span",de,r(o(s)("noLimitToTheSizeOfFilesToSend")),1)),l[1]||(l[1]=L("br",null,null,-1)),y.length?(u(),m("span",ue,r(o(s)("extensionsAreNotAllowed",[y.join(", ")])),1)):(u(),m("span",_e,r(o(s)("allFileExtensionsAreAllowed")),1))]),_:1,__:[0,1]})]),_:1})]),_:1},8,["max","headers","action"])]),_:1})]),_:1})}}});export{Ae as default};
