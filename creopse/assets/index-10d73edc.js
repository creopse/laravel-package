import{_ as G}from"./AuthLayout-27b03901.js";import{u as L,a as M,b as F,d as B,c as $,R as w,g as j,_ as z,e as W}from"./index-fa85a2bf.js";import{v as Y}from"./vue_runtime-dom-c0cb2070.js";import{p as J}from"./password-strength-options-220cc0dc.js";import{e as K}from"./check-password-strength-48654609.js";import{R as k}from"./response-error-code-87d1097e.js";import{u as Q}from"./vue-router-e670704e.js";import{_ as X}from"./validator-c0254ba9.js";import{d as E,w as Z,o as ee,P as te,aO as a,Y as o,a as u,v as re,l as T}from"./vue_runtime-core-4f5fb440.js";import{u as se}from"./vue-i18n-84a05dd5.js";import{b as oe,E as ae,H as le,I as ie,F as ne,_ as pe,G as me}from"./naive-ui-1f55be4a.js";import{r as b,u as e}from"./vue_reactivity-852d8377.js";import{t as C}from"./vue_shared-7dcc3b7f.js";import"./iconify_vue-6750bec6.js";import"./unhead_vue-71da354f.js";import"./unhead-a4367481.js";import"./hookable-e7fd869b.js";import"./unhead_dom-b5f3dd9b.js";import"./unhead_shared-56c99682.js";import"./fawmi_vue-google-maps-52673af8.js";import"./googlemaps_markerclusterer-b718980f.js";import"./fast-deep-equal-1db9e660.js";import"./axios-96fb5abd.js";import"./process-93c0ea83.js";import"./supercluster-6504d485.js";import"./kdbush-ac640998.js";import"./browser-image-compression-a3ab6596.js";import"./lodash-a9971f22.js";import"./pinia-5dd13ed8.js";import"./vue-demi-71ba0ef2.js";import"./moment-ea709ccd.js";import"./slugify-ce681755.js";import"./vueuse_core-e3c6c607.js";import"./vueuse_shared-d1f69174.js";import"./parse-domain-47d8e5e9.js";import"./is-ip-33949ce5.js";import"./ip-regex-e6f9cbd8.js";import"./super-regex-a8a38319.js";import"./function-timeout-8f7724f6.js";import"./clone-regexp-3bc3d90c.js";import"./is-regexp-5fa9e804.js";import"./ckeditor_ckeditor5-vue-13667b6e.js";import"./vue-83614a91.js";import"./strip-json-comments-680ed425.js";import"./vue-draggable-next-d31a77b2.js";import"./pinia_colada-25af8b56.js";import"./vue-shepherd-6780f0ef.js";import"./shepherd.js-8a3687f6.js";import"./vue-tel-input-40ca5c5d.js";import"./vue3-map-chart-612bd6db.js";import"./crypto-js-eb39eca1.js";import"./pinia-persistence-plugin-50ba422c.js";/* empty css                    *//* empty css               *//* empty css                                      */import"./date-fns-eed65714.js";import"./seemly-5e1e6f41.js";import"./vueuc-b49649f7.js";import"./evtd-b614532e.js";import"./css-render_vue3-ssr-b91bc731.js";import"./vooks-3c892a1c.js";import"./vdirs-b0483831.js";import"./juggle_resize-observer-41516555.js";import"./css-render-9b607bf6.js";import"./emotion_hash-8a8e73f6.js";import"./lodash-es-a215867d.js";import"./treemate-25c27bff.js";import"./date-fns-tz-6c300683.js";import"./async-validator-dc9a4891.js";import"./css-render_plugin-bem-9dde7ffe.js";import"./intlify_shared-f7876323.js";import"./intlify_core-base-c423e336.js";import"./intlify_message-compiler-48af4dac.js";const ue={class:"container h-full"},de={class:"flex justify-center items-center flex-wrap h-full g-6 text-gray-800"},ce={class:"md:w-8/12 lg:w-5/12 xl:w-4/12 2xl:w-3.5/12 sm:w-full"},fe={size:"small",class:"w-full"},_e={class:"flex justify-center mb-8"},we=["src","alt"],ge={class:"mt-2"},ve=E({name:w.REGISTER.NAME}),Lt=E({...ve,setup(he){const{t}=se(),g=Q(),R=oe(),{request:q}=W(),{displayFormErrors:x,logo:I}=L(),{userHasSuperAdminRole:D}=M(),{defaultPrefs:P}=F(),y=B(),d=$(),A=b(!1),S=b(null),s=b({lastname:"",firstname:"",email:"",password:"",passwordConfirmation:""}),H={lastname:[{required:!0,message:t("fillRequired")}],firstname:[{required:!0,message:t("fillRequired")}],email:[{required:!0,message:t("fillRequired")},{trigger:["input"],validator(n,r){return r&&!X.isEmail(r)?new Error(t("invalidEmail")):!0}}],password:[{required:!0,message:t("fillRequired")},{trigger:["input"],validator(n,r){return r&&["too-weak"].includes(K.passwordStrength(r,J).value)?new Error(t("passwordTooWeak")):!0}}],passwordConfirmation:[{required:!0,message:t("fillRequired")},{trigger:["input"],validator(n,r){return r&&r!==s.value.password?new Error(t("nonCompliantPassword")):!0}}]},N=async n=>{var r;n.preventDefault(),(r=S.value)==null||r.validate(async p=>{var m,c,v,f,h,_;if(p)R.error(t("invalidForm"));else{A.value=!0,d.userData=null;const l=await q({url:"/auth/register",method:"post",data:{...s.value,preferences:P.value}});if(l.failure&&l.error)switch((v=(c=(m=l.error)==null?void 0:m.response)==null?void 0:c.data)==null?void 0:v.errorCode){case k.AUTH_MISSING_DATA:R.error(t("missingData"));break;case k.FORM_INVALID_DATA:x((_=(h=(f=l.error)==null?void 0:f.response)==null?void 0:h.data)==null?void 0:_.data);break;default:R.error(t("registrationNotSuccessful"))}else l.success&&l.result?(d.userData=l.result.data.user,d.accessToken=l.result.data.accessToken,d.accessTokenDate=j()):g.replace(w.LOGIN.PATH),s.value={lastname:"",firstname:"",email:"",password:"",passwordConfirmation:""};A.value=!1}})},U="Creopse";Z(()=>d.isUserConnected,n=>{n&&(D()&&y.initDefaultSettings(),g.replace(w.HOME.PATH))},{immediate:!0});const V=y.getSettingValue("disableInstaller","boolean");y.getSettingValue("allowRegistration","boolean")||g.replace(w.LOGIN.PATH);const O=b(!0);return(n,r)=>{const p=ae,m=le,c=ie,v=ne,f=pe,h=me,_=z,l=G;return ee(),te(l,{"display-server-alerts":!e(V)},{default:a(()=>[o(_,{name:"slide-fade",appear:""},{default:a(()=>[u("div",ue,[u("div",de,[u("div",ce,[o(_,{appear:""},{default:a(()=>[re(u("div",fe,[u("div",_e,[u("img",{src:e(I),class:"w-54",alt:e(U)},null,8,we)]),o(h,{ref_key:"formRef",ref:S,model:e(s),rules:H,"show-label":!1,"show-require-mark":!1,size:"medium"},{default:a(()=>[o(c,{"x-gap":"12",span:24},{default:a(()=>[o(m,{span:12,label:e(t)("lastname"),path:"lastname"},{default:a(()=>[o(p,{value:e(s).lastname,"onUpdate:value":r[0]||(r[0]=i=>e(s).lastname=i),placeholder:e(t)("lastname"),class:"w-full"},null,8,["value","placeholder"])]),_:1},8,["label"]),o(m,{span:12,label:e(t)("firstname_s"),path:"firstname"},{default:a(()=>[o(p,{value:e(s).firstname,"onUpdate:value":r[1]||(r[1]=i=>e(s).firstname=i),placeholder:e(t)("firstname_s"),class:"w-full"},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),o(v,{label:e(t)("addressEmail"),path:"email"},{default:a(()=>[o(p,{value:e(s).email,"onUpdate:value":r[2]||(r[2]=i=>e(s).email=i),placeholder:e(t)("addressEmail"),class:"w-full"},null,8,["value","placeholder"])]),_:1},8,["label"]),o(c,{"x-gap":"12",span:24},{default:a(()=>[o(m,{span:12,label:e(t)("password"),path:"password"},{default:a(()=>[o(p,{value:e(s).password,"onUpdate:value":r[3]||(r[3]=i=>e(s).password=i),placeholder:e(t)("password"),"show-password-on":"mousedown",type:"password",class:"w-full"},null,8,["value","placeholder"])]),_:1},8,["label"]),o(m,{span:12,label:e(t)("confirmPassword"),path:"passwordConfirmation"},{default:a(()=>[o(p,{value:e(s).passwordConfirmation,"onUpdate:value":r[4]||(r[4]=i=>e(s).passwordConfirmation=i),placeholder:e(t)("confirmPassword"),disabled:!e(s).password,"show-password-on":"mousedown",type:"password",class:"w-full"},null,8,["value","placeholder","disabled"])]),_:1},8,["label"])]),_:1}),o(f,{type:"primary",loading:e(A),disabled:!e(s).lastname||!e(s).firstname||!e(s).email||!e(s).password||!e(s).passwordConfirmation,block:"",onClick:N},{default:a(()=>[T(C(e(t)("validate")),1)]),_:1},8,["loading","disabled"]),u("div",ge,[o(f,{block:"",tertiary:"",type:"default",onClick:r[5]||(r[5]=i=>e(g).push(e(w).LOGIN.PATH))},{default:a(()=>[T(C(e(t)("alreadyHaveAccount"))+" "+C(e(t)("toLogin")),1)]),_:1})])]),_:1},8,["model"])],512),[[Y,e(O)]])]),_:1})])])])]),_:1})]),_:1},8,["display-server-alerts"])}}});export{Lt as default};
