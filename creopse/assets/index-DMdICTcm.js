import{i as b}from"./ckeditor_ckeditor5-vue-D9YIFk5Z.js";import{_ as H}from"./AuthLayout.vue_vue_type_script_setup_true_lang-B3cX_48p.js";import{I as L}from"./iconify_vue-DK9FHL8l.js";import{u as U,c as M,d as K,i as $,R as d,P as G,j as O}from"./index-BictNpzW.js";import{a as j}from"./vue-router-JM7pifDK.js";import{_ as z}from"./validator-DwVK3abb.js";import{a as F,z as J,A as W,C as Q,J as X,B as Y,q as Z}from"./naive-ui-U3LV0D3Q.js";import{u as ee}from"./vue-i18n-DGGON2e6.js";const{defineComponent:te}=await b("vue"),{unref:e,resolveComponent:ye,withKeys:k,createVNode:n,withCtx:a,toDisplayString:c,createTextVNode:p,createElementVNode:w,Fragment:oe,openBlock:h,createElementBlock:se,createCommentVNode:ne,createBlock:ae}=await b("vue"),le={class:"flex items-center justify-between mt-2 mb-8 gap-8"},re={class:"flex items-center"},{defineComponent:ie,ref:T,watch:ue}=await b("vue"),me=ie({name:d.LOGIN.NAME}),ke=te({...me,setup(ce){const{t:o,locale:C}=ee(),{updateLocale:E}=U(),_=j(),R=F(),i=M(),{getSettingValue:v}=K(),{mutate:S,isPending:N}=$(),y=T(null),s=T({email:"",password:"",remember:!1}),A={email:[{required:!0,message:o("fillRequired")},{trigger:["input"],validator(u,t){return t&&!z.isEmail(t)?new Error(o("invalidEmail")):!0}}],password:[{required:!0,message:o("fillRequired")}]},f=async u=>{u.preventDefault(),y.value?.validate(async t=>{t||(i.userData=null,S(s.value,{onSuccess:m=>{s.value={email:"",password:"",remember:!1};const r=m.user;r?.profileType&&r?.profileType!==G.ADMIN?R.error(o("unableToLogin")):(i.userData=r,i.accessToken=m.accessToken,i.accessTokenDate=O())}}))})},x=v("disableInstaller","boolean"),D=v("allowRegistration","boolean");return ue(()=>i.isUserConnected,u=>{E(C.value,!1),u&&_.replace(d.HOME.PATH)},{immediate:!0}),(u,t)=>{const m=Q,r=W,I=X,g=Y,V=L,B=Z,P=J,q=H;return h(),ae(q,{title:`${e(o)("welcome")} !`,subtitle:e(o)("loginToGetStarted"),"display-server-alerts":!e(x)},{default:a(()=>[n(P,{ref_key:"formRef",ref:y,model:e(s),rules:A,"show-label":!1,"show-require-mark":!1,size:"medium"},{default:a(()=>[n(r,{label:e(o)("addressEmail"),path:"email"},{default:a(()=>[n(m,{value:e(s).email,"onUpdate:value":t[0]||(t[0]=l=>e(s).email=l),placeholder:e(o)("addressEmail"),class:"w-full",onKeyup:k(f,["enter"])},null,8,["value","placeholder"])]),_:1},8,["label"]),n(r,{span:12,label:e(o)("password"),path:"password"},{default:a(()=>[n(m,{value:e(s).password,"onUpdate:value":t[1]||(t[1]=l=>e(s).password=l),placeholder:e(o)("password"),"show-password-on":"mousedown",type:"password",class:"w-full",onKeyup:k(f,["enter"])},null,8,["value","placeholder"])]),_:1},8,["label"]),w("div",le,[w("div",re,[n(I,{checked:e(s).remember,"onUpdate:checked":t[2]||(t[2]=l=>e(s).remember=l)},{default:a(()=>[p(c(e(o)("rememberMe")),1)]),_:1},8,["checked"])]),n(g,{text:"",onClick:t[3]||(t[3]=l=>e(_).push(e(d).RESET_PASSWORD.PATH))},{default:a(()=>[p(c(e(o)("forgotPassword")),1)]),_:1})]),n(g,{secondary:"",type:"primary",loading:e(N),disabled:!e(s).email||!e(s).password,block:"",onClick:f},{icon:a(()=>[n(B,null,{default:a(()=>[n(V,{icon:"carbon:login"})]),_:1})]),default:a(()=>[p(" "+c(e(o)("toLogin")),1)]),_:1},8,["loading","disabled"]),e(D)?(h(),se(oe,{key:0},[t[5]||(t[5]=w("div",{class:"h-3"},null,-1)),n(g,{block:"",tertiary:"",type:"default",onClick:t[4]||(t[4]=l=>e(_).push(e(d).REGISTER.PATH))},{default:a(()=>[p(c(e(o)("dontHaveAccount"))+" "+c(e(o)("register")),1)]),_:1})],64)):ne("",!0)]),_:1},8,["model"])]),_:1},8,["title","subtitle","display-server-alerts"])}}});export{ke as default};
