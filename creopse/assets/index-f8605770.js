import{_ as G}from"./AuthLayout-faba6246.js";import{u as M,a as F,b as B,d as j,c as z,R as _,g as $,_ as W,e as Y}from"./index-916f1e45.js";import{v as J}from"./vue_runtime-dom-5ad5ecb0.js";import{p as K}from"./password-strength-options-220cc0dc.js";import{e as Q}from"./check-password-strength-48654609.js";import{R as k}from"./response-error-code-87d1097e.js";import{u as X}from"./vue-router-c3388b6d.js";import{_ as Z}from"./validator-c0254ba9.js";import{d as E,w as ee,o as te,P as re,aO as a,Y as o,a as u,v as se,l as T}from"./vue_runtime-core-273b5003.js";import{u as oe}from"./vue-i18n-0da1582b.js";import{b as ae,E as le,H as ie,I as ne,F as pe,_ as me,G as ue,L as de}from"./naive-ui-ab0dda7d.js";import{r as h,u as e}from"./vue_reactivity-852d8377.js";import{t as C}from"./vue_shared-7dcc3b7f.js";import"./iconify_vue-46af0b81.js";import"./unhead_vue-0787c3d6.js";import"./unhead-a4367481.js";import"./hookable-e7fd869b.js";import"./unhead_dom-b5f3dd9b.js";import"./unhead_shared-56c99682.js";import"./fawmi_vue-google-maps-439c501d.js";import"./googlemaps_markerclusterer-b718980f.js";import"./fast-deep-equal-1db9e660.js";import"./axios-96fb5abd.js";import"./process-93c0ea83.js";import"./supercluster-6504d485.js";import"./kdbush-ac640998.js";import"./browser-image-compression-a3ab6596.js";import"./lodash-a9971f22.js";import"./pinia-a2cac08c.js";import"./vue-demi-71ba0ef2.js";import"./moment-ea709ccd.js";import"./slugify-ce681755.js";import"./vueuse_core-d5cd9503.js";import"./vueuse_shared-835eca33.js";import"./parse-domain-01b1033a.js";import"./is-ip-33949ce5.js";import"./ip-regex-e6f9cbd8.js";import"./super-regex-a8a38319.js";import"./function-timeout-8f7724f6.js";import"./clone-regexp-3bc3d90c.js";import"./is-regexp-5fa9e804.js";import"./ckeditor_ckeditor5-vue-df7eee76.js";import"./vue-2044cde0.js";import"./strip-json-comments-680ed425.js";import"./vue-draggable-next-417126f1.js";import"./pinia_colada-2d4f4a8d.js";import"./vue-shepherd-6780f0ef.js";import"./shepherd.js-8a3687f6.js";import"./vue-tel-input-a68ee547.js";import"./vue3-map-chart-668e2d48.js";import"./crypto-js-eb39eca1.js";import"./pinia-persistence-plugin-50ba422c.js";/* empty css                    *//* empty css               *//* empty css                                      */import"./date-fns-eed65714.js";import"./seemly-5e1e6f41.js";import"./vueuc-d047f964.js";import"./evtd-b614532e.js";import"./css-render_vue3-ssr-68d47bbf.js";import"./vooks-6944b357.js";import"./vdirs-b0483831.js";import"./juggle_resize-observer-41516555.js";import"./css-render-9b607bf6.js";import"./emotion_hash-8a8e73f6.js";import"./lodash-es-a215867d.js";import"./treemate-25c27bff.js";import"./date-fns-tz-6c300683.js";import"./async-validator-dc9a4891.js";import"./css-render_plugin-bem-9dde7ffe.js";import"./intlify_shared-f7876323.js";import"./intlify_core-base-c423e336.js";import"./intlify_message-compiler-48af4dac.js";const ce={class:"container h-full"},fe={class:"flex justify-center items-center flex-wrap h-full g-6 text-gray-800"},_e={class:"md:w-8/12 lg:w-5/12 xl:w-4/12 2xl:w-3.5/12 sm:w-full"},we={class:"flex justify-center mb-8"},ge=["src","alt"],ve={class:"mt-2"},be=E({name:_.REGISTER.NAME}),Mt=E({...be,setup(he){const{t}=oe(),w=X(),R=ae(),{request:q}=Y(),{displayFormErrors:x,logo:I}=M(),{userHasSuperAdminRole:D}=F(),{defaultPrefs:P}=B(),y=j(),d=z(),A=h(!1),S=h(null),s=h({lastname:"",firstname:"",email:"",password:"",passwordConfirmation:""}),H={lastname:[{required:!0,message:t("fillRequired")}],firstname:[{required:!0,message:t("fillRequired")}],email:[{required:!0,message:t("fillRequired")},{trigger:["input"],validator(n,r){return r&&!Z.isEmail(r)?new Error(t("invalidEmail")):!0}}],password:[{required:!0,message:t("fillRequired")},{trigger:["input"],validator(n,r){return r&&["too-weak"].includes(Q.passwordStrength(r,K).value)?new Error(t("passwordTooWeak")):!0}}],passwordConfirmation:[{required:!0,message:t("fillRequired")},{trigger:["input"],validator(n,r){return r&&r!==s.value.password?new Error(t("nonCompliantPassword")):!0}}]},N=async n=>{var r;n.preventDefault(),(r=S.value)==null||r.validate(async p=>{var m,c,g,f,v,b;if(p)R.error(t("invalidForm"));else{A.value=!0,d.userData=null;const l=await q({url:"/auth/register",method:"post",data:{...s.value,preferences:P.value}});if(l.failure&&l.error)switch((g=(c=(m=l.error)==null?void 0:m.response)==null?void 0:c.data)==null?void 0:g.errorCode){case k.AUTH_MISSING_DATA:R.error(t("missingData"));break;case k.FORM_INVALID_DATA:x((b=(v=(f=l.error)==null?void 0:f.response)==null?void 0:v.data)==null?void 0:b.data);break;default:R.error(t("registrationNotSuccessful"))}else l.success&&l.result?(d.userData=l.result.data.user,d.accessToken=l.result.data.accessToken,d.accessTokenDate=$()):w.replace(_.LOGIN.PATH),s.value={lastname:"",firstname:"",email:"",password:"",passwordConfirmation:""};A.value=!1}})},U="Creopse";ee(()=>d.isUserConnected,n=>{n&&(D()&&y.initDefaultSettings(),w.replace(_.HOME.PATH))},{immediate:!0});const V=y.getSettingValue("disableInstaller","boolean");y.getSettingValue("allowRegistration","boolean")||w.replace(_.LOGIN.PATH);const L=h(!0);return(n,r)=>{const p=le,m=ie,c=ne,g=pe,f=me,v=ue,b=de,l=W,O=G;return te(),re(O,{"display-server-alerts":!e(V)},{default:a(()=>[o(l,{name:"slide-fade",appear:""},{default:a(()=>[u("div",ce,[u("div",fe,[u("div",_e,[o(l,{appear:""},{default:a(()=>[se(o(b,{size:"small",class:"w-full"},{default:a(()=>[u("div",we,[u("img",{src:e(I),class:"w-54",alt:e(U)},null,8,ge)]),o(v,{ref_key:"formRef",ref:S,model:e(s),rules:H,"show-label":!1,"show-require-mark":!1,size:"medium"},{default:a(()=>[o(c,{"x-gap":"12",span:24},{default:a(()=>[o(m,{span:12,label:e(t)("lastname"),path:"lastname"},{default:a(()=>[o(p,{value:e(s).lastname,"onUpdate:value":r[0]||(r[0]=i=>e(s).lastname=i),placeholder:e(t)("lastname"),class:"w-full"},null,8,["value","placeholder"])]),_:1},8,["label"]),o(m,{span:12,label:e(t)("firstname_s"),path:"firstname"},{default:a(()=>[o(p,{value:e(s).firstname,"onUpdate:value":r[1]||(r[1]=i=>e(s).firstname=i),placeholder:e(t)("firstname_s"),class:"w-full"},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),o(g,{label:e(t)("addressEmail"),path:"email"},{default:a(()=>[o(p,{value:e(s).email,"onUpdate:value":r[2]||(r[2]=i=>e(s).email=i),placeholder:e(t)("addressEmail"),class:"w-full"},null,8,["value","placeholder"])]),_:1},8,["label"]),o(c,{"x-gap":"12",span:24},{default:a(()=>[o(m,{span:12,label:e(t)("password"),path:"password"},{default:a(()=>[o(p,{value:e(s).password,"onUpdate:value":r[3]||(r[3]=i=>e(s).password=i),placeholder:e(t)("password"),"show-password-on":"mousedown",type:"password",class:"w-full"},null,8,["value","placeholder"])]),_:1},8,["label"]),o(m,{span:12,label:e(t)("confirmPassword"),path:"passwordConfirmation"},{default:a(()=>[o(p,{value:e(s).passwordConfirmation,"onUpdate:value":r[4]||(r[4]=i=>e(s).passwordConfirmation=i),placeholder:e(t)("confirmPassword"),disabled:!e(s).password,"show-password-on":"mousedown",type:"password",class:"w-full"},null,8,["value","placeholder","disabled"])]),_:1},8,["label"])]),_:1}),o(f,{type:"primary",loading:e(A),disabled:!e(s).lastname||!e(s).firstname||!e(s).email||!e(s).password||!e(s).passwordConfirmation,block:"",onClick:N},{default:a(()=>[T(C(e(t)("validate")),1)]),_:1},8,["loading","disabled"]),u("div",ve,[o(f,{block:"",tertiary:"",type:"default",onClick:r[5]||(r[5]=i=>e(w).push(e(_).LOGIN.PATH))},{default:a(()=>[T(C(e(t)("alreadyHaveAccount"))+" "+C(e(t)("toLogin")),1)]),_:1})])]),_:1},8,["model"])]),_:1},512),[[J,e(L)]])]),_:1})])])])]),_:1})]),_:1},8,["display-server-alerts"])}}});export{Mt as default};
