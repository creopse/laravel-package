import{g as d,R as h,C as m,h as u}from"./ckeditor_ckeditor5-utils-CWV6iAXC.js";import{E as g,n as p,d as w,e as f,T as b,I as y}from"./ckeditor_ckeditor5-ui-0Cf30f_5.js";import"./color-name-B0-kzB5j.js";import"./color-convert-CPcGJsTp.js";import{e as T}from"./ckeditor_ckeditor5-engine-Bp3orBjd.js";import{D as v,a as E,E as k,b as P,c as C}from"./ckeditor_ckeditor5-core-Ck1E_gMX.js";import"./vanilla-colorful-CgSCOLsm.js";import{E as x,C as S}from"./ckeditor_ckeditor5-watchdog-DGwifVZq.js";import{a as R}from"./lodash-es-DLvU2Xhi.js";/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class F extends g{constructor(t,i){super(t),this.view=i,this._toolbarConfig=p(t.config.get("toolbar")),this._elementReplacer=new d,this.listenTo(t.editing.view,"scrollToTheSelection",this._handleScrollToTheSelectionWithStickyPanel.bind(this))}get element(){return this.view.element}init(t){const i=this.editor,s=this.view,e=i.editing.view,o=s.editable,a=e.document.getRoot();o.name=a.rootName,s.render();const c=o.element;this.setEditableElement(o.name,c),s.editable.bind("isFocused").to(this.focusTracker),e.attachDomRoot(c),t&&this._elementReplacer.replace(t,this.element),this._initPlaceholder(),this._initToolbar(),this.fire("ready")}destroy(){super.destroy();const t=this.view,i=this.editor.editing.view;this._elementReplacer.restore(),i.detachDomRoot(t.editable.name),t.destroy()}_initToolbar(){const t=this.view;t.stickyPanel.bind("isActive").to(this.focusTracker,"isFocused"),t.stickyPanel.limiterElement=t.element,t.stickyPanel.bind("viewportTopOffset").to(this,"viewportOffset",({top:i})=>i||0),t.toolbar.fillFromConfig(this._toolbarConfig,this.componentFactory),this.addToolbar(t.toolbar)}_initPlaceholder(){const t=this.editor,i=t.editing.view,s=i.document.getRoot(),e=t.sourceElement;let o;const a=t.config.get("placeholder");a&&(o=typeof a=="string"?a:a[this.view.editable.name]),!o&&e&&e.tagName.toLowerCase()==="textarea"&&(o=e.getAttribute("placeholder")),o&&T({view:i,element:s,text:o,isDirectHost:!1,keepOnFocus:!0})}_handleScrollToTheSelectionWithStickyPanel(t,i,s){const e=this.view.stickyPanel;if(e.isSticky){const o=new h(e.element).height;i.viewportOffset.top+=o}else{const o=()=>{this.editor.editing.view.scrollToTheSelection(s)};this.listenTo(e,"change:isSticky",o),setTimeout(()=>{this.stopListening(e,"change:isSticky",o)},20)}}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class _ extends w{constructor(t,i,s={}){super(t),this.stickyPanel=new f(t),this.toolbar=new b(t,{shouldGroupWhenFull:s.shouldToolbarGroupWhenFull}),this.editable=new y(t,i)}render(){super.render(),this.stickyPanel.content.add(this.toolbar),this.top.add(this.stickyPanel),this.main.add(this.editable)}}/**
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class l extends v(k(P)){constructor(t,i={}){if(!r(t)&&i.initialData!==void 0)throw new m("editor-create-initial-data",null);super(i),this.config.get("initialData")===void 0&&this.config.set("initialData",W(t)),r(t)&&(this.sourceElement=t),this.model.document.createRoot();const s=!this.config.get("toolbar.shouldNotGroupWhenFull"),e=new _(this.locale,this.editing.view,{shouldToolbarGroupWhenFull:s});this.ui=new F(this,e),E(this)}destroy(){return this.sourceElement&&this.updateSourceElement(),this.ui.destroy(),super.destroy()}static create(t,i={}){return new Promise(s=>{const e=new this(t,i);s(e.initPlugins().then(()=>e.ui.init(r(t)?t:null)).then(()=>e.data.init(e.config.get("initialData"))).then(()=>e.fire("ready")).then(()=>e))})}}l.Context=C;l.EditorWatchdog=x;l.ContextWatchdog=S;function W(n){return r(n)?u(n):n}function r(n){return R(n)}export{l as C};
