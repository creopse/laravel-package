import{_ as B}from"./AuthLayout-6e219711.js";import{u as G,c as j,d as K,R as T,P as W,g as z,_ as $,e as Q}from"./index-920c76d4.js";import{v as Y,w as D}from"./vue_runtime-dom-5ad5ecb0.js";import{R as f}from"./response-error-code-87d1097e.js";import{u as J}from"./vue-router-c3388b6d.js";import{_ as X}from"./validator-c0254ba9.js";import{b as Z,E as ee,F as oe,M as te,_ as re,G as se,L as ae}from"./naive-ui-ab0dda7d.js";import{d as N,w as ie,o as C,P as le,aO as i,Y as s,a as n,v as ne,l as k,c as me,F as pe,Q as ue}from"./vue_runtime-core-273b5003.js";import{u as de}from"./vue-i18n-0da1582b.js";import{r as A,u as e}from"./vue_reactivity-852d8377.js";import{t as g}from"./vue_shared-7dcc3b7f.js";import"./iconify_vue-46af0b81.js";import"./unhead_vue-0787c3d6.js";import"./unhead-a4367481.js";import"./hookable-e7fd869b.js";import"./unhead_dom-b5f3dd9b.js";import"./unhead_shared-56c99682.js";import"./fawmi_vue-google-maps-439c501d.js";import"./googlemaps_markerclusterer-b718980f.js";import"./fast-deep-equal-1db9e660.js";import"./axios-96fb5abd.js";import"./process-93c0ea83.js";import"./supercluster-6504d485.js";import"./kdbush-ac640998.js";import"./browser-image-compression-a3ab6596.js";import"./lodash-a9971f22.js";import"./pinia-a2cac08c.js";import"./vue-demi-71ba0ef2.js";import"./moment-ea709ccd.js";import"./slugify-ce681755.js";import"./vueuse_core-d5cd9503.js";import"./vueuse_shared-835eca33.js";import"./parse-domain-489ba3ba.js";import"./is-ip-33949ce5.js";import"./ip-regex-e6f9cbd8.js";import"./super-regex-a8a38319.js";import"./function-timeout-8f7724f6.js";import"./clone-regexp-3bc3d90c.js";import"./is-regexp-5fa9e804.js";import"./ckeditor_ckeditor5-vue-df7eee76.js";import"./vue-2044cde0.js";import"./strip-json-comments-680ed425.js";import"./vue-draggable-next-417126f1.js";import"./pinia_colada-2d4f4a8d.js";import"./vue-shepherd-6780f0ef.js";import"./shepherd.js-8a3687f6.js";import"./vue-tel-input-a68ee547.js";import"./vue3-map-chart-668e2d48.js";import"./crypto-js-eb39eca1.js";import"./pinia-persistence-plugin-50ba422c.js";/* empty css                    *//* empty css               *//* empty css                                      */import"./date-fns-eed65714.js";import"./seemly-5e1e6f41.js";import"./vueuc-d047f964.js";import"./evtd-b614532e.js";import"./css-render_vue3-ssr-68d47bbf.js";import"./vooks-6944b357.js";import"./vdirs-b0483831.js";import"./juggle_resize-observer-41516555.js";import"./css-render-9b607bf6.js";import"./emotion_hash-8a8e73f6.js";import"./lodash-es-a215867d.js";import"./treemate-25c27bff.js";import"./date-fns-tz-6c300683.js";import"./async-validator-dc9a4891.js";import"./css-render_plugin-bem-9dde7ffe.js";import"./intlify_shared-f7876323.js";import"./intlify_core-base-c423e336.js";import"./intlify_message-compiler-48af4dac.js";const ce={class:"container h-full"},_e={class:"flex justify-center items-center flex-wrap h-full g-6 text-gray-800"},fe={class:"md:w-8/12 lg:w-5/12 xl:w-3.5/12 2xl:w-3/12 sm:w-full"},ge={class:"flex justify-center mb-8"},we=["src","alt"],ve={class:"flex justify-around items-center mb-6"},be=N({name:T.LOGIN.NAME}),Mo=N({...be,setup(he){const{t,locale:I}=de(),{request:P}=Q(),{displayFormErrors:U,updateLocale:H,logo:O}=G(),S=J(),p=Z(),u=j(),E=K(),w=A(!1),x=A(null),a=A({email:"",password:"",remember:!1}),V={email:[{required:!0,message:t("fillRequired")},{trigger:["input"],validator(d,o){return o&&!X.isEmail(o)?new Error(t("invalidEmail")):!0}}],password:[{required:!0,message:t("fillRequired")}]},R=async d=>{var o;d.preventDefault(),(o=x.value)==null||o.validate(async v=>{var c,b,m,h,y,_;if(!v){w.value=!0,u.userData=null;const l=await P({url:"/auth/login",method:"post",data:a.value});if(l.failure&&l.error)switch((m=(b=(c=l.error)==null?void 0:c.response)==null?void 0:b.data)==null?void 0:m.errorCode){case f.AUTH_USER_NOT_FOUND:case f.AUTH_WRONG_PASSWORD:p.error(t("wrongEmailOrPassword"));break;case f.AUTH_MISSING_DATA:p.error(t("missingData"));break;case f.FORM_INVALID_DATA:U((_=(y=(h=l.error)==null?void 0:h.response)==null?void 0:y.data)==null?void 0:_.data);break;case f.AUTH_USER_DISABLED:p.error(t("disabledAccount"));break;default:p.error(t("unableToLogin"))}else{a.value={email:"",password:"",remember:!1},w.value=!1;const r=l.result.data.user;r!=null&&r.profileType&&(r==null?void 0:r.profileType)!==W.ADMIN?p.error(t("unableToLogin")):(u.userData=r,u.accessToken=l.result.data.accessToken,u.accessTokenDate=z())}w.value=!1}})},L="Creopse",M=E.getSettingValue("disableInstaller","boolean"),q=E.getSettingValue("allowRegistration","boolean");ie(()=>u.isUserConnected,d=>{H(I.value,!1),d&&S.replace(T.HOME.PATH)},{immediate:!0});const F=A(!0);return(d,o)=>{const v=ee,c=oe,b=te,m=re,h=se,y=ae,_=$,l=B;return C(),le(l,{"display-server-alerts":!e(M)},{default:i(()=>[s(_,{name:"slide-fade",appear:""},{default:i(()=>[n("div",ce,[n("div",_e,[n("div",fe,[s(_,{appear:""},{default:i(()=>[ne(s(y,{size:"small",class:"w-full"},{default:i(()=>[n("div",ge,[n("img",{src:e(O),class:"w-54",alt:e(L)},null,8,we)]),s(h,{ref_key:"formRef",ref:x,model:e(a),rules:V,"show-label":!1,"show-require-mark":!1,size:"medium"},{default:i(()=>[s(c,{label:e(t)("addressEmail"),path:"email"},{default:i(()=>[s(v,{value:e(a).email,"onUpdate:value":o[0]||(o[0]=r=>e(a).email=r),placeholder:e(t)("addressEmail"),class:"w-full",onKeyup:D(R,["enter"])},null,8,["value","placeholder"])]),_:1},8,["label"]),s(c,{span:12,label:e(t)("password"),path:"password"},{default:i(()=>[s(v,{value:e(a).password,"onUpdate:value":o[1]||(o[1]=r=>e(a).password=r),placeholder:e(t)("password"),"show-password-on":"mousedown",type:"password",class:"w-full",onKeyup:D(R,["enter"])},null,8,["value","placeholder"])]),_:1},8,["label"]),n("div",ve,[s(b,{checked:e(a).remember,"onUpdate:checked":o[2]||(o[2]=r=>e(a).remember=r)},{default:i(()=>[k(g(e(t)("rememberMe")),1)]),_:1},8,["checked"]),s(m,{text:"",onClick:o[3]||(o[3]=r=>e(S).push(e(T).RESET_PASSWORD.PATH))},{default:i(()=>[k(g(e(t)("forgotPassword")),1)]),_:1})]),s(m,{type:"primary",loading:e(w),disabled:!e(a).email||!e(a).password,block:"",onClick:R},{default:i(()=>[k(g(e(t)("validate")),1)]),_:1},8,["loading","disabled"]),e(q)?(C(),me(pe,{key:0},[o[5]||(o[5]=n("div",{class:"h-3"},null,-1)),s(m,{block:"",tertiary:"",type:"default",onClick:o[4]||(o[4]=r=>e(S).push(e(T).REGISTER.PATH))},{default:i(()=>[k(g(e(t)("dontHaveAccount"))+" "+g(e(t)("register")),1)]),_:1})],64)):ue("",!0)]),_:1},8,["model"])]),_:1},512),[[Y,e(F)]])]),_:1})])])])]),_:1})]),_:1},8,["display-server-alerts"])}}});export{Mo as default};
