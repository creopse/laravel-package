import{i as m}from"./ckeditor_ckeditor5-vue-D9YIFk5Z.js";import{_ as A}from"./AuthLayout.vue_vue_type_script_setup_true_lang-B3cX_48p.js";import{I as E}from"./iconify_vue-DK9FHL8l.js";import{p as I}from"./password-strength-options-ByZgG3BK.js";import{d as V,l as D,R as p}from"./index-BictNpzW.js";import{p as x}from"./check-password-strength-DpJr94ZL.js";import{u as B,a as T}from"./vue-router-JM7pifDK.js";import{_ as O}from"./validator-DwVK3abb.js";import{z as U,A as L,C as W,B as z,q as G}from"./naive-ui-U3LV0D3Q.js";import{u as H}from"./vue-i18n-DGGON2e6.js";const{defineComponent:M}=await m("vue"),{unref:e,resolveComponent:ie,createVNode:r,withCtx:t,openBlock:f,createBlock:w,createCommentVNode:$,toDisplayString:j,createTextVNode:F}=await m("vue"),{defineComponent:J,ref:v,onMounted:K}=await m("vue"),Q=J({name:p.ADD_NEW_PASSWORD.NAME}),ue=M({...Q,setup(X){const{t:a}=H(),i=B(),c=T(),{getSettingValue:g}=V(),{mutate:C,isPending:b}=D(),_=v(null),s=v({email:"",password:"",passwordConfirmation:""}),h={email:[{required:!0,message:a("fillRequired")},{trigger:["input"],validator(n,o){return o&&!O.isEmail(o)?new Error(a("invalidEmail")):!0}}],password:[{required:!0,message:a("fillRequired")},{trigger:["input"],validator(n,o){return o&&["too-weak"].includes(x(o,I).value)?new Error(a("passwordTooWeak")):!0}}],passwordConfirmation:[{required:!0,message:a("fillRequired")},{trigger:["input"],validator(n,o){return o&&o!==s.value.password?new Error(a("nonCompliantPassword")):!0}}]},y=n=>{n.preventDefault(),_.value?.validate(async o=>{o||C({email:s.value.email,token:i.params.token,password:s.value.password,passwordConfirmation:s.value.passwordConfirmation},{onSuccess:()=>{c.replace(p.LOGIN.PATH)}})})},k=g("disableInstaller","boolean");return K(()=>{i.params.token||c.replace(p.LOGIN.PATH),s.value.email=i.query.email}),(n,o)=>{const u=W,d=L,P=E,N=G,R=z,S=U,q=A;return f(),w(q,{title:e(a)("setNewPassword"),subtitle:e(a)("chooseSecurePassToAccessUrAccount"),"display-server-alerts":!e(k)},{default:t(()=>[r(S,{ref_key:"formRef",ref:_,model:e(s),rules:h,"show-label":!1,"show-require-mark":!1,size:"medium"},{default:t(()=>[e(i).query.email?$("",!0):(f(),w(d,{key:0,label:e(a)("addressEmail"),path:"email"},{default:t(()=>[r(u,{value:e(s).email,"onUpdate:value":o[0]||(o[0]=l=>e(s).email=l),placeholder:e(a)("addressEmail"),class:"w-full"},null,8,["value","placeholder"])]),_:1},8,["label"])),r(d,{label:e(a)("newPassword"),path:"password"},{default:t(()=>[r(u,{value:e(s).password,"onUpdate:value":o[1]||(o[1]=l=>e(s).password=l),placeholder:e(a)("newPassword"),"show-password-on":"mousedown",type:"password",class:"w-full"},null,8,["value","placeholder"])]),_:1},8,["label"]),r(d,{label:e(a)("confirmPassword"),path:"passwordConfirmation"},{default:t(()=>[r(u,{value:e(s).passwordConfirmation,"onUpdate:value":o[2]||(o[2]=l=>e(s).passwordConfirmation=l),placeholder:e(a)("confirmPassword"),disabled:!e(s).password,"show-password-on":"mousedown",type:"password",class:"w-full"},null,8,["value","placeholder","disabled"])]),_:1},8,["label"]),r(R,{block:"",secondary:"",type:"primary",loading:e(b),onClick:y},{icon:t(()=>[r(N,null,{default:t(()=>[r(P,{icon:"carbon:save"})]),_:1})]),default:t(()=>[F(" "+j(e(a)("save")),1)]),_:1},8,["loading"])]),_:1},8,["model"])]),_:1},8,["title","subtitle","display-server-alerts"])}}});export{ue as default};
