import{i as y}from"./css-render_vue3-ssr-Vbotx5Ir.js";import{_ as F}from"./AuthLayout-Cd04zGrL.js";import{u as G,c as K,d as j,R as v,_ as W,e as z,P as $,g as J}from"./index-B2LlKIv2.js";import{R as _}from"./response-error-code-DXeaxdrh.js";import{u as Q}from"./vue-router-B7M2c80d.js";import{_ as X}from"./validator-QVVspsrX.js";import{b as Y,A as Z,D as ee,E as te,F as se,M as oe,B as ae}from"./naive-ui-CrTIpLJ9.js";import{u as re}from"./vue-i18n-CWrb4u3f.js";const{defineComponent:le}=await y("vue"),{unref:e,createElementVNode:i,resolveComponent:xe,withKeys:E,createVNode:o,withCtx:r,toDisplayString:p,createTextVNode:w,Fragment:ne,openBlock:D,createElementBlock:ie,createCommentVNode:ue,vShow:ce,withDirectives:de,createBlock:me}=await y("vue"),_e={class:"container h-full"},pe={class:"flex justify-center items-center flex-wrap h-full g-6 text-gray-800"},fe={class:"md:w-8/12 lg:w-5/12 xl:w-3.5/12 2xl:w-3/12 sm:w-full"},we={class:"flex justify-center mb-8"},ge=["src","alt"],ve={class:"flex justify-around items-center mb-6"},{defineComponent:be,ref:g,watch:he}=await y("vue"),ke=be({name:v.LOGIN.NAME}),Ve=le({...ke,setup(ye){const{t,locale:R}=re(),{request:C}=z(),{displayFormErrors:N,updateLocale:x,logo:V}=G(),b=Q(),c=Y(),d=K(),A=j(),f=g(!1),S=g(null),a=g({email:"",password:"",remember:!1}),I={email:[{required:!0,message:t("fillRequired")},{trigger:["input"],validator(m,s){return s&&!X.isEmail(s)?new Error(t("invalidEmail")):!0}}],password:[{required:!0,message:t("fillRequired")}]},h=async m=>{m.preventDefault(),S.value?.validate(async s=>{if(!s){f.value=!0,d.userData=null;const l=await C({url:"/auth/login",method:"post",data:a.value});if(l.failure&&l.error)switch(l.error?.response?.data?.errorCode){case _.AUTH_USER_NOT_FOUND:case _.AUTH_WRONG_PASSWORD:c.error(t("wrongEmailOrPassword"));break;case _.AUTH_MISSING_DATA:c.error(t("missingData"));break;case _.FORM_INVALID_DATA:N(l.error?.response?.data?.data);break;case _.AUTH_USER_DISABLED:c.error(t("disabledAccount"));break;default:c.error(t("unableToLogin"))}else{a.value={email:"",password:"",remember:!1},f.value=!1;const u=l.result.data.user;u?.profileType&&u?.profileType!==$.ADMIN?c.error(t("unableToLogin")):(d.userData=u,d.accessToken=l.result.data.accessToken,d.accessTokenDate=J())}f.value=!1}})},U="Creopse",H=A.getSettingValue("disableInstaller","boolean"),P=A.getSettingValue("allowRegistration","boolean");he(()=>d.isUserConnected,m=>{x(R.value,!1),m&&b.replace(v.HOME.PATH)},{immediate:!0});const B=g(!0);return(m,s)=>{const l=se,u=te,O=oe,k=ae,M=ee,L=Z,T=W,q=F;return D(),me(q,{"display-server-alerts":!e(H)},{default:r(()=>[o(T,{name:"slide-fade",appear:""},{default:r(()=>[i("div",_e,[i("div",pe,[i("div",fe,[o(T,{appear:""},{default:r(()=>[de(o(L,{size:"small",class:"w-full"},{default:r(()=>[i("div",we,[i("img",{src:e(V),class:"w-54",alt:e(U)},null,8,ge)]),o(M,{ref_key:"formRef",ref:S,model:e(a),rules:I,"show-label":!1,"show-require-mark":!1,size:"medium"},{default:r(()=>[o(u,{label:e(t)("addressEmail"),path:"email"},{default:r(()=>[o(l,{value:e(a).email,"onUpdate:value":s[0]||(s[0]=n=>e(a).email=n),placeholder:e(t)("addressEmail"),class:"w-full",onKeyup:E(h,["enter"])},null,8,["value","placeholder"])]),_:1},8,["label"]),o(u,{span:12,label:e(t)("password"),path:"password"},{default:r(()=>[o(l,{value:e(a).password,"onUpdate:value":s[1]||(s[1]=n=>e(a).password=n),placeholder:e(t)("password"),"show-password-on":"mousedown",type:"password",class:"w-full",onKeyup:E(h,["enter"])},null,8,["value","placeholder"])]),_:1},8,["label"]),i("div",ve,[o(O,{checked:e(a).remember,"onUpdate:checked":s[2]||(s[2]=n=>e(a).remember=n)},{default:r(()=>[w(p(e(t)("rememberMe")),1)]),_:1},8,["checked"]),o(k,{text:"",onClick:s[3]||(s[3]=n=>e(b).push(e(v).RESET_PASSWORD.PATH))},{default:r(()=>[w(p(e(t)("forgotPassword")),1)]),_:1})]),o(k,{type:"primary",loading:e(f),disabled:!e(a).email||!e(a).password,block:"",onClick:h},{default:r(()=>[w(p(e(t)("validate")),1)]),_:1},8,["loading","disabled"]),e(P)?(D(),ie(ne,{key:0},[s[5]||(s[5]=i("div",{class:"h-3"},null,-1)),o(k,{block:"",tertiary:"",type:"default",onClick:s[4]||(s[4]=n=>e(b).push(e(v).REGISTER.PATH))},{default:r(()=>[w(p(e(t)("dontHaveAccount"))+" "+p(e(t)("register")),1)]),_:1})],64)):ue("",!0)]),_:1},8,["model"])]),_:1},512),[[ce,e(B)]])]),_:1})])])])]),_:1})]),_:1},8,["display-server-alerts"])}}});export{Ve as default};
