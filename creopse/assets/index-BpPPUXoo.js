import{i as f}from"./ckeditor_ckeditor5-vue-D9YIFk5Z.js";import{_ as D}from"./AuthLayout.vue_vue_type_script_setup_true_lang-B7vkOKp2.js";import{I as V}from"./iconify_vue-DK9FHL8l.js";import{p as H}from"./password-strength-options-ByZgG3BK.js";import{a as B,b as O,d as L,c as G,k as M,g as $,R as p,j,h as z}from"./index-BkcZCWEr.js";import{p as F}from"./check-password-strength-DpJr94ZL.js";import{a as Y}from"./vue-router-JM7pifDK.js";import{u as W}from"./app-setting-BRDrXCWg.js";import{_ as J}from"./validator-DwVK3abb.js";import{a as K,z as Q,D as X,E as Z,C as ee,A as ae,B as se,q as te}from"./naive-ui-U3LV0D3Q.js";import{u as oe}from"./vue-i18n-DGGON2e6.js";const{defineComponent:re}=await f("vue"),{unref:e,resolveComponent:Se,createVNode:o,withCtx:r,toDisplayString:c,createTextVNode:b,createElementVNode:ne,openBlock:le,createBlock:ie}=await f("vue"),ue={class:"mt-2"},{defineComponent:pe,ref:h,watch:de}=await f("vue"),me=pe({name:p.REGISTER.NAME}),Ee=re({...me,setup(ce){const{t:a}=oe(),d=Y(),C=K(),{userHasSuperAdminRole:k}=B(),{defaultPrefs:y}=O(),{getSettingValue:_}=L(),u=G(),{mutate:R}=W(),{mutate:A,isPending:S}=M(),w=h(null),t=h({lastname:"",firstname:"",email:"",password:"",passwordConfirmation:""}),E={lastname:[{required:!0,message:a("fillRequired")}],firstname:[{required:!0,message:a("fillRequired")}],email:[{required:!0,message:a("fillRequired")},{trigger:["input"],validator(i,s){return s&&!J.isEmail(s)?new Error(a("invalidEmail")):!0}}],password:[{required:!0,message:a("fillRequired")},{trigger:["input"],validator(i,s){return s&&["too-weak"].includes(F(s,H).value)?new Error(a("passwordTooWeak")):!0}}],passwordConfirmation:[{required:!0,message:a("fillRequired")},{trigger:["input"],validator(i,s){return s&&s!==t.value.password?new Error(a("nonCompliantPassword")):!0}}]},q=async i=>{i.preventDefault(),w.value?.validate(async s=>{s?C.error(a("invalidForm")):(u.userData=null,A({...t.value,preferences:y.value},{onSuccess:l=>{l?(u.userData=l.user,u.accessToken=l.accessToken,u.accessTokenDate=j()):d.replace(p.LOGIN.PATH),t.value={lastname:"",firstname:"",email:"",password:"",passwordConfirmation:""}}}))})};de(()=>u.isUserConnected,i=>{i&&(k()&&R($(z)),d.replace(p.HOME.PATH))},{immediate:!0});const T=_("disableInstaller","boolean");return _("allowRegistration","boolean")||d.replace(p.LOGIN.PATH),(i,s)=>{const l=ee,m=Z,g=X,I=ae,N=V,P=te,v=se,U=Q,x=D;return le(),ie(x,{title:e(a)("createYourAccount"),subtitle:e(a)("takeYourFirstStep"),"display-server-alerts":!e(T)},{default:r(()=>[o(U,{ref_key:"formRef",ref:w,model:e(t),rules:E,"show-label":!1,"show-require-mark":!1,size:"medium"},{default:r(()=>[o(g,{"x-gap":"12",span:24},{default:r(()=>[o(m,{span:12,label:e(a)("lastname"),path:"lastname"},{default:r(()=>[o(l,{value:e(t).lastname,"onUpdate:value":s[0]||(s[0]=n=>e(t).lastname=n),placeholder:e(a)("lastname"),class:"w-full"},null,8,["value","placeholder"])]),_:1},8,["label"]),o(m,{span:12,label:e(a)("firstname_s"),path:"firstname"},{default:r(()=>[o(l,{value:e(t).firstname,"onUpdate:value":s[1]||(s[1]=n=>e(t).firstname=n),placeholder:e(a)("firstname_s"),class:"w-full"},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),o(I,{label:e(a)("addressEmail"),path:"email"},{default:r(()=>[o(l,{value:e(t).email,"onUpdate:value":s[2]||(s[2]=n=>e(t).email=n),placeholder:e(a)("addressEmail"),class:"w-full"},null,8,["value","placeholder"])]),_:1},8,["label"]),o(g,{"x-gap":"12",span:24},{default:r(()=>[o(m,{span:12,label:e(a)("password"),path:"password"},{default:r(()=>[o(l,{value:e(t).password,"onUpdate:value":s[3]||(s[3]=n=>e(t).password=n),placeholder:e(a)("password"),"show-password-on":"mousedown",type:"password",class:"w-full"},null,8,["value","placeholder"])]),_:1},8,["label"]),o(m,{span:12,label:e(a)("confirmPassword"),path:"passwordConfirmation"},{default:r(()=>[o(l,{value:e(t).passwordConfirmation,"onUpdate:value":s[4]||(s[4]=n=>e(t).passwordConfirmation=n),placeholder:e(a)("confirmPassword"),disabled:!e(t).password,"show-password-on":"mousedown",type:"password",class:"w-full"},null,8,["value","placeholder","disabled"])]),_:1},8,["label"])]),_:1}),o(v,{secondary:"",type:"primary",loading:e(S),disabled:!e(t).lastname||!e(t).firstname||!e(t).email||!e(t).password||!e(t).passwordConfirmation,block:"",onClick:q},{icon:r(()=>[o(P,null,{default:r(()=>[o(N,{icon:"carbon:study-next"})]),_:1})]),default:r(()=>[b(" "+c(e(a)("register")),1)]),_:1},8,["loading","disabled"]),ne("div",ue,[o(v,{block:"",tertiary:"",type:"default",onClick:s[5]||(s[5]=n=>e(d).push(e(p).LOGIN.PATH))},{default:r(()=>[b(c(e(a)("alreadyHaveAccount"))+" "+c(e(a)("toLogin")),1)]),_:1})])]),_:1},8,["model"])]),_:1},8,["title","subtitle","display-server-alerts"])}}});export{Ee as default};
