import{w,u as b,S as A}from"./xlsx-ac06d7c6.js";import{F as y}from"./file-saver-2f22969a.js";import"./crypto-js-a0189596.js";import"./axios-8734fada.js";import"./process-199d9cab.js";function l(i){for(var f=[],e=i.querySelectorAll("tr"),t=[],n=0;n<e.length;++n){for(var r=[],h=e[n],g=h.querySelectorAll("td"),u=0;u<g.length;++u){var c=g[u],p=c.getAttribute("colspan"),o=c.getAttribute("rowspan"),a=c.innerText;if(a!==""&&a==+a&&(a=+a),t.forEach(function(s){if(n>=s.s.r&&n<=s.e.r&&r.length>=s.s.c&&r.length<=s.e.c)for(var m=0;m<=s.e.c-s.s.c;++m)r.push(null)}),(o||p)&&(o=o||1,p=p||1,t.push({s:{r:n,c:r.length},e:{r:n+o-1,c:r.length+p-1}})),r.push(a!==""?a:null),p)for(var v=0;v<p-1;++v)r.push(null)}f.push(r)}return[f,t]}function T(i,f){f&&(i+=1462);var e=Date.parse(i);return(e-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3)}function _(i){for(var f={},e={s:{c:1e7,r:1e7},e:{c:0,r:0}},t=0;t!=i.length;++t)for(var n=0;n!=i[t].length;++n){e.s.r>t&&(e.s.r=t),e.s.c>n&&(e.s.c=n),e.e.r<t&&(e.e.r=t),e.e.c<n&&(e.e.c=n);var r={v:i[t][n]};if(r.v!=null){var h=b.encode_cell({c:n,r:t});typeof r.v=="number"?r.t="n":typeof r.v=="boolean"?r.t="b":r.v instanceof Date?(r.t="n",r.z=A._table[14],r.v=T(r.v)):r.t="s",f[h]=r}}return e.s.c<1e7&&(f["!ref"]=b.encode_range(e)),f}function S(){if(!(this instanceof S))return new S;this.SheetNames=[],this.Sheets={}}function x(i){for(var f=new ArrayBuffer(i.length),e=new Uint8Array(f),t=0;t!=i.length;++t)e[t]=i.charCodeAt(t)&255;return f}function F(i){var f=document.getElementById(i),e=l(f),t=e[1],n=e[0],r="SheetJS",h=new S,g=_(n);g["!merges"]=t,h.SheetNames.push(r),h.Sheets[r]=g;var u=w(h,{bookType:"xlsx",bookSST:!1,type:"binary"});y.saveAs(new Blob([x(u)],{type:"application/octet-stream"}),"test.xlsx")}function N({multiHeader:i=[],header:f,data:e,filename:t,merges:n=[],autoWidth:r=!0,bookType:h="xlsx"}={}){t=t||"excel-list",e=[...e],e.unshift(f);for(let o=i.length-1;o>-1;o--)e.unshift(i[o]);var g="SheetJS",u=new S,c=_(e);if(n.length>0&&(c["!merges"]||(c["!merges"]=[]),n.forEach(o=>{c["!merges"].push(b.decode_range(o))})),r){const o=e.map(v=>v.map(s=>s==null?{wch:10}:s.toString().charCodeAt(0)>255?{wch:s.toString().length*2}:{wch:s.toString().length})),a=o[0];for(let v=1;v<o.length;v++)for(let s=0;s<o[v].length;s++)a[s].wch<o[v][s].wch&&(a[s].wch=o[v][s].wch);c["!cols"]=a}u.SheetNames.push(g),u.Sheets[g]=c;var p=w(u,{bookType:h,bookSST:!1,type:"binary"});y.saveAs(new Blob([x(p)],{type:"application/octet-stream"}),`${t}.${h}`)}export{N as export_json_to_excel,F as export_table_to_excel};
