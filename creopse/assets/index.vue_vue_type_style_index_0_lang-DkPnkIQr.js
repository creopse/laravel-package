import{i as C}from"./ckeditor_ckeditor5-vue-D9YIFk5Z.js";import{a as F}from"./index.vue_vue_type_script_setup_true_lang-PRzHp-d9.js";import{M as f}from"./media-file-HhJTMxoV.js";import{a7 as B,c as A,N as k,aB as I}from"./index-BictNpzW.js";import{P as E}from"./ckeditor_ckeditor5-core-CWAtyu9P.js";import"./ckeditor_ckeditor5-utils-DZhn28Eg.js";import{B as S}from"./ckeditor_ckeditor5-ui-C7Ma50Jw.js";import"./ckeditor_ckeditor5-engine-BHV-Rp_a.js";import"./ckeditor_ckeditor5-widget-yxJBKz4n.js";import{L as R,T as U}from"./ckeditor_ckeditor5-list-DexonytB.js";import"./ckeditor_ckeditor5-mention-CRbwimBn.js";import{B as z}from"./ckeditor_ckeditor5-upload-TMyLAduV.js";import{A as M}from"./ckeditor_ckeditor5-alignment-zrkUyjOl.js";import{A as L}from"./ckeditor_ckeditor5-autoformat-iO6JJM1-.js";import{B as $,I as P,U as H,S as V,C as _,a as N,b as G}from"./ckeditor_ckeditor5-basic-styles-BsZ8k9_v.js";import{B as D}from"./ckeditor_ckeditor5-block-quote-D-vTUZac.js";import{C as O}from"./ckeditor_ckeditor5-code-block-CdVPRKmP.js";import{C as W}from"./ckeditor_ckeditor5-editor-classic-Cvh_00SH.js";import{E as q}from"./ckeditor_ckeditor5-essentials-CEi4GT-r.js";import{F as Q}from"./ckeditor_ckeditor5-find-and-replace-ZEmoweCt.js";import{F as j,a as K}from"./ckeditor_ckeditor5-font-DKG9Ffj7.js";import{F as J}from"./ckeditor_ckeditor5-fullscreen-S7KWho6o.js";import{H as X}from"./ckeditor_ckeditor5-heading-X3_9Es46.js";import{H as Y}from"./ckeditor_ckeditor5-horizontal-line-DFJPMTS1.js";import{I as Z,a as ee,b as te,c as oe,d as ae,e as le,f as re,g as ie}from"./ckeditor_ckeditor5-image-CC6b9dCk.js";import{I as ne}from"./ckeditor_ckeditor5-indent-CKEKWVcQ.js";import{L as se}from"./ckeditor_ckeditor5-link-VN2_FQ1C.js";import{M as de}from"./ckeditor_ckeditor5-media-embed-C7sCKini.js";import{R as me}from"./ckeditor_ckeditor5-remove-format-YO-u9GQb.js";import{S as ue}from"./ckeditor_ckeditor5-source-editing-Coe57xb4.js";import{S as pe,a as ce}from"./ckeditor_ckeditor5-special-characters-BOswn-VQ.js";import{c as fe}from"./ckeditor_ckeditor5-typing-uZoA9pnq.js";import{T as ge,a as be,b as he,c as ye,d as Ce}from"./ckeditor_ckeditor5-table-CKoUfUHD.js";import"./ckeditor5-BrgJTJSN.js";import{a as Ie}from"./axios-ELK0WRh1.js";import{u as ve}from"./vue-i18n-DGGON2e6.js";const{t:Te}=B.global;class Be extends E{init(){this.editor.ui.componentFactory.add("addCreopseMedia",e=>{const t=new S(e);return t.set({label:Te("addMedia"),withText:!0,tooltip:!0}),t.on("execute",()=>{const n=new Event("add-creopse-media");document.dispatchEvent(n)}),t})}}const{t:h}=B.global;class Ee extends E{init(){const a=this.editor;a.ui.componentFactory.add("customFullscreen",e=>{const t=new S(e);let n=0;return t.set({label:h("fullscreen"),withText:!0,tooltip:!0}),t.on("execute",()=>{n==1?(a.sourceElement.nextElementSibling.removeAttribute("id"),document.body.removeAttribute("id"),t.set({label:h("fullscreen"),withText:!0,tooltip:!0}),n=0):(a.sourceElement.nextElementSibling.setAttribute("id","fullscreeneditor"),document.body.setAttribute("id","fullscreenoverlay"),t.set({label:h("normalSize"),withText:!0,tooltip:!0}),n=1)}),t})}}class Se{loader;constructor(a){this.loader=a}async upload(){return this.loader.file.then(a=>new Promise((e,t)=>{this._sendRequest(e,t,a)}))}abort(){}async _sendRequest(a,e,t){const n=this.loader,p=I?.apiRequestHeaders,b=A();p&&(p.Authorization=`Bearer ${b.accessToken}`);const c=new FormData,s=await k(t,{maxSizeMB:1});c.append("file",s),c.append("folder","ck"),Ie.post(`${I?.apiUrl}/media-files/upload`,c,{headers:p,onUploadProgress:r=>{r.total!==void 0&&(n.uploadTotal=r.total,n.uploaded=r.loaded)}}).then(async r=>{const g=r.data;a({default:g.data.url})}).catch(r=>{e(r)})}}function xe(m){m.plugins.get("FileRepository").createUploadAdapter=a=>new Se(a)}const{defineComponent:we}=await C("vue"),{unref:u,resolveComponent:Fe,createVNode:v,isRef:Ae,openBlock:ke,createElementBlock:Re}=await C("vue"),{computed:T,ref:Ue,inject:ze,onMounted:Me,onUnmounted:Le}=await C("vue"),y="{{BASE_URL}}",yt=we({__name:"index",props:{modelValue:{default:""},disabled:{type:Boolean,default:!1},tagName:{default:"div"},placeholder:{default:""},lang:{default:null},minHeight:{default:100},shouldNotGroupWhenFull:{type:Boolean,default:!0},toolbarItems:{default:()=>["heading","|","bold","italic","underline","strikethrough","code","codeBlock","subscript","superscript","removeFormat","selectAll","specialCharacters","|","fontSize","fontFamily","fontColor","fontBackgroundColor","|","horizontalLine","blockQuote","bulletedList","numberedList","todoList","alignment","|","outdent","indent","|","link","uploadImage","insertTable","mediaEmbed","findAndReplace","|","undo","redo","|","sourceEditing","addCreopseMedia","fullscreen"]},imageToolbarItems:{default:()=>["imageStyle:inline","imageStyle:block","imageStyle:side","|","imageStyle:alignLeft","imageStyle:alignCenter","imageStyle:alignRight","|","resizeImage:25","resizeImage:50","resizeImage:75","resizeImage:original","|","toggleImageCaption","imageTextAlternative"]},tableContentToolbar:{default:()=>["toggleTableCaption","tableColumn","tableRow","mergeTableCells"]},enableUpload:{type:Boolean,default:!1}},emits:["update:modelValue","ready","focus","blur","destroy"],setup(m,{emit:a}){const e=m,t=a,n=W,{locale:p,t:b}=ve(),c=T(()=>{const d={language:e.lang||p.value,placeholder:e.placeholder,plugins:[q,L,$,P,H,V,_,N,G,D,X,Z,ee,te,oe,ae,le,re,ie,se,R,M,ge,be,he,ye,Ce,de,ne,fe,O,Q,j,K,Y,U,me,ue,pe,ce,Be,Ee,J],extraPlugins:[],toolbar:{items:e.toolbarItems,shouldNotGroupWhenFull:e.shouldNotGroupWhenFull},image:{toolbar:e.imageToolbarItems,resizeOptions:[{name:"resizeImage:original",value:null,icon:"original"},{name:"resizeImage:25",value:"25",icon:"small"},{name:"resizeImage:50",value:"50",icon:"medium"},{name:"resizeImage:75",value:"75",icon:"large"}]},table:{contentToolbar:e.tableContentToolbar},fullscreen:{toolbar:{shouldNotGroupWhenFull:!0}},licenseKey:"GPL"};return e.enableUpload?d.extraPlugins.push(xe):d.plugins.push(z),d});T(()=>typeof e.minHeight=="number"?`${e.minHeight}px`:e.minHeight);const s=Ue(!1),r=ze("appConfig"),g=()=>{s.value=!0};Me(()=>{document.addEventListener("add-creopse-media",g)}),Le(()=>{document.removeEventListener("add-creopse-media",g)});const x=d=>{if(d){let o=e.modelValue||"";d.forEach(l=>{l.type==f.IMAGE&&(o+=`<p><img src="${l.url}" /></p>`),l.type==f.DOCUMENT&&(o+=`<p><a href="${l.url}">${l.name}</a></p>`),l.type==f.AUDIO&&(o+=`<p style="text-align:center">[audio]${l.url}[/audio]</p>`),l.type==f.VIDEO&&(o+=`<p style="text-align:center">[video]${l.url}[/video]</p>`),l.type==f.OTHER&&(o+=`<p><a href="${l.url}">${l.name}</a></p>`)}),t("update:modelValue",o?.replace(new RegExp(`${r?.apiBaseUrl}/storage`,"g"),y))}s.value=!1};return(d,o)=>{const l=Fe("ckeditor"),w=F;return ke(),Re("section",null,[v(l,{editor:u(n),"tag-name":e.tagName,disabled:e.disabled,config:u(c),"model-value":e.modelValue?.replace(new RegExp(y,"g"),`${u(r)?.apiBaseUrl}/storage`),class:"page-content-editor",onInput:o[0]||(o[0]=i=>t("update:modelValue",i?.replace(new RegExp(`${u(r)?.apiBaseUrl}/storage`,"g"),y))),onDestroy:o[1]||(o[1]=i=>t("destroy",i)),onReady:o[2]||(o[2]=i=>t("ready",i)),onFocus:o[3]||(o[3]=i=>t("focus",i)),onBlur:o[4]||(o[4]=i=>t("blur",i))},null,8,["editor","tag-name","disabled","config","model-value"]),v(w,{show:u(s),"onUpdate:show":o[5]||(o[5]=i=>Ae(s)?s.value=i:null),title:u(b)("add"),"selection-type":"item","selection-multiple":"",onSubmit:x},null,8,["show","title"])])}}});export{yt as _};
