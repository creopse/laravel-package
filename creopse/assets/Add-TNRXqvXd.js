import{i as E}from"./css-render_vue3-ssr-Vbotx5Ir.js";import{_ as q}from"./PageLayout.vue_vue_type_script_setup_true_lang-OixN3STA.js";import{I as W}from"./iconify_vue-BwapRRpV.js";import{c as $,o as H,R as Y}from"./index-B2LlKIv2.js";import{a as G}from"./axios-ChUjVlRB.js";import{b as J,a as K,O as Q,ae as X,af as Z,N as ee,P as oe,W as ne,g as te,B as se}from"./naive-ui-CrTIpLJ9.js";import{u as ae}from"./vue-i18n-CWrb4u3f.js";const{defineComponent:le}=await E("vue"),{unref:n,resolveComponent:be,createVNode:s,withCtx:o,toDisplayString:r,createTextVNode:F,openBlock:d,createBlock:V,createCommentVNode:ce,createElementVNode:L,createElementBlock:m}=await E("vue"),ie={style:{"margin-bottom":"12px"}},re={key:1,class:"text-xs"},ue={key:3,class:"text-xs"},de={key:4,class:"text-xs"},_e={key:5,class:"text-xs"},{defineComponent:pe,ref:T,inject:fe,onMounted:me,onUnmounted:he}=await E("vue"),xe=pe({name:Y.MEDIA_LIBRARY.NAME+"Add"}),Ae=le({...xe,setup(ge){const{t:a}=ae(),h=J(),x=K(),g=T(),y=[],c=T([]),C=T(!1),M=$(),I=fe("appConfig"),v=I?.apiRequestHeaders;v&&(v.Authorization=`Bearer ${M.accessToken}`);const R=async()=>{g.value.submit()},z=()=>{g.value?.clear(),c.value=[]},D=e=>{const i=e.file.file?.name.split(".").pop();return i&&y.map(u=>u.toLowerCase()).includes(i.toLowerCase())?(h.error(a("fileTypeNotAllowed")),!1):!0},O=e=>{c.value=e.fileList},U=({file:e})=>e,j=()=>{},P=async({file:e,data:l,headers:i,action:u,onFinish:f,onError:w,onProgress:N})=>{const _=new FormData;l&&Object.keys(l).forEach(t=>{_.append(t,l[t])});const p=e.file,k=p?.name.split(".").pop(),B=p?.name.replace("."+k,""),b=await H(p,{maxSizeMB:1});_.append("file",b,B),C.value=!0,x.start(),G.post(u,_,{headers:i,onUploadProgress:t=>{if(t.total!==void 0){const A=Math.round(t.loaded*100/t.total);N({percent:A})}}}).then(async()=>{f();const t=c.value.findIndex(A=>A.id===e.id);t!==-1&&c.value.splice(t,1),h.success(a("success")),x.finish(),C.value=!1}).catch(t=>{console.log(t),h.error(a("anErrorOccurred")),w(),x.finish(),C.value=!1})},S=console.warn;return me(()=>{console.warn=e=>{typeof e=="string"&&e.includes('Non-function value encountered for slot "default"')||S(e)}}),he(()=>{console.warn=S}),(e,l)=>{const i=W,u=ee,f=se,w=te,N=oe,_=ne,p=Z,k=X,B=Q,b=q;return d(),V(b,null,{"header-extra":o(()=>[n(c).length?(d(),V(w,{key:0,align:"center"},{default:o(()=>[s(f,{disabled:n(c).length==0,onClick:z},{icon:o(()=>[s(u,null,{default:o(()=>[s(i,{icon:"carbon:close"})]),_:1})]),default:o(()=>[F(" "+r(n(a)("clearList")),1)]),_:1},8,["disabled"]),s(f,{type:"primary",disabled:n(c).length==0,onClick:R},{default:o(()=>[F(r(n(a)("launchImport")),1)]),_:1},8,["disabled"])]),_:1})):ce("",!0)]),default:o(()=>[s(B,{show:!1},{default:o(()=>[s(k,{ref_key:"upload",ref:g,multiple:"","directory-dnd":"","list-type":"image",max:j(),"default-upload":!1,headers:n(v),"custom-request":P,action:n(I)?.apiUrl+"/media-files/upload",onBeforeUpload:D,onChange:O,onFinish:U},{default:o(()=>[s(p,{class:"h-[250px] flex flex-col items-center justify-center"},{default:o(()=>[L("div",ie,[s(u,{size:"48",depth:3},{default:o(()=>[s(i,{icon:"carbon:upload"})]),_:1})]),s(N,{style:{"font-size":"16px"}},{default:o(()=>[F(r(n(a)("uploadAreaTitle")),1)]),_:1}),s(_,{depth:"3",class:"mt-4"},{default:o(()=>[(d(),m("span",re,r(n(a)("noLimitToTheNumberOfFilesToSend")),1)),l[0]||(l[0]=L("br",null,null,-1)),(d(),m("span",ue,r(n(a)("noLimitToTheSizeOfFilesToSend")),1)),l[1]||(l[1]=L("br",null,null,-1)),y.length?(d(),m("span",de,r(n(a)("extensionsAreNotAllowed",[y.join(", ")])),1)):(d(),m("span",_e,r(n(a)("allFileExtensionsAreAllowed")),1))]),_:1})]),_:1})]),_:1},8,["max","headers","action"])]),_:1})]),_:1})}}});export{Ae as default};
